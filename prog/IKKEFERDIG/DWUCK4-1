C
C    FYSKTT*DWUCK4-1.DWUCK4MAP(0) (0)
C    FYSKTT*DWUCK4-1.DWUCK4(0)    (2)
C    FYSKTT*DWUCK4-1.ADWUCK(0)    (0)
C    FYSKTT*DWUCK4-1.BDWUCK(0)    (3)
C    FYSKTT*DWUCK4-1.FORMF(0)     (0)
C    FYSKTT*DWUCK4-1.POTS(0)      (1)
C    FYSKTT*DWUCK4-1.INTEG(0)     (0)
C    FYSKTT*DWUCK4-1.TAPED(0)     (0)
C    FYSKTT*DWUCK4-1.ELSIG(0)     (3)
C    FYSKTT*DWUCK4-1.RADINT(0)    (0)
C    FYSKTT*DWUCK4-1.BETAFN(0)    (0)
C    FYSKTT*DWUCK4-1.INSIG(0)     (1)
C    FYSKTT*DWUCK4-1.FNLOC(0)     (0)
C    FYSKTT*DWUCK4-1.CATHEN(0)    (1)
C    FYSKTT*DWUCK4-1.SLATR(0)     (0)
C    FYSKTT*DWUCK4-1.RADIN(0)     (0)
C    FYSKTT*DWUCK4-1.DSTRIP(0)    (0)
C
C FYSKTT*DWUCK4-1(1).DWUCK4MAP(0)
C
C    SEG MAIN
C    IN DWUCK4-1.DWUCK4
C    SEG A*,(MAIN)  
C    IN DWUCK4-1.ADWUCK
C    SEG B*,(MAIN)  
C    IN DWUCK4-1.BDWUCK
C    LIB FYSKTT*DWUCK4-1.
C    LIB FYSKTT*KUNZLIB.
C    END
C
C FYSKTT*DWUCK4-1(1).DWUCK4(2)
C
      PROGRAM DWUCK
C     PROGRAM DWUCK(INPUT=1001,OUTPUT=1001,TAPE5=INPUT,TAPE6=OUTPUT
C    1,TAPE2=1001,TAPE4=2001,PUNCH=1001,TAPE7=PUNCH)
C     THE NEXT 3 CARDS CONVERT DWUCK TO AN IBM 360                      DWUCK002
      IMPLICIT REAL*8(A-H,O-Z)                                          DWUCK003
      COMMON ALPHA(15),IDAT(6),ICON(16),ANGLE(5),HBARC,AMU,AMASS,CHSQ,AADWUCK004
     1,DRF,Z(3),ZA(3),FM(3),FMA(3),RC(3),AC(3),PNLOC(3),FS(3),ECM(3)    DWUCK005
     2,FK(3),FK2(3),ETA(3),DR(3),FMU(3),FN,FL,FJ2,FSS,VCE,FNRNG,RSIG(2) DWUCK006
     3,K,KZ,LPLUS,LPL2,IS(3),NS(3),NLTR,LTRT(8),JTRT(8),ISTRT(8),IBF(8) DWUCK007
     4,IBUFF,IWORD,ILINE                                                DWUCK008
     5,U(800,2),V(800,2),SPACE(3200),UB(800),BUFFR(1024)                DWUCK009
      CHARACTER IFILE*64
      LOGICAL HCMORP
C
C
C
      WRITE(*,9999)
      WRITE(*,*)
      WRITE(*,*)
C                                                                       DWUCK010
C     STORE STANDARD ANGLE DATA                                         DWUCK011
C                                                                       DWUCK012
      ANGLE(1)=37.0                                                     DWUCK013
      ANGLE(2)=0.0                                                      DWUCK014
      ANGLE(3)=5.0                                                      DWUCK015
      ANGLE(4)=0.0                                                      DWUCK016
      ANGLE(5)=0.0                                                      DWUCK017
      HBARC=197.313                                                     DWUCK018
      AMU=931.141                                                       DWUCK019
      FSCON=137.036
      CHSQ=HBARC/FSCON 
      IBUFF=1024                                                        DWUCK020
      IWORD=0                                                           DWUCK021
C
C
      CALL HCINIT
      CALL HCCMDL
C
C     INPUT FILE
      IFILE='TERMINAL'
      CALL HCNXTS(1,IFILE,'INPUT FILE: ')
      OPEN(5,FILE=IFILE,STATUS='OLD',IOSTAT=ISTAT)
      IF (ISTAT .NE. 0) GOTO 900
C
C     OUTPUT FILE
      IFILE='TERMINAL'
      CALL HCNXTS(1,IFILE,'OUTPUT FILE: ')
      OPEN(6,FILE=IFILE,STATUS='OLD',IOSTAT=ISTAT)
      IF (ISTAT .NE. 0) GOTO 900
C
C     TAPE 8 STORES INELASTIC CROSS SECTIONS
      IFILE=''
      CALL HCNXTS(1,IFILE,'INEL. XSECT. OUTPUT FILE: ')
      IF (IFILE .NE. '') THEN
          OPEN(8,FILE=IFILE,STATUS='OLD',IOSTAT=ISTAT)
          IF (ISTAT .NE. 0) GOTO 900
      ENDIF
C
C     TAPE 2 STORES RADIAL INTEGRALS
      IFILE=''
      CALL HCNXTS(1,IFILE,'SCRATCH FILE 1: ')
      OPEN(2,FILE=IFILE,STATUS='OLD',IOSTAT=ISTAT)
      IF (ISTAT .NE. 0) GOTO 900
C
C     TAPE 4 STORES DISTORTED WAVES
      IFILE=''
      CALL HCNXTS(1,IFILE,'SCRATCH FILE 2: ')
      OPEN(4,FILE=IFILE,STATUS='OLD',IOSTAT=ISTAT)
      IF (ISTAT .NE. 0) GOTO 900
 1001 CONTINUE                                                          DWUCK022
C                                                                       DWUCK023
C     TAPE 2 STORES RADIAL INTEGRALS                                    DWUCK024
      REWIND 2                                                          DWUCK025
C                                                                       DWUCK026
C     TAPE 4 STORES DISTORTED WAVES                                     DWUCK027
      REWIND 4                                                          DWUCK028
C                                                                       DWUCK029
C     CUDATE IS DECODER SUBROUTINE FOR CDC DATE AND TIME ROUTINES       DWUCK030
C                                                                       DWUCK031
C     DATE IS STORED IN FIRST 3 WORDS , TIME IN SECOND 3 WORDS OF IDAT  DWUCK032
C                                                                       DWUCK033
      CALL CUDATE(IDAT)                                                 DWUCK034
C                                                                       DWUCK035
      WRITE(6,9999)                                                     DWUCK036
C                                                                       DWUCK037
C     DIVISION FOR OVERLAY MAY BE MADE  1-ADWUCK, 2-BDWUCK              DWUCK038
C                                                                       DWUCK039
      IBF(3)=0                                                          DWUCK040
      CALL ADWUCK                                                       DWUCK041
      IF(IBF(3).NE.0) GO TO 1001                                        DWUCK042
      CALL BDWUCK                                                       DWUCK043
      GO TO 1001                                                        DWUCK044
  900 CONTINUE
      WRITE(*,6006) IFILE(-1:-1)
 6006 FORMAT('0ERROR IN OPENING FILE "',A,'"')
      CALL ERMSG(ISTAT)
      STOP 'DWUCK4-1 ERROR'
 9001 FORMAT(A80)
 9999 FORMAT(55H1DWUCK4-DISTORTED WAVES U.COLORADO-VERSION 05/AUG /1977)DWUCK045
      END                                                               DWUCK046
C
C FYSKTT*DWUCK4-1(1).ADWUCK(0)
C
      SUBROUTINE ADWUCK                                                 ADWUC000
C     THE NEXT 2 CARDS CONVERT DWUCK TO AN IBM 360                      ADWUC001
      IMPLICIT REAL*8(A-H,O-Z)                                          ADWUC002
C     ABS(XXX)=DABS(XXX)                                                ADWUC003
      COMMON ALPHA(15),IDAT(6),ICON(16),ANGLE(5),HBARC,AMU,AMASS,CHSQ,AAADWUC004
     1,DRF,Z(3),ZA(3),FM(3),FMA(3),RC(3),AC(3),PNLOC(3),FS(3),ECM(3)    ADWUC005
     2,FK(3),FK2(3),ETA(3),DR(3),FMU(3),FN,FL,FJ2,FSS,VCE,FNRNG,RSIG(2) ADWUC006
     3,K,KZ,LPLUS,LPL2,IS(3),NS(3),NLTR,LTRT(8),JTRT(8),ISTRT(8),IBF(8) ADWUC007
     4,IBUFF,IWORD,ILINE                                                ADWUC008
     5,U(800,2),V(800,2),SPACE(3200),UB(800),BUFFR(1024)                ADWUC009
      DIMENSION DTEMP(6400),E(600)                                      ADWUC010
      EQUIVALENCE (U,DTEMP),(DTEMP(3801),E)                             ADWUC011
C                                                                       ADWUC012
C     READ CARD SET 1                                                   ADWUC013
      READ (5,9802,END=2,ERR=2)ICON,ALPHA                               ADWUC014
C                                                                       ADWUC015
      WRITE(6,9502)                                                     ADWUC016
      WRITE(6,9804)                                                     ADWUC017
      WRITE(6,9803)ICON,ALPHA,IDAT                                      ADWUC018
      IF(ICON(1).NE.9) GO TO 3                                          ADWUC019
C                                                                       ADWUC020
C     END OF DATA TEST FOR CDC 6400                                     ADWUC021
C                                                                       ADWUC022
C     IF(EOF(5))2,3
C
C     DELETE SCRATCH FILES
C
    2 CLOSE(5)
      CLOSE(6)
      CLOSE(8)
      CLOSE(2)
      CLOSE(4)
      STOP 'DWUCK4-1'                                                   ADWUC024
    3 CONTINUE                                                          ADWUC025
      IF(ICON(1).EQ.0) GO TO 5                                          ADWUC026
C                                                                       ADWUC027
C     READ CARD SET 2                                                   ADWUC028
      READ (5,9001)ANGLE                                                ADWUC029
      IF(ICON(1).EQ.1) GO TO 5                                          ADWUC030
      II=(ANGLE(1)-ANGLE(2))/ANGLE(3)+1.0                               ADWUC031
      IF(II.LT.0) II=0                                                  ADWUC032
      ANGLE(1)=II                                                       ADWUC033
    5 CONTINUE                                                          ADWUC034
      WRITE(6,9010)ANGLE                                                ADWUC035
C                                                                       ADWUC036
C                                                                       ADWUC037
C     READ CARD SET 3                                                   ADWUC038
      READ (5,9002)L,NLTR,(LTRT(I),I=1,NLTR),(JTRT(I),I=1,NLTR)         ADWUC039
      WRITE(6,9008)L   ,(LTRT(I),I=1,NLTR) 
      WRITE(6,9009)NLTR,(JTRT(I),I=1,NLTR) 
C                                                                       ADWUC040
C                                                                       ADWUC041
C     READ CARD SET 4                                                   ADWUC042
      READ (5,9001)DRF,RZ,RMAX,VCE,FNRNG,AMASS                          ADWUC043
      IF(ABS(RMAX).GT.ABS(RZ)) GO TO 6 
      R=RZ 
      RZ=RMAX  
      RMAX=R
    6 CONTINUE 
      WRITE(6,9011)DRF,RZ,RMAX,VCE,FNRNG                                ADWUC044
      IF(AMASS.NE.0.0) WRITE(6,9012)AMASS  
C                                                                       ADWUC048
      IF(DRF.EQ.0.0) DRF=0.1                                            ADWUC049
      KZ=RZ/DRF+1.0E-08                                                 ADWUC050
      K =ABS(RMAX)/DRF+1.0E-08                                          ADWUC051
      KC=K                                                              ADWUC052
      LPLUS=L+1                                                         ADWUC053
      IND=0                                                             ADWUC054
      INCR=0                                                            ADWUC055
      IBF(5)=0                                                          ADWUC056
      IBF(6)=0                                                          ADWUC057
      WRITE(6,9504)                                                     ADWUC058
C                                                                       ADWUC059
C     READ IN DISTORTED WAVE INFORMATION                                ADWUC060
C                                                                       ADWUC061
      IBF(4)=0                                                          ADWUC062
      CALL FORMF(U(1,1),V(1,1),1,0,0)                                   ADWUC063
      IF(IBF(4).NE.0) IBF(5)=1                                          ADWUC064
      IBF(4)=0                                                          ADWUC065
      CALL FORMF(U(1,2),V(1,2),2,0,0)                                   ADWUC066
      IF(IBF(4).NE.0) IBF(6)=1                                          ADWUC067
C                                                                       ADWUC068
C     FORM FACTOR LOOP                                                  ADWUC069
C                                                                       ADWUC070
      DO 35 II=1,NLTR                                                   ADWUC071
      IF(ICON(2).EQ.1) GO TO 28                                         ADWUC072
      WRITE(6,9999)ALPHA,(IDAT(I),I=1,3)                                ADWUC073
      IF(ICON(3).NE.0) GO TO 8                                          ADWUC074
      IF(II     .NE.1) GO TO 12                                         ADWUC075
    8 CONTINUE                                                          ADWUC076
      IF(ICON(2).EQ.2) GO TO 9                                          ADWUC077
      WRITE(6,9503)                                                     ADWUC078
C                                                                       ADWUC079
      CALL FORMF(UB,DTEMP(5601),3,LTRT(II),0)                           ADWUC080
C                                                                       ADWUC081
      GO TO 11                                                          ADWUC082
    9 CONTINUE                                                          ADWUC083
      DO 10 I=1,800                                                     ADWUC084
      UB(I)=0.0                                                         ADWUC085
   10 CONTINUE                                                          ADWUC086
   11 IF(ICON(2).EQ.0) GO TO 12                                         ADWUC087
      CALL CATHEN(LTRT(II),JTRT(II),DTEMP(3201),DTEMP(4801),UB)         ADWUC088
   12 CONTINUE                                                          ADWUC089
      ISTRT(II)=IS(3)                                                   ADWUC090
      IF(ICON(4).EQ.1) GO TO 18                                         ADWUC091
      IWRITE=1                                                          ADWUC092
      GO TO 3004                                                        ADWUC093
   18 CONTINUE                                                          ADWUC094
C                                                                       ADWUC095
      IF(ICON(3).NE.0) GO TO 26                                         ADWUC096
      IF(II     .NE.1) GO TO 27                                         ADWUC097
   26 CONTINUE                                                          ADWUC098
C                                                                       ADWUC099
      CALL FNLOC(U,UB,DTEMP(5601),LTRT(II),Z,FNRNG,K)                   ADWUC100
C                                                                       ADWUC101
   27 CONTINUE                                                          ADWUC102
      WRITE(4)UB                                                        ADWUC103
      GO TO 29                                                          ADWUC104
C                                                                       ADWUC105
C     SKIP TO HERE IF NO NEW FORM FACTORS                               ADWUC106
C     SPACE OVER FORM FACTORS                                           ADWUC107
C                                                                       ADWUC108
   28 CONTINUE                                                          ADWUC109
      READ (4)UB                                                        ADWUC110
   29 CONTINUE                                                          ADWUC111
      IS(3)=ISTRT(II)                                                   ADWUC112
      IF(IS(3).EQ.0) JTRT(II)=LTRT(II)+LTRT(II)                         ADWUC113
      IND=MAX0(LTRT(II)+1,IND)                                          ADWUC114
      INCR=MAX0(INCR,JTRT(II))                                          ADWUC115
C                                                                       ADWUC116
      IF(ICON(11).EQ.0) GO TO 30                                        ADWUC117
      IWRITE=2                                                          ADWUC118
      GO TO 3003                                                        ADWUC119
   30 CONTINUE                                                          ADWUC120
C                                                                       ADWUC121
C     CHECK ON SPINS AND STATISTICS                                     ADWUC122
C                                                                       ADWUC123
      LTR=LTRT(II)                                                      ADWUC124
      JTR=JTRT(II)                                                      ADWUC125
      IF(PHASEF(IS(1)+IS(2)+IS(3)).LT.0.0) GO TO 33                     ADWUC126
      IF(PHASEF(LTR+LTR+JTR+IS(3)).LT.0.0) GO TO 33                     ADWUC127
      GO TO 35                                                          ADWUC128
   33 CONTINUE                                                          ADWUC129
C                                                                       ADWUC130
C     SET ERROR FLAG                                                    ADWUC131
C                                                                       ADWUC132
      IBF(3)=1                                                          ADWUC133
      WRITE(6,9906)IS,LTR,JTR                                           ADWUC134
   35 CONTINUE                                                          ADWUC135
      IF(NLTR.GT.8) IBF(3)=1
C                                                                       ADWUC136
C     CHECK ON COMPATIBILITY OF LMAX AND STORAGE                        ADWUC137
C                                                                       ADWUC138
      LPLUS=MIN0(LPLUS,300/(NS(1)+NS(2)),2800/(NS(1)*NS(2)*(IND+1)))    ADWUC139
      L=LPLUS-1                                                         ADWUC140
      LPL2=LPLUS+LPLUS                                                  ADWUC141
      IF(RMAX.LT.0.0) K=KC                                              ADWUC142
      WRITE(6,9506)L,K,NLTR                                             ADWUC143
      IBUF=LPL2*IND+1                                                   ADWUC144
      INC=(INCR+IS(1)+IS(2))/2+1                                        ADWUC145
      IBUF=MAX0(IBUF,INC*LPLUS+233)                                     ADWUC146
      IBF(1)=IBUF                                                       ADWUC147
C                                                                       ADWUC148
      IBF(7)=IS(1)                                                      ADWUC149
      IF(IBF(5).NE.0) GO TO 51                                          ADWUC150
      IS(1)=0                                                           ADWUC151
      FS(1)=0.0                                                         ADWUC152
      NS(1)=1                                                           ADWUC153
   51 CONTINUE                                                          ADWUC154
      IBF(8)=IS(2)                                                      ADWUC155
      IF(IBF(6).NE.0) GO TO 52                                          ADWUC156
      IS(2)=0                                                           ADWUC157
      FS(2)=0.0                                                         ADWUC158
      NS(2)=1                                                           ADWUC159
   52 CONTINUE                                                          ADWUC160
      IF(ICON(15).EQ.0) GO TO 56                                        ADWUC161
C                                                                       ADWUC162
C     PRINT OUT K(R)**2 FOR DISTORTED WAVES                             ADWUC163
C                                                                       ADWUC164
      WRITE(6,9999)ALPHA,(IDAT(I),I=1,3)                                ADWUC165
      DO 55 I=1,2                                                       ADWUC166
      WRITE(6,9057)I                                                    ADWUC167
      IND=0                                                             ADWUC168
      R=DR(I)                                                           ADWUC169
      DO 54 M=1,K,5                                                     ADWUC170
      MK=M+M-1                                                          ADWUC171
      MK4=MIN0(MK +9,K+K)                                               ADWUC172
      WRITE(6,9052)R,(U(J,I),J=MK,MK4)                                  ADWUC173
      R=R+5.0*DR(I)                                                     ADWUC174
   54 CONTINUE                                                          ADWUC175
   55 CONTINUE                                                          ADWUC176
   56 CONTINUE                                                          ADWUC177
      CALL INTEG                                                        ADWUC178
C                                                                       ADWUC179
      IF(ICON(5).NE.0) GO TO 61                                         ADWUC180
C                                                                       ADWUC181
C     WRITE ELASTIC PARTIAL WAVE SCATTERING AMPLITUDES                  ADWUC182
C                                                                       ADWUC183
      WRITE(6,9999)ALPHA,(IDAT(I),I=1,3)                                ADWUC184
      WRITE(6,9600)                                                     ADWUC185
      WRITE(6,9601)                                                     ADWUC186
      DO 60 LL=1,LPLUS                                                  ADWUC187
      LX=LL-1                                                           ADWUC188
      INC=LX+LL                                                         ADWUC189
      IND=INC+LPL2*(NS(1)-1)                                            ADWUC190
      WRITE(6,9602)LX, (E(INDEX  ),E(INDEX+1) ,INDEX=INC,IND,LPL2)      ADWUC191
      INC=IND+LPL2                                                      ADWUC192
      IND=INC+LPL2*(NS(2)-1)                                            ADWUC193
      WRITE(6,9603)LX, (E(INDEX  ),E(INDEX+1) ,INDEX=INC,IND,LPL2)      ADWUC194
   60 CONTINUE                                                          ADWUC195
   61 CONTINUE                                                          ADWUC196
      IF(ICON(12).EQ.0) GO TO 80                                        ADWUC197
      DO 72 M=1,NLTR                                                    ADWUC198
      READ(4)                                                           ADWUC199
   72 CONTINUE                                                          ADWUC200
      WRITE(6,9999)ALPHA,(IDAT(I),I=1,3)                                ADWUC201
C                                                                       ADWUC202
      CALL TAPED                                                        ADWUC203
C                                                                       ADWUC204
   80 CONTINUE                                                          ADWUC205
      RETURN                                                            ADWUC206
C                                                                       ADWUC207
C     FORM FACTOR PRINT OUT                                             ADWUC208
C                                                                       ADWUC209
 3003 CONTINUE                                                          ADWUC210
      IF(ICON(11).NE.1) GO TO 3100 
      WRITE(6,9999)ALPHA,(IDAT(I),I=1,3)                                ADWUC211
 3004 CONTINUE                                                          ADWUC212
      R=DR(3)                                                           ADWUC213
      WRITE(6,9100)LTRT(II),ISTRT(II),JTRT(II)                          ADWUC214
      WRITE(6,9101)                                                     ADWUC215
      DO 3006 M=1,K,5                                                   ADWUC216
      MK=M+M-1                                                          ADWUC217
      MK4=MIN0(MK+9,K+K)                                                ADWUC218
      WRITE(6,9052)R ,(UB(N),N=MK,MK4)                                  ADWUC219
      R=R+5.0*DR(3)                                                     ADWUC220
 3006 CONTINUE                                                          ADWUC221
 3007 CONTINUE 
      GO TO(18,30),IWRITE                                               ADWUC222
 3100 CONTINUE 
      FKT=K
      FIZ=ICON(11)-2
      WRITE(7,9001)FKT,FIZ 
      IZ=ICON(11)-3
      WRITE(7,9500)(UB(2*I+IZ),I=1,K)  
      GO TO 3007
 9001 FORMAT(10F8.4)                                                    ADWUC223
 9002 FORMAT(18I3)                                                      ADWUC224
 9008 FORMAT(18H0CARD SET 3 DATA  ,9H   LMAX =,I4,14H          LTR=,8I4)
 9009 FORMAT(18H                  ,9H   NLTR =,I4,14H        2*JTR=,8I4)
 9010 FORMAT(18H0ANGLE DATA        ,9H   THETN=,F9.4,9H   THET1=,F9.4,9HADWUC225
     1   DTHET=,F9.4,9H   A-ANG=,F9.4,9H   B-ANG=,F9.4)                 ADWUC226
 9011 FORMAT(18H0CARD SET 4 DATA   ,9H   DRF  =,F9.4,9H   RZ   =,F9.4,9HADWUC227
     1   RMAX =,F9.4,9H   VCE  =,F9.4,9H   FNRNG=,F9.4)                 ADWUC228
 9012 FORMAT(18X,9H   AMASS=,F9.4)                                      ADWUC229
 9052 FORMAT(1H ,F6.2,10E12.4)                                          ADWUC230
 9057 FORMAT(27H0K(R)**2 FOR DISTORTED WAVE,I2)                         ADWUC231
 9100 FORMAT(12H0FORM FACTOR,6X,9H    LTR =,I4,5X,9H   2*STR=,I4,5X,9H  ADWUC232
     1 2*JTR=,I4)  
 9101 FORMAT(132H0    R    RL,R        IM,R        RL,R+DR     IM,R+DR  ADWUC233
     1   RL,R+DR*2   IM,R+DR*2   RL,R+DR*3   IM,R+DR*3   RL,R+DR*4   IM,ADWUC234
     2R+DR*4       )                                                    ADWUC235
 9500 FORMAT(5E16.7)
 9502 FORMAT(18H0CONTROL INTEGERS )                                     ADWUC236
 9503 FORMAT(18H0FORM FACTOR DATA )                                     ADWUC237
 9504 FORMAT(18H PARTICLE DATA    )                                     ADWUC238
 9506 FORMAT(18X,9H   LMAX =,I4,14H        NSTEP=,I4,14H        NLTR =,IADWUC239
     14)                                                                ADWUC240
 9600 FORMAT(1H0,35HPARTIAL WAVE SCATTERING AMPLITUDES )                ADWUC241
 9601 FORMAT(4H   L,20H  REAL D1   IMAG D1 ,20H  REAL D2   IMAG D2 ,20H ADWUC242
     1 REAL D3   IMAG D3 ,4X,4H   L,20H  REAL D1   IMAG D1 ,20H  REAL D2ADWUC243
     2   IMAG D2 ,20H  REAL D3   IMAG D3 )                              ADWUC244
 9602 FORMAT(1H ,    I3,6F10.7)                                         ADWUC245
 9603 FORMAT(1H+,68X,I3,6F10.7)                                         ADWUC246
 9802 FORMAT(16I1,4X,15A4)                                              ADWUC247
 9803 FORMAT(1H ,16I2,4X,15A4,I2,2(1H/,I2),I4,2(1H.,I2))                ADWUC248
 9804 FORMAT(33H  1 2 3 4 5 6 7 8 9 A B C D E F G,23H    RUN IDENTIFICATADWUC249
     1ION )                                                             ADWUC250
 9906 FORMAT(1H0,28HSPIN STATISTICS NOT CORRECT ,7H 2*IS1=,I3,7H 2*IS2=,ADWUC251
     1I3,7H 2*IS3=,I3,7H   LTR=,I3,7H 2*JTR=,I3)                        ADWUC252
 9999 FORMAT(1H1,15A4,I4,2(1H/,I2),I4,2(1H.,I2))                        ADWUC253
      END                                                               ADWUC254
C
C FYSKTT*DWUCK4-1(1).BDWUCK(3)
C
      SUBROUTINE BDWUCK                                                 BDWUC000
C     THE NEXT 6 CARDS CONVERT DWUCK TO AN IBM 360                      BDWUC001
      IMPLICIT REAL*8(A-H,O-Z)                                          BDWUC002
C     FLOAT(III)=DFLOAT(III)                                            BDWUC003
C     SQRT(XXX)=DSQRT(XXX)                                              BDWUC004
C     ABS(XXX)=DABS(XXX)                                                BDWUC005
C     AMAX1(XXX,YYY)=DMAX1(XXX,YYY)                                     BDWUC006
C     AMIN1(XXX,YYY)=DMIN1(XXX,YYY)                                     BDWUC007
      COMMON ALPHA(15),IDAT(6),ICON(16),ANGLE(5),HBARC,AMU,AMASS,CHSQ,AABDWUC008
     1,DRF,Z(3),ZA(3),FM(3),FMA(3),RC(3),AC(3),PNLOC(3),FS(3),ECM(3)    BDWUC009
     2,FK(3),FK2(3),ETA(3),DR(3),FMU(3),FN,FL,FJ2,FSS,VCE,FNRNG,RSIG(2) BDWUC010
     3,K,KZ,LPLUS,LPL2,IS(3),NS(3),NLTR,LTRT(8),JTRT(8),ISTRT(8),IBF(8) BDWUC011
     4,IBUFF,IWORD,ILINE                                                BDWUC012
     5,U(800,2),V(800,2),SPACE(3200),UB(800),BUFFR(1024)                BDWUC013
      DIMENSION DTEMP(6260)                                             BDWUC014
      EQUIVALENCE (U,DTEMP)                                             BDWUC015
      DATA FOURPI/12.5663706D0/                                         BDWUC016
      IBUF=IBF(1)                                                       BDWUC017
C                                                                       BDWUC018
C     PRINT ELASTIC CROSS-SECTIONS IF ICON(6).NE.0                      BDWUC019
C                                                                       BDWUC020
      IF(ICON(6)+ICON(16).EQ.0) GO TO 65                                BDWUC021
      WRITE(6,9999)ALPHA,(IDAT(I),I=1,3)                                BDWUC022
      WRITE(6,9904)                                                     BDWUC023
      IF(ICON(14).EQ.0) GO TO 68
      WRITE(8,6012) ALPHA
      LTEMP=0
      TEMP=0.0
      WRITE(8,6015) ECM(1),TEMP,LTEMP,LTEMP,LTEMP
      WRITE(8,6018) ANGLE(2),ANGLE(3),ANGLE(1)
C                                                                       BDWUC024
C                                                                       BDWUC025
   68 CALL ELSIG                                                        BDWUC026
C                                                                       BDWUC027
C                                                                       BDWUC028
      GO TO 66                                                          BDWUC029
   65 CONTINUE                                                          BDWUC030
      WRITE(6,9002)(RSIG(N),N=1,2)                                      BDWUC031
   66 CONTINUE                                                          BDWUC032
      RZ=FLOAT(KZ)*DRF                                                  BDWUC033
      RMAX=FLOAT(K)*DRF                                                 BDWUC034
      JR=NS(1)                                                          BDWUC035
      JS=NS(2)                                                          BDWUC036
      DO 101 II=1,NLTR                                                  BDWUC037
      LTR=LTRT(II)                                                      BDWUC038
      MPLUS=LTR+1                                                       BDWUC039
C                                                                       BDWUC040
C     SPACE TO PROPER FORM FACTOR FOR THIS L-TRANSFER                   BDWUC041
C                                                                       BDWUC042
      DO 70 IJ=1,NLTR                                                   BDWUC043
      IF(IJ.EQ.II) GO TO 69                                             BDWUC044
      READ(4)                                                           BDWUC045
      GO TO 70                                                          BDWUC046
   69 READ(4)UB                                                         BDWUC047
   70 CONTINUE                                                          BDWUC048
C                                                                       BDWUC049
      CALL RADINT(DTEMP(5641),DTEMP(   1),LTR)                          BDWUC050
C                                                                       BDWUC051
      IF(ICON(7).EQ.0) GO TO 100                                        BDWUC052
C                                                                       BDWUC053
C     WRITE( RADIAL MATRIX ELEMENTS IF ICON(7).NE.0                     BDWUC054
C                                                                       BDWUC055
      INCR=LPL2*LTR                                                     BDWUC056
      INC=1                                                             BDWUC057
      IS1=-IS(1)                                                        BDWUC058
      DO 99 I=1,JR                                                      BDWUC059
      IS2=-IS(2)                                                        BDWUC060
      DO 98 J=1,JS                                                      BDWUC061
      WRITE(6,9999)ALPHA,(IDAT(M),M=1,3)
      WRITE(6,9900)IS2,IS1                                              BDWUC063
      WRITE(6,9901)                                                     BDWUC064
      DO 90 LL=1,LPLUS                                                  BDWUC065
      LM=LL-1                                                           BDWUC066
      IND=INC+INCR                                                      BDWUC067
      WRITE(6,9902)LM, (DTEMP(INDEX),DTEMP(INDEX+1) ,INDEX=INC,IND,LPL2)BDWUC068
      INC=INC+2                                                         BDWUC069
   90 CONTINUE                                                          BDWUC070
      INC=INC+INCR                                                      BDWUC071
      IS2=IS2+2                                                         BDWUC072
   98 CONTINUE                                                          BDWUC073
      IS1=IS1+2                                                         BDWUC074
   99 CONTINUE                                                          BDWUC075
  100 CONTINUE                                                          BDWUC076
  101 CONTINUE                                                          BDWUC077
      END FILE 2                                                        BDWUC078
      REWIND 2                                                          BDWUC079
C                                                                       BDWUC080
C     RESTORE SPIN STORAGE                                              BDWUC081
C                                                                       BDWUC082
      IS(1)=IBF(7)                                                      BDWUC083
      FS(1)=FLOAT(IBF(7))/2.0                                           BDWUC084
      NS(1)=IBF(7)+1                                                    BDWUC085
      JR=NS(1)                                                          BDWUC086
      IS(2)=IBF(8)                                                      BDWUC087
      FS(2)=FLOAT(IBF(8))/2.0                                           BDWUC088
      NS(2)=IBF(8)+1                                                    BDWUC089
      JS=NS(2)                                                          BDWUC090
      DO 201 II=1,NLTR                                                  BDWUC091
      LTR=LTRT(II)                                                      BDWUC092
      JTR=JTRT(II)                                                      BDWUC093
      IS(3)=ISTRT(II)                                                   BDWUC094
C                                                                       BDWUC095
C     CALCULATE NORMALIZATION FACTOR                                    BDWUC096
C                                                                       BDWUC097
      FL=1.0                                                            BDWUC098
      IF(ICON(10).EQ.0) GO TO 105                                       BDWUC099
C                                                                       BDWUC100
C     ICON(10).NE.0 GIVES RELATIVISTIC KINEMATICS                       BDWUC101
C                                                                       BDWUC102
      FACT=     2.0*FMU(1)/(HBARC*FK(1))**2                             BDWUC103
      FACT=FACT*2.0*FMU(2)/(HBARC*FK(2))**2                             BDWUC104
      FACT=FACT*AMU**2/FOURPI                                           BDWUC105
      GO TO 106                                                         BDWUC106
  105 CONTINUE                                                          BDWUC107
      FACT=1.0/(ECM(1)*ECM(2)*FOURPI)                                   BDWUC108
  106 CONTINUE                                                          BDWUC109
      FACT=FACT*FK(2)/FK(1)                                             BDWUC110
      T1=AMAX1(DR(1),DR(2))                                             BDWUC111
      T2=AMIN1(DR(1),DR(2))                                             BDWUC112
      FACT=FACT*(T1**2/(DR(3)*T2))**2                                   BDWUC113
      I1=ABS(FM(1)-FM(2))+0.1                                           BDWUC114
      IF(I1.EQ.0) GO TO 112                                             BDWUC115
      FACT=FACT*1.0E+04                                                 BDWUC116
      FL=SQRT(FLOAT(LTR+LTR+1))                                         BDWUC117
  112 CONTINUE                                                          BDWUC118
      FN=(II-1)*ICON(3)*(ICON(3)-1)                                     BDWUC119
C                                                                       BDWUC120
      CALL BETAFN(DTEMP(   1),DTEMP(IBUF),LTR,JTR)                      BDWUC121
C                                                                       BDWUC122
      MPLUS=JTR/2+1                                                     BDWUC123
      IF(ICON(8).EQ.0) GO TO 120                                        BDWUC124
C                                                                       BDWUC125
C     WRITE BETA TABLES IF ICON(8).NE.0                                 BDWUC126
C                                                                       BDWUC127
      I1=MPLUS+MPLUS                                                    BDWUC128
      IFACT=I1     *NS(1)*NS(2)                                         BDWUC129
      KT=0                                                              BDWUC130
      IS2=-IS(2)                                                        BDWUC131
      DO 118 J=1,JS                                                     BDWUC132
      IS1=-IS(1)                                                        BDWUC133
      DO 116 I=1,JR                                                     BDWUC134
      WRITE(6,9999)ALPHA,(IDAT(M),M=1,3)
      WRITE(6,9905)IS2,IS1                                              BDWUC136
      WRITE(6,9903)                                                     BDWUC137
      DO 114 LL=1,LPLUS                                                 BDWUC138
      LM=LL-1                                                           BDWUC139
      IND=KT+LM*IFACT+IBUF                                              BDWUC140
      INDF=IND+I1-1                                                     BDWUC141
      WRITE(6,9902)LM,(DTEMP(INDEX),INDEX=IND,INDF)                     BDWUC142
  114 CONTINUE                                                          BDWUC143
      KT=KT+I1                                                          BDWUC144
      IS1=IS1+2                                                         BDWUC145
  116 CONTINUE                                                          BDWUC146
      IS2=IS2+2                                                         BDWUC147
  118 CONTINUE                                                          BDWUC148
  120 CONTINUE                                                          BDWUC149
      IF(FN.NE.0.0) GO TO 135                                           BDWUC150
C                                                                       BDWUC151
C     SET HEADINGS FOR INELASTIC SIGMA                                  BDWUC152
C                                                                       BDWUC153
      WRITE(6,9999)ALPHA,(IDAT(I),I=1,3)                                BDWUC154
      WRITE(6,9507)DRF,RZ,RMAX,VCE,FS(1)                                BDWUC155
      WRITE(6,9508)FNRNG,PNLOC,FS(2)                                    BDWUC156
  135 CONTINUE                                                          BDWUC157
      TEMP=ECM(2)-ECM(1)                                                BDWUC158
      WRITE(6,9505)LTR,JTR,IS(3),TEMP                                   BDWUC159
      IF(ICON(13).EQ.0) GO TO 138
      WRITE(8,6012) ALPHA
 6012 FORMAT(20A4)
      WRITE(8,6015) ECM(1),TEMP,LTR,JTR,IS(3)
 6015 FORMAT(2F10.4,12I5)
      WRITE(8,6018) ANGLE(2),ANGLE(3),ANGLE(1)
 6018 FORMAT(8F10.3)
  138 IF(ICON(3).EQ.0) GO TO 140                                        BDWUC160
      IF(ICON(3).EQ.1) GO TO 140                                        BDWUC161
      IF(II.EQ.NLTR) GO TO 140                                          BDWUC162
      GO TO 201                                                         BDWUC163
  140 CONTINUE                                                          BDWUC164
C                                                                       BDWUC165
      CALL INSIG(DTEMP(IBUF),DTEMP( 233),JTR,FACT)                      BDWUC166
C                                                                       BDWUC167
  201 CONTINUE                                                          BDWUC168
  300 CONTINUE                                                          BDWUC169
      REWIND 2                                                          BDWUC170
      RETURN                                                            BDWUC171
 9002 FORMAT(1H0,7HREACSIG,E14.5,41X,E14.5)                             BDWUC172
 9505 FORMAT(18H ANG MOM TRANSFER ,9H   LTR  =,I4,14H.       2*JTR=,I4, BDWUC173
     114H.       2*STR=,I4,14H.       Q    =,F9.4)                      BDWUC174
 9507 FORMAT(18H0BASIC DATA       ,9H   DR   =,F9.4,9H   RMIN =,F9.4,9H BDWUC175
     1  RMAX =,F9.4,9H   COUEX=,F9.4,9H     IS1=,F9.4)                  BDWUC176
 9508 FORMAT(18X,9H   FNRNG=,F9.4,9H   PNLC1=,F9.4,9H   PNLC2=,F9.4,9H  BDWUC177
     1 PNLC3=,F9.4,9H     IS2=,F9.4)                                    BDWUC178
 9900 FORMAT(24H0 RADIAL MATRIX ELEMENTS ,9H,  J2=L2+,I2,2H/2,9H,  J1=L1BDWUC179
     1+,I2,2H/2 )                                                       BDWUC180
 9901 FORMAT(84H0 L2  F(L2,/L2-LTR/)      F(L2,/L2-LTR/+2)    F(L2,/L2-LBDWUC181
     1TR/+4)    F(L2,/L2-LTR/+6)  )                                     BDWUC182
 9902 FORMAT(I4,10E10.3/(4X,10E10.3))                                   BDWUC183
 9903 FORMAT(96H0 L2  BETA(L2,0)          BETA(L2,1)          BETA(L2,2)BDWUC184
     1          BETA(L2,3)          BETA(L2,4)  )                       BDWUC185
 9904 FORMAT(1H0,32HELASTIC SCATTERING CROSS-SECTION )                  BDWUC186
 9905 FORMAT(1H0,8H    MS2=,I2,2H/2,8H    MS1=,I2,2H/2)                 BDWUC187
 9999 FORMAT(1H1,15A4,I2,2(1H/,I2),I4,2(1H.,I2))                        BDWUC188
      END                                                               BDWUC189
C
C FYSKTT*DWUCK4-1(1).FORMF(0)
C
      SUBROUTINE FORMF(U,V,N,LAM,IK)                                    FORMF000
C     THE NEXT 4 CARDS CONVERT DWUCK TO AN IBM 360                      FORMF001
      IMPLICIT REAL*8(A-H,O-Z)                                          FORMF002
C     SQRT(XXX)=DSQRT(XXX)                                              FORMF003
C     ABS(XXX)=DABS(XXX)                                                FORMF004
C     EXP(XXX)=DEXP(XXX)                                                FORMF005
C                                                                       FORMF006
      COMMON ALPHA(15),IDAT(6),ICON(16),ANGLE(5),HBARC,AMU,AMASS,CHSQ,AAFORMF007
     1,DRF,Z(3),ZA(3),FM(3),FMA(3),RC(3),AC(3),PNLOC(3),FS(3),ECM(3)    FORMF008
     2,FK(3),FK2(3),ETA(3),DR(3),FMU(3),FN,FL,FJ2,FSS,VCE,FNRNG,RSIG(2) FORMF009
     3,K,KZ,LPLUS,LPL2,IS(3),NS(3),NLTR,LTRT(8),JTRT(8),ISTRT(8),IBF(8) FORMF010
      DIMENSION U(800),V(800),G(4)                                      FORMF011
      EQUIVALENCE (G,FN)                                                FORMF012
      DATA ETA6/60.0D0/                                                 FORMF013
C                                                                       FORMF014
C     READ IN CARD SET 5,6,OR 7   POTENTIAL CARDS                       FORMF015
C                                                                       FORMF016
      READ (5,9000)E,FM(N),Z(N),FMA(N),ZA(N),RY,AC(N),PNLOC(N),FS(N),QCDFORMF017
      IF(N.NE.2) GO TO 6                                                FORMF018
      Q=E                                                               FORMF019
      IF(QCD.GT.0.0) GO TO 6                                            FORMF020
      IF(QCD.LT.0.0) Q=Q+QCD                                            FORMF021
      E=(ECM(1)+Q)*(FM(2)+FMA(2))/FMA(2)                                FORMF022
    6 CONTINUE                                                          FORMF023
      IF(N.NE.3) GO TO 8                                                FORMF024
      E=E+QCD                                                           FORMF025
    8 CONTINUE                                                          FORMF026
      IS(N)=FS(N)                                                       FORMF027
      NS(N)=IS(N)+1                                                     FORMF028
      IF(AMASS.EQ.0.0) AMASS=FMA(1)                                     FORMF029
      IF(IK.NE.0) GO TO 11 
      DR(N)=DRF*AMASS/FMA(N)                                            FORMF030
   11 CONTINUE 
      AFACT=FMA(N)**.333333333                                          FORMF031
      RC(N)=RY*AFACT                                                    FORMF032
      DO 12 M=1,800                                                     FORMF033
      U(M)=0.0                                                          FORMF034
      V(M)=0.0                                                          FORMF035
   12 CONTINUE                                                          FORMF036
      RM=0.0                                                            FORMF037
      IF(E.EQ.0.0) GO TO 66                                             FORMF038
      IF(ICON(10).EQ.0) GO TO 30                                        FORMF039
C                                                                       FORMF040
C     ICON(10).NE.0 GIVES RELATIVISTIC KINEMATICS                       FORMF041
C                                                                       FORMF042
      IF(N.NE.2) GO TO 26                                               FORMF043
      IF(QCD.GT.0.0) GO TO 26                                           FORMF044
      E=E+(ECM(1)+Q)**2/(2.0*FMA(2)*AMU)                                FORMF045
   26 CONTINUE                                                          FORMF046
      FM1=FM(N)*AMU                                                     FORMF047
      FM2=FMA(N)*AMU                                                    FORMF048
      FMT=FM1+FM2                                                       FORMF049
      IF(N.EQ.3) E=((E+FMT)**2-FMT**2)/(2.0*FM2)                        FORMF050
      T1=SQRT(2.0*E*FM2+FMT**2)                                         FORMF051
      W1=(FMT*FM1+FM2*E)/T1                                             FORMF052
      W2=FM2*(E+FMT)/T1                                                 FORMF053
      FMU(N)=W1*W2/(W1+W2)                                              FORMF054
      ECM(N)=T1-FMT                                                     FORMF055
      FACT=2.0*FMU(N)/HBARC**2                                          FORMF056
      FMU(N)=FMU(N)/AMU                                                 FORMF057
      FK2(N)=(E**2+2.0*E*FM1)*(FM2/T1)**2/HBARC**2                      FORMF058
      GO TO 36                                                          FORMF059
   30 CONTINUE                                                          FORMF060
      FMU(N)=FM(N)*FMA(N)/(FM(N)+FMA(N))                                FORMF061
      IF(N.NE.3) ECM(N)=E*FMU(N)/FM(N)                                  FORMF062
      IF(N.EQ.3) ECM(N)=E                                               FORMF063
      FACT=2.0*FMU(N)*AMU/HBARC**2                                      FORMF064
      FK2(N)=FACT*ECM(N)                                                FORMF065
   36 CONTINUE                                                          FORMF066
      FK(N)=SQRT(ABS(FK2(N)))                                           FORMF067
      ETAK=CHSQ*Z(N)*ZA(N)*FACT                                         FORMF068
      ETA(N)=ETAK*0.5/FK(N)                                             FORMF069
C                                                                       FORMF070
C     ADD COULOMB AND KINETIC ENERGIES TO U                             FORMF071
C                                                                       FORMF072
      RCX=RC(N)                                                         FORMF073
      IF(RCX.EQ.0.0) RCX=DR(N)                                          FORMF074
      R=0.0                                                             FORMF075
      FCOU=0.5*ETAK/RCX                                                 FORMF076
      DO 42 M=1,400                                                     FORMF077
      MK=M+M-1                                                          FORMF078
      R=R+DR(N)                                                         FORMF079
      IF(R.GT.RCX) GO TO 40                                             FORMF080
      FC=FCOU*(3.0-(R/RCX)**2)                                          FORMF081
      GO TO 41                                                          FORMF082
   40 CONTINUE                                                          FORMF083
      FC=ETAK/R                                                         FORMF084
   41 CONTINUE                                                          FORMF085
      IF(N.NE.3) U(MK  )=U(MK  )+FK2(N)-FC                              FORMF086
      IF(N.EQ.3) U(MK+1)=U(MK+1)+FK2(N)-FC                              FORMF087
   42 CONTINUE                                                          FORMF088
      GO TO 67                                                          FORMF089
   66 CONTINUE                                                          FORMF090
      FK(N)=0.0                                                         FORMF091
      ETA(N)=0.0                                                        FORMF092
      ECM(N)=0.0                                                        FORMF093
      FMU(N)=FM(N)*FMA(N)/(FM(N)+FMA(N))
      FACT=2.0*FMU(N)*AMU/HBARC**2 
   67 CONTINUE                                                          FORMF094
      IF(N.NE.3) GO TO 68                                               FORMF095
      IF(ICON(4).EQ.2) GO TO 69                                         FORMF096
   68 CONTINUE                                                          FORMF097
      WRITE(6,9010)N                                                    FORMF098
      WRITE(6,9503)E,RY,AC(N),FS(N)                                     FORMF099
      WRITE(6,9504)FM(N),FMA(N)                                         FORMF100
      WRITE(6,9505)Z(N),ZA(N),PNLOC(N)                                  FORMF101
      WRITE(6,9500)                                                     FORMF102
      RHO=FK(N)*RC(N)                                                   FORMF103
      WRITE(6,9506)ECM(N),RC(N),RHO                                     FORMF104
      WRITE(6,9507)FK(N),ETA(N),DR(N)                                   FORMF105
      WRITE(6,9008)                                                     FORMF106
   69 CONTINUE                                                          FORMF107
      FS(N)=FS(N)/2.0                                                   FORMF108
      CALL POTS(U,V,N,LAM,AFACT,FACT,E,RM)                              FORMF109
      IF(N.NE.3) GO TO 3000                                             FORMF110
      IF(E.EQ.0.0) GO TO 3000                                           FORMF111
C                                                                       FORMF112
C     SINGL PARTICLE ORBITAL                                            FORMF113
C                                                                       FORMF114
C                                                                       FORMF115
C     READ IN QUANTUM NUMBERS FO SINGLE PARTICLE ORBITAL                FORMF116
C                                                                       FORMF117
      READ(5,9000)G,VTRIAL,FISW,DAMP                                    FORMF118
      ISW=FISW                                                          FORMF119
      WRITE(6,9500)                                                     FORMF120
      FJ=FJ2/2.0                                                        FORMF121
      IF(VTRIAL.EQ.0.0) VTRIAL=ETA6                                     FORMF122
      WRITE(6,9508)G,FISW                                               FORMF123
      IF(DAMP.EQ.0.0) GO TO 2021                                        FORMF124
      WRITE(6,9511)DAMP                                                 FORMF125
 2021 CONTINUE                                                          FORMF126
      FSS=FSS/2.0                                                       FORMF127
      FACT=(FJ**2+FJ-FL**2-FL-FSS**2-FSS)*0.5                           FORMF128
      DO 2028 M=1,400                                                   FORMF129
      MK=M+M-1                                                          FORMF130
      U(MK  )=U(MK  )+V(MK  )*FACT                                      FORMF131
      U(MK+1)=U(MK+1)+V(MK+1)*FACT                                      FORMF132
 2028 CONTINUE                                                          FORMF133
      WRITE(6,9500)                                                     FORMF134
      CALL BIND(U,  V     ,DR(3),RM,FN,FL,K,FK(3),ETA(3),VTRIAL,ECM(3)  FORMF135
     1,FK2(3),ISW,IBF(3))                                               FORMF136
      IBF(2)=RM/DR(3)                                                   FORMF137
      DO 2050 M=1,400                                                   FORMF138
      MK=M+M-1                                                          FORMF139
      V(M+400)=VTRIAL*U(MK  )+U(MK+1)                                   FORMF140
 2050 CONTINUE                                                          FORMF141
      SUM=1.0                                                           FORMF142
      FACT=PNLOC(3)**2/8.0                                              FORMF143
      IF(FACT.EQ.0.0) GO TO 2076                                        FORMF144
C                                                                       FORMF145
C     NON-LOCAL CORRECTION FOR SINGLE PARTICLE FUNCTION                 FORMF146
C                                                                       FORMF147
      SUM=0.0                                                           FORMF148
      R=0.0                                                             FORMF149
      DO 2075 M=1,K                                                     FORMF150
      MK=M+M-1                                                          FORMF151
      R=R+DR(3)                                                         FORMF152
      V(M)=V(M)*EXP(FACT*(FK2(3)-V(M+400)))                             FORMF153
      SUM=SUM+(V(M)*R)**2                                               FORMF154
 2075 CONTINUE                                                          FORMF155
      SUM=1.0/SQRT(SUM*DR(3))                                           FORMF156
C                                                                       FORMF157
C     DO NOT RENORMALIZE FOR POSITIVE ENERGY                            FORMF158
C                                                                       FORMF159
      IF(FK2(3).GT.0.0) SUM=1.0                                         FORMF160
 2076 CONTINUE                                                          FORMF161
      IF(DAMP.EQ.0.0) GO TO 2080                                        FORMF162
C                                                                       FORMF163
C     APPLY DAMPING FACTOR, EXP(-DAMP*R) TO FORM FACTOR                 FORMF164
C                                                                       FORMF165
      R=0.0                                                             FORMF166
      SUM=0.0                                                           FORMF167
      F1=1.0                                                            FORMF168
      F2=EXP(-DAMP*DR(3))                                               FORMF169
      DO 2077 M=1,K                                                     FORMF170
      F1=F1*F2                                                          FORMF171
      R=R+DR(3)                                                         FORMF172
      V(M)=V(M)*F1                                                      FORMF173
      SUM=SUM+(V(M)*R)**2                                               FORMF174
 2077 CONTINUE                                                          FORMF175
      SUM=1.0/SQRT(SUM*DR(3))                                           FORMF176
 2080 CONTINUE                                                          FORMF177
      DO 2100 M=1,400                                                   FORMF178
      MK=M+M-1                                                          FORMF179
      IF(M.GT.K) V(M)=0.0                                               FORMF180
      U(MK  )=V(M)*SUM                                                  FORMF181
      U(MK+1)=0.0                                                       FORMF182
      V(M)=V(M+400)                                                     FORMF183
 2100 CONTINUE                                                          FORMF184
 3000 CONTINUE                                                          FORMF185
      RETURN                                                            FORMF186
 9000 FORMAT(10F8.4)                                                    FORMF187
 9008 FORMAT(21H0POTENTIAL PARAMETERS )                                 FORMF188
 9010 FORMAT( 9H0PARTICLE,I2,120(1H*))                                  FORMF189
 9500 FORMAT(1H ,3A6,5(3X,A6,F9.4))                                     FORMF190
 9503 FORMAT(18H INPUT DATA       ,9H   ELAB =,F9.4,9H   RC0  =,F9.4,9H FORMF191
     1  AC   =,F9.4,9H   2*STR=,F9.4)                                   FORMF192
 9504 FORMAT(18X,9H   MASSP=,F9.4,9H   MASST=,F9.4)                     FORMF193
 9505 FORMAT(18X,9H   ZP   =,F9.4,9H   ZT   =,F9.4,9H   PNLOC=,F9.4)    FORMF194
 9506 FORMAT(18H DERIVED DATA     ,9H   ECM  =,F9.4,9H   RC   =,F9.4,9H FORMF195
     1  RHO  =,F9.4)                                                    FORMF196
 9507 FORMAT(18X,9H   K    =,F9.4,9H   ETA  =,F9.4,9H   DR   =,F9.4)    FORMF197
 9508 FORMAT(18X,9H   NODES=,F9.4,9H   L    =,F9.4,9H   2*J  =,F9.4,9H  FORMF198
     1 2*S  =,F9.4,9H   FISW =,F9.4)                                    FORMF199
 9511 FORMAT(18X,9H   DAMP =,F9.4)                                      FORMF200
      END                                                               FORMF201
C
C FYSKTT*DWUCK4-1(1).POTS(1)
C
      SUBROUTINE POTS(U,V,N,LAM,AFACT,FACT,E,RM)                        POTS   0
C     THE NEXT 5 CARDS CONVERT DWUCK TO AN IBM 360                      POTS   1
      IMPLICIT REAL*8(A-H,O-Z)                                          POTS   2
C     SQRT(XXX)=DSQRT(XXX)                                              POTS   3
C     ABS(XXX)=DABS(XXX)                                                POTS   4
C     AMAX1(XXX,YYY)=DMAX1(XXX,YYY)                                     POTS   5
C     EXP(XXX)=DEXP(XXX)                                                POTS   6
      COMMON ALPHA(15),IDAT(6),ICON(16),ANGLE(5),HBARC,AMU,AMASS,CHSQ,AAPOTS   7
     1,DRF,Z(3),ZA(3),FM(3),FMA(3),RC(3),AC(3),PNLOC(3),FS(3),ECM(3)    POTS   8
     2,FK(3),FK2(3),ETA(3),DR(3),FMU(3),FN,FL,FJ2,FSS,VCE,FNRNG,RSIG(2) POTS   9
     3,K,KZ,LPLUS,LPL2,IS(3),NS(3),NLTR,LTRT(8),JTRT(8),ISTRT(8),IBF(8) POTS  10
      DIMENSION UT(5),B(3,14),CN(16),CP(16),YLAM(16),X(8),W(8)          POTS  11
     1,U(800),V(800),ABETA(3),FLDF(3),LDFRM(3),G(4)                     POTS  12
      EQUIVALENCE (G,FN)                                                POTS  13
      DATA B(1,1),B(2,1),B(3,1)/6H NX=1 ,6HVOLUME,6HW-S   /             POTS  14
      DATA B(1,2),B(2,2),B(3,2)/6H NX=2 ,6HSURFAC,6HE W-S /             POTS  15
      DATA B(1,3),B(2,3),B(3,3)/6H NX=3 ,6H2ND DE,6HRIV   /             POTS  16
      DATA B(1,4),B(2,4),B(3,4)/6H NX=4 ,6HL.S VO,6HLUME  /             POTS  17
      DATA B(1,5),B(2,5),B(3,5)/6H NX=5 ,6HL.S SU,6HRFACE /             POTS  18
      DATA B(1,6),B(2,6),B(3,6)/6H NX=6 ,6HVOL*R*,6H*POWR /             POTS  19
      DATA B(1,7),B(2,7),B(3,7)/6H NX=7 ,6HSUR*R*,6H*POWR /             POTS  20
      DATA B(1,8),B(2,8),B(3,8)/6H NX=8 ,6HEXTERN,6H FORMF/             POTS  21
      DATA B(1,9),B(2,9),B(3,9)/6H NX=9 ,6HHARMON,6HIC OSC/             POTS  22
      DATA B(1,10),B(2,10),B(3,10)/6H NX=10,6H GAUSU,6HSIAN  /          POTS  23
      DATA B(1,11),B(2,11),B(3,11)/6H NX=11,6H DEFOR,6HM VOL /          POTS  24
      DATA B(1,12),B(2,12),B(3,12)/6H NX=12,6H DEFOR,6HM SURF/          POTS  25
      DATA B(1,13),B(2,13),B(3,13)/6H NX=13,6H HULTH,6HEN    /          POTS  26
      DATA B(1,14),B(2,14),B(3,14)/6H NX=14,6H MIXED,6H W-S  /          POTS  27
C                                                                       POTS  28
C     POINTS  FOR GAUSS LEGENDRE INTEGRATION                            POTS  29
C                                                                       POTS  30
      DATA X/.0950125098D0,.2816035507D0,.4580167776D0,.6178762444D0,   POTS  31
     1       .7554044083D0,.8656312023D0,.9445750230D0,.9894009439D0/   POTS  32
C                                                                       POTS  33
C     WEIGHTS FOR GAUSS LEGENDRE INTEGRATION                            POTS  34
C                                                                       POTS  35
      DATA W/.1894506104D0,.1826034150D0,.1691565193D0,.1495959888D0,   POTS  36
     1       .1246289712D0,.0951585116D0,.0622535239D0,.0271524594D0/   POTS  37
      DATA ETA4,ETA5/ 4.0D0,10.0D0/                                     POTS  38
      DATA SQRPI/1.772453851D0/                                         POTS  39
C                                                                       POTS  40
C     READ IN CARD SET 5,6,OR 7   POTENTIAL CARDS                       POTS  41
C                                                                       POTS  42
   70 CONTINUE                                                          POTS  43
      READ (5,9000)FZ,VR,RY,AR,VSOR,VI,RZ,AI,VSOI,PWR                   POTS  44
      NX=ABS(FZ)                                                        POTS  45
      RR=RY*AFACT                                                       POTS  46
      RI=RZ*AFACT                                                       POTS  47
      IF(N.NE.3) GO TO 74                                               POTS  48
      IF(ICON(4).EQ.2) GO TO 75                                         POTS  49
   74 CONTINUE                                                          POTS  50
      WRITE(6,9509)(B(J,NX),J=1,3),VR,RY,AR,RR,VSOR                     POTS  51
      WRITE(6,9510)                VI,RZ,AI,RI,VSOI,PWR                 POTS  52
   75 CONTINUE                                                          POTS  53
C      NX=1 VOLUME WOODS-SAXON                                          POTS  54
C      NX=2 SURFACE WOODS-SAXON                                         POTS  55
C      NX=3 SECOND DERIVATIVE WOODS-SAXON                               POTS  56
C      NX=4 L.S POTENTIAL FOR WOODS-SAXON VOLUME                        POTS  57
C      NX=5 L.S POTENTIAL FOR WOODS-SAXON SURFACE                       POTS  58
C      NX=6 WOOD-SAXON*R**PWR                                           POTS  59
C      NX=7 1ST-DER WOOD-SAXON*R**PWR                                   POTS  60
C      NX=8 FORMF8 EXTERNAL FORM FACTOR                                 POTS  61
C      NX=9 HARMONIC OSCILLATOR                                         POTS  62
C     NX=10 GAUSSIAN*R**PWR                                             POTS  63
C     NX=11 DEFORMED VOLUNME                                            POTS  64
C     NX=12 DEFORMED SURFACE                                            POTS  65
      KFLAG=0                                                           POTS  66
      IF(N-3)79,76,79                                                   POTS  67
   76 CONTINUE                                                          POTS  68
      IF(E)81,80,81                                                     POTS  69
   79 CONTINUE                                                          POTS  70
      VR=VR*FACT                                                        POTS  71
      VI=VI*FACT                                                        POTS  72
      KT=FK(N)*AMAX1(RR,RI)+ETA5                                        POTS  73
      LPLUS=MAX0(LPLUS,KT)                                              POTS  74
   80 KT=(2.3*ETA4*AMAX1(AR,AI)+AMAX1(RR,RI))/DR(N)                     POTS  75
      GO TO 82                                                          POTS  76
   81 CONTINUE                                                          POTS  77
      RM=AMAX1(RR,RM)                                                   POTS  78
      VR=VR*FACT                                                        POTS  79
      VI=VI*FACT                                                        POTS  80
      ALPHB=2.3*ETA4                                                    POTS  81
      TEMP=1.0+ALPHB/10.0                                               POTS  82
      KT=((ALPHB-ETA(N)*TEMP)/FK(N)+RR)/DR(N)                           POTS  83
   82 K=MIN0(MAX0(K,KT),400)                                            POTS  84
   83 CONTINUE                                                          POTS  85
      IF(AR.NE.0.0) GO TO 85                                            POTS  86
      F1=0.0                                                            POTS  87
      F2=0.                                                             POTS  88
      GO TO 86                                                          POTS  89
   85 F2=EXP(-DR(N)/AR)                                                 POTS  90
      F1=EXP( RR/AR)                                                    POTS  91
   86 CONTINUE                                                          POTS  92
      IF(AI.NE.0.0) GO TO 95                                            POTS  93
      F3=0.0                                                            POTS  94
      F4=0.                                                             POTS  95
      GO TO 96                                                          POTS  96
   95 F4=EXP(-DR(N)/AI)                                                 POTS  97
      F3=EXP( RI/AI)                                                    POTS  98
   96 CONTINUE                                                          POTS  99
      IF(N.NE.3 ) GO TO 98                                              POTS 100
      IF(E.NE.0.0) GO TO 98                                             POTS 101
      IF(NX.GT.5) GO TO 98                                              POTS 102
      PWR=PWR+1.0                                                       POTS 103
      IF(AR.NE.0.0) VR=VR*(RR/AR)**PWR                                  POTS 104
      IF(AI.NE.0.0) VI=VI*(RI/AI)**PWR                                  POTS 105
   98 CONTINUE                                                          POTS 106
      IF(NX.EQ.0) GO TO 2009                                            POTS 107
      GO TO (100,200,300,400,500,600,700,800,900,1000,1100,1200         POTS 108
     1,1300,1400),NX                                                    POTS 109
C                                                                       POTS 110
C     VOLUME WOODS SAXON                                                POTS 111
C                                                                       POTS 112
  100 CONTINUE                                                          POTS 113
      DO 160 M=1,K                                                      POTS 114
      MK=M+M-1                                                          POTS 115
      F1=F1*F2                                                          POTS 116
      F3=F3*F4                                                          POTS 117
      U(MK  )=U(MK  )-VR*F1/(1.0+F1)                                    POTS 118
      U(MK+1)=U(MK+1)-VI*F3/(1.0+F3)                                    POTS 119
  160 CONTINUE                                                          POTS 120
      GO TO 2000                                                        POTS 121
C                                                                       POTS 122
C     1ST DER WOODS SAXON                                               POTS 123
C                                                                       POTS 124
  200 CONTINUE                                                          POTS 125
      DO 260 M=1,K                                                      POTS 126
      MK=M+M-1                                                          POTS 127
      F1=F1*F2                                                          POTS 128
      F3=F3*F4                                                          POTS 129
      U(MK  )=U(MK  )+VR*F1/(1.0+F1)**2                                 POTS 130
      U(MK+1)=U(MK+1)+VI*F3/(1.0+F3)**2                                 POTS 131
  260 CONTINUE                                                          POTS 132
      GO TO 2000                                                        POTS 133
C                                                                       POTS 134
C     2ND DER WOODS SAXON                                               POTS 135
C                                                                       POTS 136
  300 CONTINUE                                                          POTS 137
      DO 360 M=1,K                                                      POTS 138
      MK=M+M-1                                                          POTS 139
      F1=F1*F2                                                          POTS 140
      F3=F3*F4                                                          POTS 141
      U(MK  )=U(MK  )-VR*F1*(1.0-F1)/(1.0+F1)**3                        POTS 142
      U(MK+1)=U(MK+1)-VI*F3*(1.0-F3)/(1.0+F3)**3                        POTS 143
  360 CONTINUE                                                          POTS 144
      GO TO 2000                                                        POTS 145
C                                                                       POTS 146
C     L.S VOLUME WOODS SAXON                                            POTS 147
C                                                                       POTS 148
  400 CONTINUE                                                          POTS 149
      IBF(4)=1                                                          POTS 150
      IF(AR.NE.0.0) VR=VR/AR                                            POTS 151
      IF(AI.NE.0.0) VI=VI/AI                                            POTS 152
      R=0.0                                                             POTS 153
      DO 460 M=1,K                                                      POTS 154
      R=R+DR(N)                                                         POTS 155
      MK=M+M-1                                                          POTS 156
      F1=F1*F2                                                          POTS 157
      F3=F3*F4                                                          POTS 158
      V(MK  )=V(MK  )-VR*F1/(R*(1.0+F1)**2)                             POTS 159
      V(MK+1)=V(MK+1)-VI*F3/(R*(1.0+F3)**2)                             POTS 160
  460 CONTINUE                                                          POTS 161
      GO TO 2000                                                        POTS 162
C                                                                       POTS 163
C     L.S 1ST DER WOODS SAXON                                           POTS 164
C                                                                       POTS 165
  500 CONTINUE                                                          POTS 166
      IBF(4)=1                                                          POTS 167
      IF(AR.NE.0.0) VR=VR/AR                                            POTS 168
      IF(AI.NE.0.0) VI=VI/AI                                            POTS 169
      R=0.0                                                             POTS 170
      DO 560 M=1,K                                                      POTS 171
      R=R+DR(N)                                                         POTS 172
      MK=M+M-1                                                          POTS 173
      F1=F1*F2                                                          POTS 174
      F3=F3*F4                                                          POTS 175
      V(MK  )=V(MK  )+VR*F1*(1.0-F1)/(R*(1.0+F1)**3)                    POTS 176
      V(MK+1)=V(MK+1)+VI*F3*(1.0-F3)/(R*(1.0+F3)**3)                    POTS 177
  560 CONTINUE                                                          POTS 178
      GO TO 2000                                                        POTS 179
C                                                                       POTS 180
C     WOOD SAXON*R**PWR                                                 POTS 181
C                                                                       POTS 182
  600 CONTINUE                                                          POTS 183
      R=0.0                                                             POTS 184
      DO 660 M=1,K                                                      POTS 185
      R=R+DR(N)                                                         POTS 186
      MK=M+M-1                                                          POTS 187
      F1=F1*F2                                                          POTS 188
      F3=F3*F4                                                          POTS 189
      RPWR=R**PWR                                                       POTS 190
      U(MK  )=U(MK  )-VR*F1*RPWR/(1.0+F1)                               POTS 191
      U(MK+1)=U(MK+1)-VI*F3*RPWR/(1.0+F3)                               POTS 192
  660 CONTINUE                                                          POTS 193
      GO TO 2000                                                        POTS 194
C                                                                       POTS 195
C      1ST DER WOOD SAXON*R**PWR                                        POTS 196
C                                                                       POTS 197
  700 CONTINUE                                                          POTS 198
      R=0.0                                                             POTS 199
      DO 760 M=1,K                                                      POTS 200
      R=R+DR(N)                                                         POTS 201
      MK=M+M-1                                                          POTS 202
      F1=F1*F2                                                          POTS 203
      F3=F3*F4                                                          POTS 204
      RPWR=R**PWR                                                       POTS 205
      U(MK  )=U(MK  )+VR*F1*RPWR/(1.0+F1)**2                            POTS 206
      U(MK+1)=U(MK+1)+VI*F3*RPWR/(1.0+F3)**2                            POTS 207
  760 CONTINUE                                                          POTS 208
      GO TO 2000                                                        POTS 209
C                                                                       POTS 210
C     EXTERNAL FORM FACTOR                                              POTS 211
C                                                                       POTS 212
  800 CONTINUE                                                          POTS 213
      IF(N.GT.2.AND.ICON(2).EQ.2) READ (5,9000)G
      FSS=FSS*0.5  
      READ(5,9000)F1,F2                                                 POTS 214
      F3=VR                                                             POTS 215
      IF(F2.NE.0.0) F3=VI                                               POTS 216
      IF(F3.EQ.0.0) F3=1.0                                              POTS 217
      KT=F1                                                             POTS 218
      MK=F2+1.0                                                         POTS 219
      DO 860 M=1,KT,5                                                   POTS 220
      READ(5,9100)UT                                                    POTS 221
      DO 850 I=1,5                                                      POTS 222
      U(MK  )=U(MK  )+UT(I)*F3                                          POTS 223
      MK=MK+2                                                           POTS 224
  850 CONTINUE                                                          POTS 225
  860 CONTINUE                                                          POTS 226
      K=MAX0(K,KT)                                                      POTS 227
      GO TO 2000                                                        POTS 228
C                                                                       POTS 229
C     HARMONIC OSCILLATOR                                               POTS 230
C                                                                       POTS 231
  900 CONTINUE                                                          POTS 232
      READ (5,9000)G                                                    POTS 233
      WRITE(6,9508)G                                                    POTS 234
      F1=1.0/RY**2                                                      POTS 235
      F2=F1/RY                                                          POTS 236
      F3=0.5                                                            POTS 237
      F4=SQRPI*0.5                                                      POTS 238
      L=FL                                                              POTS 239
      IF(L.EQ.0) GO TO 931                                              POTS 240
      DO 930 I=1,L                                                      POTS 241
      F3=F3+1.0                                                         POTS 242
      F4=F4*F3                                                          POTS 243
      F2=F2*F1                                                          POTS 244
  930 CONTINUE                                                          POTS 245
  931 CONTINUE                                                          POTS 246
      NN=FN                                                             POTS 247
      T1=1.0                                                            POTS 248
      T2=F4                                                             POTS 249
      CN(1)=(-1.0)**NN                                                  POTS 250
      IF(NN.EQ.0) GO TO 941                                             POTS 251
      DO 940 I=1,NN                                                     POTS 252
      F3=F3+1.0                                                         POTS 253
      T1=T1*FLOAT(I)                                                    POTS 254
      T2=T2*F3                                                          POTS 255
      CN(I+1)=-CN(I)*F1*FLOAT(NN+1-I)/(FLOAT(I)*F3)                     POTS 256
  940 CONTINUE                                                          POTS 257
  941 CONTINUE                                                          POTS 258
      T2=SQRT(2.0*F2*T2/T1)/F4                                          POTS 259
      IF(VR.NE.0.0) T2=T2*VR                                            POTS 260
      KT=10.0*RY/DR(N)                                                  POTS 261
      KT=MIN0(KT,K)                                                     POTS 262
      R=0.0                                                             POTS 263
      F1=F1/2.0                                                         POTS 264
      DO 960 M=1,KT                                                     POTS 265
      MK=M+M-1                                                          POTS 266
      R=R+DR(N)                                                         POTS 267
      R2=R**2                                                           POTS 268
      F2=CN(1)                                                          POTS 269
      IF(NN.EQ.0) GO TO 951                                             POTS 270
      F3=1.0                                                            POTS 271
      DO 950 I=1,NN                                                     POTS 272
      F3=F3*R2                                                          POTS 273
      F2=F2+CN(I+1)*F3                                                  POTS 274
  950 CONTINUE                                                          POTS 275
  951 CONTINUE                                                          POTS 276
      U(MK  )=U(MK  )+F2*T2*EXP(-F1*R2)*R**L                            POTS 277
  960 CONTINUE                                                          POTS 278
      GO TO 2000                                                        POTS 279
C                                                                       POTS 280
C     EXP(-(R/R0)**2)*R**POWR                                           POTS 281
C                                                                       POTS 282
 1000 CONTINUE                                                          POTS 283
      IF(VR.EQ.0.0) GO TO 1061                                          POTS 284
      R=0.0                                                             POTS 285
      DO 1060 M=1,K                                                     POTS 286
      MK=M+M-1                                                          POTS 287
      R=R+DR(N)                                                         POTS 288
      U(MK  )=U(MK  )-VR*EXP(-(R/RY)**2)*R**PWR                         POTS 289
 1060 CONTINUE                                                          POTS 290
 1061 CONTINUE                                                          POTS 291
      IF(VI.EQ.0.0) GO TO 1071                                          POTS 292
      R=0.0                                                             POTS 293
      DO 1070 M=1,K                                                     POTS 294
      MK=M+M-1                                                          POTS 295
      R=R+DR(N)                                                         POTS 296
      U(MK+1)=U(MK+1)-VI*EXP(-(R/RZ)**2)*R**PWR                         POTS 297
 1070 CONTINUE                                                          POTS 298
 1071 CONTINUE                                                          POTS 299
      GO TO 2000                                                        POTS 300
C                                                                       POTS 301
C     DEFORMED VOLUME OR SURFACE BY YLM EXPANSION                       POTS 302
C                                                                       POTS 303
 1100 CONTINUE                                                          POTS 304
      READ (5,9000) (ABETA(J),FLDF(J ),J=1,3)                           POTS 305
      WRITE(6,9512) (ABETA(J),FLDF(J) ,J=1,3)                           POTS 306
      LMAX=LAM+1                                                        POTS 307
      DO 1101 J=1,3                                                     POTS 308
      LDFRM(J)=FLDF(J)                                                  POTS 309
      LMAX=MAX0(LMAX,LDFRM(J)+1)                                        POTS 310
 1101 CONTINUE                                                          POTS 311
      T2=(-1.0)**LAM                                                    POTS 312
C                                                                       POTS 313
      DO 1108 I=1,8                                                     POTS 314
      CN(I  )=0.0                                                       POTS 315
      CN(I+8)=0.0                                                       POTS 316
      P2=0.0                                                            POTS 317
      P3=1.0                                                            POTS 318
C                                                                       POTS 319
      DO 1106 M=1,LMAX                                                  POTS 320
      L=M-1                                                             POTS 321
      FL=L-1                                                            POTS 322
      IF(L.EQ.0) GO TO 1102                                             POTS 323
      P3=((2.0*FL+1.0)*X(I)*P2-FL*P1)/(FL+1.0)                          POTS 324
 1102 CONTINUE                                                          POTS 325
      DO 1103 J=1,3                                                     POTS 326
      IF(ABETA(J).EQ.0.0) GO TO 1103                                    POTS 327
      IF(L.NE.LDFRM(J)) GO TO 1103                                      POTS 328
      FACTOR=P3*ABETA(J)*SQRT(FLOAT(L+L+1))/(SQRPI*2.0)                 POTS 329
      CN(I  )=CN(I  )+FACTOR                                            POTS 330
      CN(I+8)=CN(I+8)+FACTOR*(-1.0)**LDFRM(J)                           POTS 331
 1103 CONTINUE                                                          POTS 332
      IF(L.NE.LAM) GO TO 1104                                           POTS 333
      YLAM(I  )= P3*W(I)*SQRT(FLOAT(L+L+1))*SQRPI                       POTS 334
      YLAM(I+8)=YLAM(I  )*T2                                            POTS 335
 1104 CONTINUE                                                          POTS 336
      P1=P2                                                             POTS 337
      P2=P3                                                             POTS 338
 1106 CONTINUE                                                          POTS 339
 1108 CONTINUE                                                          POTS 340
      DO 1170 I=1,2                                                     POTS 341
      GO TO (1110,1120),I                                               POTS 342
 1110 CONTINUE                                                          POTS 343
      IF(VR.EQ.0.0) GO TO 1170                                          POTS 344
      VX=VR                                                             POTS 345
      RX=RR                                                             POTS 346
      AX=AR                                                             POTS 347
      F1=1.0                                                            POTS 348
      IFL=-1                                                            POTS 349
      GO TO 1130                                                        POTS 350
 1120 CONTINUE                                                          POTS 351
      IF(VI.EQ.0.0) GO TO 1170                                          POTS 352
      VX=VI                                                             POTS 353
      RX=RI                                                             POTS 354
      AX=AI                                                             POTS 355
      F1=1.0                                                            POTS 356
      F2=F4                                                             POTS 357
      IFL=0                                                             POTS 358
 1130 CONTINUE                                                          POTS 359
      DO 1135 J=1,16                                                    POTS 360
      CP(J)=EXP((1.0+CN(J))*RX/AX)                                      POTS 361
 1135 CONTINUE                                                          POTS 362
      IF(LAM.EQ.0) VX=VX/(SQRPI*2.0)                                    POTS 363
      J=NX-10                                                           POTS 364
      GO TO (1141,1151),J                                               POTS 365
 1141 CONTINUE                                                          POTS 366
      DO 1150 M=1,K                                                     POTS 367
      MK=M+M+IFL                                                        POTS 368
      VTEMP=0.0                                                         POTS 369
      F1=F1*F2                                                          POTS 370
      DO 1145 J=1,16                                                    POTS 371
      F3=F1*CP(J)                                                       POTS 372
      VTEMP=VTEMP-YLAM(J)*VX*F3/(1.0+F3)                                POTS 373
 1145 CONTINUE                                                          POTS 374
      U(MK  )=U(MK  )+VTEMP                                             POTS 375
 1150 CONTINUE                                                          POTS 376
      GO TO 1170                                                        POTS 377
 1151 CONTINUE                                                          POTS 378
      DO 1160 M=1,K                                                     POTS 379
      MK=M+M+IFL                                                        POTS 380
      VTEMP=0.0                                                         POTS 381
      F1=F1*F2                                                          POTS 382
      DO 1155 J=1,16                                                    POTS 383
      F3=F1*CP(J)                                                       POTS 384
      VTEMP=VTEMP+YLAM(J)*VX*F3/(1.0+F3)**2                             POTS 385
 1155 CONTINUE                                                          POTS 386
      U(MK  )=U(MK  )+VTEMP                                             POTS 387
 1160 CONTINUE                                                          POTS 388
 1170 CONTINUE                                                          POTS 389
      GO TO 2000                                                        POTS 390
 1200 CONTINUE                                                          POTS 391
      GO TO 1100                                                        POTS 392
C                                                                       POTS 393
C     HULTHEN WAVE FUNCTION =NORM*(EXP(-R/RY)-EXP(-R/RZ))/R             POTS 394
C                                                                       POTS 395
 1300 CONTINUE                                                          POTS 396
      IF(N.GT.2.AND.ICON(2).EQ.2) READ (5,9000)G
      FSS=FSS*0.5  
      T1=1.0/RY                                                         POTS 397
      T2=1.0/RZ                                                         POTS 398
      T3=T2**2-T1**2                                                    POTS 399
      T4=SQRT(2.0*T1*(T1+T2)*T2)/(T2-T1)                                POTS 400
      F1=1.0                                                            POTS 401
      F2=EXP(-DR(N)*T1)                                                 POTS 402
      F3=1.0                                                            POTS 403
      F4=EXP(-DR(N)*T2)                                                 POTS 404
      R=0.0                                                             POTS 405
      DO 1360 M=1,K                                                     POTS 406
      MK=M+M-1                                                          POTS 407
      R=R+DR(N)                                                         POTS 408
      F1=F1*F2                                                          POTS 409
      F3=F3*F4                                                          POTS 410
      V(M)=T3*F3/(F1-F3)                                                POTS 411
      TEMP=1.0                                                          POTS 412
      IF(VR.NE.0.0) TEMP=V(M)/FACT                                      POTS 413
      U(MK  )=U(MK  )+TEMP*T4*(F1-F3)/R                                 POTS 414
 1360 CONTINUE                                                          POTS 415
      GO TO 2000                                                        POTS 416
 1400 CONTINUE                                                          POTS 417
      DO 1460 M=1,K                                                     POTS 418
      MK=M+M-1                                                          POTS 419
      F1=F1*F2                                                          POTS 420
      F3=F3*F4                                                          POTS 421
      U(MK  )=U(MK  )-VR*F1/(1.0+F1)                                    POTS 422
      U(MK+1)=U(MK+1)+VI*F3/(1.0+F3)**2                                 POTS 423
 1460 CONTINUE                                                          POTS 424
      GO TO 2000                                                        POTS 425
 2000 CONTINUE                                                          POTS 426
      IF(KFLAG.NE.0) GO TO 2009                                         POTS 427
      IF(ABS(VSOR)+ABS(VSOI).EQ.0.0) GO TO 2009                         POTS 428
      NX=NX+3                                                           POTS 429
      IF(NX.EQ.17) GO TO 2008                                           POTS 430
      IF(NX.GT.5) GO TO 2009                                            POTS 431
 2008 CONTINUE                                                          POTS 432
      KFLAG=1                                                           POTS 433
      VR=VR*VSOR/45.2                                                   POTS 434
      VI=VI*VSOI/45.2                                                   POTS 435
      GO TO 83                                                          POTS 436
 2009 CONTINUE                                                          POTS 437
      IF(FZ.GT.0.0) GO TO 70                                            POTS 438
      RETURN                                                            POTS 439
 9000 FORMAT(10F8.4)                                                    POTS 440
 9100 FORMAT(5E16.7)                                                    POTS 441
 9508 FORMAT(18X,9H   NODES=,F9.4,9H   L    =,F9.4,9H   2*J  =,F9.4,9H  POTS 442
     1 2*S  =,F9.4,9H   FISW =,F9.4)                                    POTS 443
 9509 FORMAT(3A6,9H   V RL =,F9.4,9H   R0RL =,F9.4,9H   A RL =,F9.4,9H  POTS 444
     1 R RL =,F9.4,9H   VSOR =,F9.4)                                    POTS 445
 9510 FORMAT(18X,9H   V IM =,F9.4,9H   R0IM =,F9.4,9H   A IM =,F9.4,9H  POTS 446
     1 R IM =,F9.4,9H   VSOI =,F9.4,9H   POWR =,F9.4)                   POTS 447
 9512 FORMAT(18X,9H   BETA1=,F9.4,9H   LDFR1=,F9.4,9H   BETA2=,F9.4,9H  POTS 448
     1 LDFR2=,F9.4,9H   BETA3=,F9.4,9H   LDFR3=,F9.4)                   POTS 449
      END                                                               POTS 450
C
C FYSKTT*DWUCK4-1(1).INTEG(0)
C
      SUBROUTINE INTEG                                                  INTEG000
C     THE NEXT 4 CARDS CONVERT DWUCK TO AN IBM 360                      INTEG001
      IMPLICIT REAL*8(A-H,O-Z)                                          INTEG002
C     ABS(XXX)=DABS(XXX)                                                INTEG003
C     SIN(XXX)=DSIN(XXX)                                                INTEG004
C     COS(XXX)=DCOS(XXX)                                                INTEG005
      COMMON ALPHA(15),IDAT(6),ICON(16),ANGLE(5),HBARC,AMU,AMASS,CHSQ,AAINTEG006
     1,DRF,Z(3),ZA(3),FM(3),FMA(3),RC(3),AC(3),PNLOC(3),FS(3),ECM(3)    INTEG007
     2,FK(3),FK2(3),ETA(3),DR(3),FMU(3),FN,FL,FJ2,FSS,VCE,FNRNG,RSIG(2) INTEG008
     3,K,KZ,LPLUS,LPL2,IS(3),NS(3),NLTR,LTRT(8),JTRT(8),ISTRT(8),IBF(8) INTEG009
     4,IBUFF,IWORD,ILINE                                                INTEG010
     5,U(800,2),V(800,2),SPACE(3200),UB(800),BUFFR(1024)                INTEG011
      DIMENSION F(150),FP(150),G(150),GP(150),S(150)                    INTEG012
     1         ,F1(600),F2(600),Q1(600),Q2(600),Q3(600),C(600)          INTEG013
     2         ,D (600),E (600)                                         INTEG014
     3         ,DTEMP(6400)                                             INTEG015
     4         ,Q(4),A(2),B(2),CTEMP(2),LM(6),DRR2(2),DR2(2),R(2)       INTEG016
      EQUIVALENCE (U,DTEMP),(U,C)                                       INTEG017
      EQUIVALENCE (DTEMP(3201),F1),(DTEMP(3801),F2),(DTEMP(4401),Q1)    INTEG018
     1           ,(DTEMP(5001),Q2),(DTEMP(5601),Q3),(DTEMP(3201),D )    INTEG019
     2           ,(DTEMP(3801),E ),(DTEMP(4401),F ),(DTEMP(4551),FP)    INTEG020
     3           ,(DTEMP(4701),G ),(DTEMP(4851),GP),(DTEMP(5001),S )    INTEG021
      DATA ETA1,ETA2,ETA3/1.0D-08,1.0D-01,1.0D+01/                      INTEG022
      IWORD=0                                                           INTEG023
      JT=NS(1)+NS(2)                                                    INTEG024
      NP=LPL2*JT                                                        INTEG025
      I=0                                                               INTEG026
      DO 30 N=1,2                                                       INTEG027
      DR2(N)=DR(N)**2/12.0                                              INTEG028
      R(N)=0.0                                                          INTEG029
      JS=NS(N)                                                          INTEG030
      DO 29 ISS=1,JS                                                    INTEG031
      I=I+1                                                             INTEG032
      LM(I)=0                                                           INTEG033
   29 CONTINUE                                                          INTEG034
   30 CONTINUE                                                          INTEG035
      DO 40 IQ=1,NP                                                     INTEG036
      F1(IQ)=0.0                                                        INTEG037
      F2(IQ)=0.0                                                        INTEG038
      Q1(IQ)=0.0                                                        INTEG039
      Q2(IQ)=0.0                                                        INTEG040
   40 CONTINUE                                                          INTEG041
      DO 100 M=1,K                                                      INTEG042
      MK=M+M-1                                                          INTEG043
      IX=0                                                              INTEG044
      I=0                                                               INTEG045
      DO 90 N=1,2                                                       INTEG046
      R(N)=R(N)+DR(N)                                                   INTEG047
      DRR2(N)=DR2(N)/R(N)**2                                            INTEG048
      Q(1)=1.0+DR2(N)*U(MK  ,N)                                         INTEG049
      Q(2)=    DR2(N)*U(MK+1,N)                                         INTEG050
      LTEMP=2.0*FK(N)*R(N)+ETA3                                         INTEG051
      LTEMP=MIN0(LTEMP,LPLUS)                                           INTEG052
      FI=-FS(N)                                                         INTEG053
      JS=NS(N)                                                          INTEG054
      SFACT=FS(N)**2+FS(N)                                              INTEG055
      DO 89 ISS=1,JS                                                    INTEG056
      I=I+1                                                             INTEG057
      FL=0.0                                                            INTEG058
      DO 80 LL=1,LPLUS                                                  INTEG059
      FJ=FL+FI                                                          INTEG060
      IX1=IX+LL+LL-1                                                    INTEG061
      FLFACT=FL**2+FL                                                   INTEG062
      FACT=DR2(N)*(FJ**2+FJ-FLFACT-SFACT)*0.5                           INTEG063
      Q3(IX1  )=Q(1)+FACT*V(MK  ,N)-DRR2(N)*FLFACT                      INTEG064
      Q3(IX1+1)=Q(2)+FACT*V(MK+1,N)                                     INTEG065
      IF(LL.LE.LM(I)) GO TO 70                                          INTEG066
      IF(LTEMP-LL)72,65,65                                              INTEG067
   65 CONTINUE                                                          INTEG068
      LM(I)=LM(I)+1                                                     INTEG069
      IF(FJ-ABS(FL-FS(N)).LT.0.0) GO TO 72 
      F2(IX1  )=ETA1                                                    INTEG070
      F2(IX1+1)=0.0                                                     INTEG071
      Q2(IX1  )=ETA1*Q3(IX1  ) 
      Q2(IX1+1)=ETA1*Q3(IX1+1) 
C                                                                       INTEG072
C     EVALUATE Q AT ORIGIN FOR L=1                                      INTEG073
C                                                                       INTEG074
      IF(LL.EQ.2) Q1(IX+3)=-ETA1/6.0
      GO TO 72 
   70 CONTINUE                                                          INTEG077
      CTEMP(1)=12.*F2(IX1  )-10.*Q2(IX1  )-Q1(IX1  )                    INTEG080
      CTEMP(2)=12.*F2(IX1+1)-10.*Q2(IX1+1)-Q1(IX1+1)                    INTEG081
      F1(IX1  )=F2(IX1  )                                               INTEG082
      F1(IX1+1)=F2(IX1+1)                                               INTEG083
      DET=Q3(IX1  )**2+Q3(IX1+1)**2                                     INTEG079
      F2(IX1  )=(CTEMP(1)*Q3(IX1  )+CTEMP(2)*Q3(IX1+1))/DET             INTEG084
      F2(IX1+1)=(CTEMP(2)*Q3(IX1  )-CTEMP(1)*Q3(IX1+1))/DET             INTEG085
      Q1(IX1  )=Q2(IX1  )                                               INTEG087
      Q1(IX1+1)=Q2(IX1+1)                                               INTEG088
      Q2(IX1  )=CTEMP(1)
      Q2(IX1+1)=CTEMP(2)
   72 CONTINUE                                                          INTEG086
      FL=FL+1.0                                                         INTEG091
   80 CONTINUE                                                          INTEG092
      FI=FI+1.0                                                         INTEG093
      IX=IX+LPL2                                                        INTEG094
   89 CONTINUE                                                          INTEG095
   90 CONTINUE                                                          INTEG096
C                                                                       INTEG097
C     WRITE RADIAL WAVE FUNCTIONS ON TAPE 4                             INTEG098
C                                                                       INTEG099
      DO 92 IQ=1,NP                                                     INTEG100
      IWORD=IWORD+1                                                     INTEG101
      BUFFR(IWORD)=F2(IQ)                                               INTEG102
   92 CONTINUE                                                          INTEG103
      IF(M.EQ.K) GO TO 95                                               INTEG104
      IF(IWORD+NP.LT.IBUFF) GO TO 96                                    INTEG105
   95 CONTINUE                                                          INTEG106
      WRITE(4)(BUFFR(J),J=1,IBUFF)                                      INTEG107
      IWORD=0                                                           INTEG108
   96 CONTINUE                                                          INTEG109
  100 CONTINUE                                                          INTEG110
      IX=0                                                              INTEG111
      I=0                                                               INTEG112
      DO 200 N=1,2                                                      INTEG113
      R2=FK(N)*R(N)                                                     INTEG114
      R1=R2-DR(N)*FK(N)                                                 INTEG115
      CALL COU(R1,R2,ETA(N),LPLUS,ETA2,F,FP,G,GP,S)                     INTEG116
      JS=NS(N)                                                          INTEG117
      FI=-FS(N)                                                         INTEG118
      RSIG(N)=0.0                                                       INTEG119
      DO 199 ISS=1,JS                                                   INTEG120
      I=I+1                                                             INTEG121
      FL=0.0                                                            INTEG122
      DO 190 LL=1,LPLUS                                                 INTEG123
      FJ=FL+FI                                                          INTEG124
      LK=LL+LL-1                                                        INTEG125
      IX1=IX+LL+LL-1                                                    INTEG126
      DET=F(LL)*GP(LL)-FP(LL)*G(LL)                                     INTEG127
      A(1)=(F1(IX1  )*GP(LL)-F2(IX1  )*G (LL))/DET                      INTEG128
      A(2)=(F1(IX1+1)*GP(LL)-F2(IX1+1)*G (LL))/DET                      INTEG129
      B(1)=(F2(IX1  )*F (LL)-F1(IX1  )*FP(LL))/DET                      INTEG130
      B(2)=(F2(IX1+1)*F (LL)-F1(IX1+1)*FP(LL))/DET                      INTEG131
      IF(LL-LM(I))180,180,170                                           INTEG132
  170 CONTINUE                                                          INTEG133
      CTEMP(1)=0.0                                                      INTEG134
      CTEMP(2)=0.0                                                      INTEG135
      Q(1)=0.0                                                          INTEG136
      Q(2)=0.0                                                          INTEG137
      GO TO 185                                                         INTEG138
  180 CONTINUE                                                          INTEG139
      IF(FJ-ABS(FL-FS(N)).LT.0.0) GO TO 170                             INTEG140
      ARG=S(LL)-S(1)                                                    INTEG141
      Q(1)=COS(ARG)                                                     INTEG142
      Q(2)=SIN(ARG)                                                     INTEG143
      DET=(A(1)+B(2))**2+(A(2)-B(1))**2                                 INTEG144
      CTEMP(1)=(A(1)+B(2))/DET                                          INTEG145
      CTEMP(2)=(B(1)-A(2))/DET                                          INTEG146
  185 CONTINUE                                                          INTEG147
C                                                                       INTEG148
C     C=NORMALIZATION CONSTANTS                                         INTEG149
C                                                                       INTEG150
      C(IX1  )=Q(1)*CTEMP(1)-Q(2)*CTEMP(2)                              INTEG151
      C(IX1+1)=Q(1)*CTEMP(2)+Q(2)*CTEMP(1)                              INTEG152
C                                                                       INTEG153
C     E=PARTIAL WAVE SCATTERING AMPLITUDES                              INTEG154
C                                                                      IINTEG155
      E(IX1  )=B(1)*CTEMP(1)-B(2)*CTEMP(2)                              INTEG156
      E(IX1+1)=B(1)*CTEMP(2)+B(2)*CTEMP(1)                              INTEG157
      Q(3)=Q(1)**2-Q(2)**2                                              INTEG158
      Q(4)=2.0*Q(1)*Q(2)                                                INTEG159
C                                                                       INTEG160
C     D=PARTIAL WAVE SCATTERING AMPLITUDES* COULOMB PHASE / WAVE NUMBER INTEG161
C                                                                       INTEG162
      D(IX1  )=(Q(3)*E(IX1  )-Q(4)*E(IX1+1))/FK(N)                      INTEG163
      D(IX1+1)=(Q(3)*E(IX1+1)+Q(4)*E(IX1  ))/FK(N)                      INTEG164
C                                                                       INTEG165
C     CALCULATE REACTION SIGMA                                          INTEG166
C                                                                       INTEG167
      RSIG(N)=RSIG(N)+(2.0*FJ+1.0)*(E(IX1+1)-E(IX1  )**2-E(IX1+1)**2)   INTEG168
      FL=FL+1.0                                                         INTEG169
  190 CONTINUE                                                          INTEG170
      FI=FI+1.0                                                         INTEG171
      IX=IX+LPL2                                                        INTEG172
  199 CONTINUE                                                          INTEG173
      RSIG(N)=RSIG(N)*12.566371 /((2.0*FS(N)+1.0)*FK(N)**2)             INTEG174
  200 CONTINUE                                                          INTEG175
C                                                                       INTEG176
C     WRITE NORMALIZATION CONSTANTS ON TAPE 4                           INTEG177
C                                                                       INTEG178
      WRITE(4)(C(I),I=1,NP)                                             INTEG179
      END FILE 4                                                        INTEG180
      REWIND 4                                                          INTEG181
      RETURN                                                            INTEG182
      END                                                               INTEG183
C
C FYSKTT*DWUCK4-1(1).TAPED(0)
C
      SUBROUTINE TAPED                                                  TAPED000
C     THE NEXT 1 CARDS CONVERT DWUCK TO AN IBM 360                      TAPED001
      IMPLICIT REAL*8(A-H,O-Z)                                          TAPED002
      COMMON ALPHA(15),IDAT(6),ICON(16),ANGLE(5),HBARC,AMU,AMASS,CHSQ,AATAPED003
     1,DRF,Z(3),ZA(3),FM(3),FMA(3),RC(3),AC(3),PNLOC(3),FS(3),ECM(3)    TAPED004
     2,FK(3),FK2(3),ETA(3),DR(3),FMU(3),FN,FL,FJ2,FSS,VCE,FNRNG,RSIG(2) TAPED005
     3,K,KZ,LPLUS,LPL2,IS(3),NS(3),NLTR,LTRT(8),JTRT(8),ISTRT(8),IBF(8) TAPED006
     4,IBUFF,IWORD,ILINE                                                TAPED007
     5,U(800,2),V(800,2),SPACE(3200),UB(800),BUFFR(1024)                TAPED008
      DIMENSION C(612),FR(612)                                          TAPED009
      DIMENSION R(2),CTEMP(2)                                           TAPED010
      EQUIVALENCE (C,U(1,1)),(FR,U(1,2))                                TAPED011
      IWORD=IBUFF                                                       TAPED012
      IK=ICON(12)                                                       TAPED013
      FLIK=IK                                                           TAPED014
      JT=NS(1)+NS(2)                                                    TAPED015
      NP=LPL2*JT                                                        TAPED016
      R(1)=0.0                                                          TAPED017
      R(2)=0.0                                                          TAPED018
      IKTEMP=0                                                          TAPED019
      DO 50 M=1,K                                                       TAPED020
      IKTEMP=IKTEMP+1                                                   TAPED021
C                                                                       TAPED022
C     READ IN DISTORTED WAVE RADIAL FUNCTIONS                           TAPED023
C                                                                       TAPED024
      IF(IWORD+NP.LT.IBUFF) GO TO 6                                     TAPED025
      READ (4)(BUFFR(J),J=1,IBUFF)                                      TAPED026
      IWORD=0                                                           TAPED027
    6 CONTINUE                                                          TAPED028
      DO 8 N=1,NP                                                       TAPED029
      IWORD=IWORD+1                                                     TAPED030
      FR(N)=BUFFR(IWORD)                                                TAPED031
    8 CONTINUE                                                          TAPED032
      IF(IKTEMP.NE.IK) GO TO 50                                         TAPED033
      IKTEMP=0                                                          TAPED034
      IX=0                                                              TAPED035
      DO 40 N=1,2                                                       TAPED036
      R(N)=R(N)+DR(N)*FLIK                                              TAPED037
      JX=NS(N)                                                          TAPED038
      DO 39 J=1,JX                                                      TAPED039
      DO 30 LL=1,LPLUS                                                  TAPED040
      LK=LL+LL-1                                                        TAPED041
      IX1=LK+IX                                                         TAPED042
      IX2=IX1+1                                                         TAPED043
C                                                                       TAPED044
C     NORMALIZE RADIAL FUNCTIONS                                        TAPED045
C                                                                       TAPED046
      CTEMP(1)=FR(IX1)*C(IX1)-FR(IX2)*C(IX2)                            TAPED047
      CTEMP(2)=FR(IX1)*C(IX2)+FR(IX2)*C(IX1)                            TAPED048
      FR(IX1)=CTEMP(1)                                                  TAPED049
      FR(IX2)=CTEMP(2)                                                  TAPED050
   30 CONTINUE                                                          TAPED051
      IX=IX+LPL2                                                        TAPED052
   39 CONTINUE                                                          TAPED053
   40 CONTINUE                                                          TAPED054
      WRITE(6,9001)R(1),R(2)                                            TAPED055
      WRITE(6,9601)                                                     TAPED056
      DO 45 LL=1,LPLUS                                                  TAPED057
      LM=LL-1                                                           TAPED058
      LK1=LM+LL                                                         TAPED059
      LK2=LPL2*(NS(1)-1)+LK1                                            TAPED060
      WRITE(6,9602)LM, (FR(LK),FR(LK+1) ,LK=LK1,LK2,LPL2)               TAPED061
      LK1=LK2+LPL2                                                      TAPED062
      LK2=LPL2*(NS(2)-1)+LK1                                            TAPED063
      WRITE(6,9603)LM, (FR(LK),FR(LK+1) ,LK=LK1,LK2,LPL2)               TAPED064
   45 CONTINUE                                                          TAPED065
   50 CONTINUE                                                          TAPED066
      REWIND 4                                                          TAPED067
      RETURN                                                            TAPED068
 9001 FORMAT(1H0,3HR1=,F8.4,57X,3HR2=,F8.4)                             TAPED069
 9601 FORMAT(4H   L,20H  REAL D1   IMAG D1 ,20H  REAL D2   IMAG D2 ,20H TAPED070
     1 REAL D3   IMAG D3 ,4X,4H   L,20H  REAL D1   IMAG D1 ,20H  REAL D2TAPED071
     2   IMAG D2 ,20H  REAL D3   IMAG D3 )                              TAPED072
 9602 FORMAT(1H ,    I3,6F10.7)                                         TAPED073
 9603 FORMAT(1H+,68X,I3,6F10.7)                                         TAPED074
      END                                                               TAPED075
C
C FYSKTT*DWUCK4-1(1).ELSIG(3)
C
      SUBROUTINE ELSIG                                                  ELSIG000
C     THE NEXT 5 CARDS CONVERT DWUCK TO AN IBM 360                      ELSIG001
      IMPLICIT REAL*8(A-H,O-Z)                                          ELSIG002
C     SQRT(XXX)=DSQRT(XXX)                                              ELSIG003
C     SIN(XXX)=DSIN(XXX)                                                ELSIG004
C     COS(XXX)=DCOS(XXX)                                                ELSIG005
C     ALOG(XXX)=DLOG(XXX)                                               ELSIG006
      COMMON ALPHA(15),IDAT(6),ICON(16),ANGLE(5),HBARC,AMU,AMASS,CHSQ,AAELSIG007
     1,DRF,Z(3),ZA(3),FM(3),FMA(3),RC(3),AC(3),PNLOC(3),FS(3),ECM(3)    ELSIG008
     2,FK(3),FK2(3),ETA(3),DR(3),FMU(3),FN,FL,FJ2,FSS,VCE,FNRNG,RSIG(2) ELSIG009
     3,K,KZ,LPLUS,LPL2,IS(3),NS(3),NLTR,LTRT(8),JTRT(8),ISTRT(8),IBF(8) ELSIG010
     4,IBUFF,IWORD,ILINE                                                ELSIG011
     5,U(800,2),V(800,2),SPACE(3200),UB(800),BUFFR(1024)                ELSIG012
      DIMENSION SUM(5,5,2),SIG(2),RATIO(2),PLM(450),SUMX(50)            ELSIG013
     1,POL(9),TEMP(2),INCR(2),DTEMP(7060),D(612),SIGPLT(200,2)          ELSIG014
      EQUIVALENCE (U,DTEMP),(PLM,DTEMP(5951)),(SUM,DTEMP(3101))         ELSIG015
     1 ,(SUMX,DTEMP(3101)),(DTEMP(3201),D),(DTEMP(3801),SIGPLT)         ELSIG016
      EQUIVALENCE (ANGLE(1),THETAN),(ANGLE(2),THETA1),(ANGLE(3),DTHETA) ELSIG017
      DATA NX/200/                                                      ELSIG018
      NTHETA=THETAN                                                     ELSIG019
      IF(NTHETA.EQ.0) GO TO 101                                         ELSIG020
C                                                                       ELSIG021
C     TABLE SCATTERING AMPLITUDES WITH ANG-MOM COEFFICENTS              ELSIG022
C                                                                       ELSIG023
      ICNT=LPL2*(NS(1)**2+NS(2)**2)                                     ELSIG024
      DO 3 IP=1,ICNT                                                    ELSIG025
      DTEMP(IP)=0.0                                                     ELSIG026
    3 CONTINUE                                                          ELSIG027
      JR=1                                                              ELSIG028
      JS=0                                                              ELSIG029
      ICNT=0                                                            ELSIG030
      IC1=0                                                             ELSIG031
      DO 26 N=1,2                                                       ELSIG032
      ISS=NS(N)                                                         ELSIG033
      JS=JS+ISS                                                         ELSIG034
      INCR(N)=LPLUS*ISS*(ISS+1)                                         ELSIG035
      FL=1.0                                                            ELSIG036
      IS2=IS(N)                                                         ELSIG037
      DO 25 LL=1,LPLUS                                                  ELSIG038
      L=LL-1                                                            ELSIG039
      LK=LL+LL-1                                                        ELSIG040
      L2=LK-1                                                           ELSIG041
      J2=L2-IS2                                                         ELSIG042
      IQ=LK+IC1                                                         ELSIG043
      DO 20 JJ=JR,JS                                                    ELSIG044
      IP=LK+ICNT                                                        ELSIG045
      MS2=-IS2                                                          ELSIG046
      DO 15 I=1,ISS                                                     ELSIG047
      VCI=VCC(L2,IS2,J2,0,MS2)*FL                                       ELSIG048
      MT2=MS2                                                           ELSIG049
      DO 14 J=I,ISS                                                     ELSIG050
      ML2=MS2-MT2                                                       ELSIG051
      ML=IABS(ML2/2)                                                    ELSIG052
      IF(ML.GT.L) GO TO 13                                              ELSIG053
      VTEMP=VCI*VCC(L2,IS2,J2,ML2,MT2)*SQRT(YXFCT(L+ML,L-ML))           ELSIG054
      DTEMP(IP  )=DTEMP(IP  )+D(IQ  )*VTEMP                             ELSIG055
      DTEMP(IP+1)=DTEMP(IP+1)+D(IQ+1)*VTEMP                             ELSIG056
   13 CONTINUE                                                          ELSIG057
      IP=IP+LPL2                                                        ELSIG058
      MT2=MT2+2                                                         ELSIG059
   14 CONTINUE                                                          ELSIG060
      MS2=MS2+2                                                         ELSIG061
   15 CONTINUE                                                          ELSIG062
      J2=J2+2                                                           ELSIG063
      IQ=IQ+LPL2                                                        ELSIG064
   20 CONTINUE                                                          ELSIG065
      FL=FL+2.0                                                         ELSIG066
   25 CONTINUE                                                          ELSIG067
      ICNT=ICNT+INCR(N)                                                 ELSIG068
      IC1=IC1+LPL2*ISS                                                  ELSIG069
      JR=JS+1                                                           ELSIG070
   26 CONTINUE                                                          ELSIG071
C                                                                       ELSIG072
C     CALCULATE ELASTIC CROSS SECTION                                   ELSIG073
C                                                                       ELSIG074
      IMAX=MAX0(NS(1),NS(2))                                            ELSIG075
      THETA=THETA1                                                      ELSIG076
      WRITE(6,9000)                                                     ELSIG077
      DO 100 NTH=1,NTHETA                                               ELSIG078
      CALL LGNDR(PLM,IMAX,LPLUS,THETA)                                  ELSIG079
      ICNT=0                                                            ELSIG080
      DO 80 N=1,2                                                       ELSIG081
      ISS=NS(N)                                                         ELSIG082
      DO 30 I=1,50                                                      ELSIG083
      SUMX(I)=0.0                                                       ELSIG084
   30 CONTINUE                                                          ELSIG085
      DO 40 LL=1,LPLUS                                                  ELSIG086
      LK=LL+LL-1                                                        ELSIG087
      IP=LK+ICNT                                                        ELSIG088
      DO 35 I=1,ISS                                                     ELSIG089
      DO 34 J=I,ISS                                                     ELSIG090
      ML=(J-I)*LPLUS+LL                                                 ELSIG091
      VTEMP=PLM(ML)                                                     ELSIG092
      SUM(I,J,1)=SUM(I,J,1)+DTEMP(IP  )*VTEMP                           ELSIG093
      SUM(I,J,2)=SUM(I,J,2)+DTEMP(IP+1)*VTEMP                           ELSIG094
      IP=IP+LPL2                                                        ELSIG095
   34 CONTINUE                                                          ELSIG096
   35 CONTINUE                                                          ELSIG097
   40 CONTINUE                                                          ELSIG098
      SIG(N)=0.0                                                        ELSIG099
      POL(N)=0.0                                                        ELSIG100
      IF(ETA(N).EQ.0.0) GO TO 45                                        ELSIG101
      IF(THETA.EQ.0.0) GO TO 63                                         ELSIG102
C                                                                       ELSIG103
C     CALCULATE COULOMB AMPLITUDE                                       ELSIG104
C                                                                       ELSIG105
      ARG=THETA/114.591559                                              ELSIG106
      S=SIN(ARG)**2                                                     ELSIG107
      TL=ALOG(S)                                                        ELSIG108
      ARG=ETA(N)*TL                                                     ELSIG109
      FACT=ETA(N)/(2.0*FK(N)*S)                                         ELSIG110
      CL=COS(ARG)*FACT                                                  ELSIG111
      SL=SIN(ARG)*FACT                                                  ELSIG112
      GO TO 46                                                          ELSIG113
   45 CONTINUE                                                          ELSIG114
      CL=0.0                                                            ELSIG115
      SL=0.0                                                            ELSIG116
      FACT=1.0                                                          ELSIG117
   46 CONTINUE                                                          ELSIG118
      DO 60 I=1,ISS                                                     ELSIG119
      DO 59 J=1,ISS                                                     ELSIG120
      ML=I-J                                                            ELSIG121
      IF(ML)56,55,54                                                    ELSIG122
   54 CONTINUE                                                          ELSIG123
      PHAS=PHASEF(ML)                                                   ELSIG124
      SUM(I,J,1)=SUM(J,I,1)*PHAS                                        ELSIG125
      SUM(I,J,2)=SUM(J,I,2)*PHAS                                        ELSIG126
      GO TO 56                                                          ELSIG127
   55 CONTINUE                                                          ELSIG128
      SUM(I,J,1)=SUM(I,J,1)-CL                                          ELSIG129
      SUM(I,J,2)=SUM(I,J,2)+SL                                          ELSIG130
   56 CONTINUE                                                          ELSIG131
      SIG(N)=SIG(N)+SUM(I,J,1)**2+SUM(I,J,2)**2                         ELSIG132
   59 CONTINUE                                                          ELSIG133
   60 CONTINUE                                                          ELSIG134
      CALL POLFCT(POL(N),SUM(1,1,1),SUM(1,1,2),ISS,ISS)                 ELSIG135
      POL(N)=POL(N)/SIG(N)                                              ELSIG136
      SIG(N)=SIG(N)/(2.0*FS(N)+1.0)                                     ELSIG137
      GO TO 64                                                          ELSIG138
   63 CONTINUE                                                          ELSIG139
      RATIO(N)=1.0                                                      ELSIG140
      GO TO 70                                                          ELSIG141
   64 CONTINUE                                                          ELSIG142
      RATIO(N)=SIG(N)/FACT**2                                           ELSIG143
   70 CONTINUE                                                          ELSIG144
      ICNT=ICNT+INCR(N)                                                 ELSIG145
      IF(NTH.LE.NX) SIGPLT(NTH,N)=RATIO(N)                              ELSIG146
   80 CONTINUE                                                          ELSIG147
      WRITE(6,9001) (THETA,SIG(N),RATIO(N),POL(N) ,N=1,2)               ELSIG148
   90 CONTINUE                                                          ELSIG149
      THETA=THETA+DTHETA                                                ELSIG150
  100 CONTINUE                                                          ELSIG151
      WRITE(6,9002)(RSIG(N),N=1,2)                                      ELSIG152
      NTH=MIN0(NTHETA,NX)                                               ELSIG153
      IF(ICON(14).EQ.0) GO TO 101                                       ELSIG154
      WRITE(8,9010)(SIGPLT(N,1),N=1,NTH)                                ELSIG156
C     WRITE(8,9010)(SIGPLT(N,2),N=1,NTH)                                ELSIG158
  101 CONTINUE                                                          ELSIG159
      IF(ICON(16).EQ.0) GO TO 120                                       ELSIG160
      WRITE(6,9999)ALPHA,(IDAT(I),I=1,3)                                ELSIG161
      CALL DWPLOT(NTH,ICON(16),SIGPLT(1,1),DTHETA,THETA1)               ELSIG162
      WRITE(6,9999)ALPHA,(IDAT(I),I=1,3)                                ELSIG163
      CALL DWPLOT(NTH,ICON(16),SIGPLT(1,2),DTHETA,THETA1)               ELSIG164
  120 CONTINUE                                                          ELSIG165
      RETURN                                                            ELSIG166
 9000 FORMAT(1H0,7H  THETA,14H   EL-SIG,F**2,14H  SIGMA/COUL  ,14H     PELSIG167
     1OL      ,5H     ,8H   THETA,14H   EL-SIG,F**2,14H  SIGMA/COUL  ,14ELSIG168
     2H     POL      )                                                  ELSIG169
 9001 FORMAT(2(F8.2,3E14.5,5X))                                         ELSIG170
 9002 FORMAT(1H0,7HREACSIG,E14.5,41X,E14.5)                             ELSIG171
 9010 FORMAT(8E10.4)
 9011 FORMAT(10H  ELASTIC ,15A4)                                        ELSIG173
 9999 FORMAT(1H1,15A4,I2,2(1H/,I2),I4,2(1H.,I2))                        ELSIG174
      END                                                               ELSIG175
C
C FYSKTT*DWUCK4-1(1).RADINT(0)
C
      SUBROUTINE RADINT(F,FLL,LTR)                                      RADIN000
C     THE NEXT 2 CARDS CONVERT DWUCK TO AN IBM 360                      RADIN001
      IMPLICIT REAL*8(A-H,O-Z)                                          RADIN002
C     FLOAT(III)=DFLOAT(III)                                            RADIN003
      COMMON ALPHA(15),IDAT(6),ICON(16),ANGLE(5),HBARC,AMU,AMASS,CHSQ,AARADIN004
     1,DRF,Z(3),ZA(3),FM(3),FMA(3),RC(3),AC(3),PNLOC(3),FS(3),ECM(3)    RADIN005
     2,FK(3),FK2(3),ETA(3),DR(3),FMU(3),FN,FL,FJ2,FSS,VCE,FNRNG,RSIG(2) RADIN006
     3,K,KZ,LPLUS,LPL2,IS(3),NS(3),NLTR,LTRT(8),JTRT(8),ISTRT(8),IBF(8) RADIN007
     4,IBUFF,IWORD,ILINE                                                RADIN008
     5,U(800,2),V(800,2),SPACE(3200),UB(800),BUFFR(1024)                RADIN009
      DIMENSION         F(612),FLL(1),C(612),CTEMP(2),VTEMP(2),DRX(2)   RADIN010
      EQUIVALENCE (C,UB)                                                RADIN011
      IWORD=IBUFF                                                       RADIN012
      IF(RC(3).EQ.0.0) RC(3)=DR(3)                                      RADIN013
      VFACT=3.0*VCE*CHSQ*Z(1)*ZA(1)*RC(3)**LTR/FLOAT(LTR+LTR+1)         RADIN014
      NMTR=LTR+1                                                        RADIN015
      JR=NS(1)                                                          RADIN016
      JS=NS(1)+1                                                        RADIN017
      JT=NS(1)+NS(2)                                                    RADIN018
      DRX(1)=2.0*DR(3)/3.0                                              RADIN019
      DRX(2)=2.0*DRX(1)                                                 RADIN020
      NP=LPL2*JT                                                        RADIN021
      IZZ=NS(1)*LPL2                                                    RADIN022
      INCR=LPL2*NMTR                                                    RADIN023
      INC=INCR*NS(1)*NS(2)                                              RADIN024
      DO 3 II=1,INC                                                     RADIN025
      FLL(II)=0.0                                                       RADIN026
    3 CONTINUE                                                          RADIN027
      MX=1                                                              RADIN028
      R=0.0                                                             RADIN029
      DO 100 M=1,K                                                      RADIN030
      R=R+DRF                                                           RADIN031
C                                                                       RADIN032
C     READ IN DISTORTED WAVE RADIAL FUNCTIONS                           RADIN033
C                                                                       RADIN034
      IF(IWORD+NP.LT.IBUFF) GO TO 6                                     RADIN035
      READ (4)(BUFFR(J),J=1,IBUFF)                                      RADIN036
      IWORD=0                                                           RADIN037
    6 CONTINUE                                                          RADIN038
      DO 8 N=1,NP                                                       RADIN039
      IWORD=IWORD+1                                                     RADIN040
      F (N)=BUFFR(IWORD)                                                RADIN041
    8 CONTINUE                                                          RADIN042
      MK=M+M-1                                                          RADIN043
      MX=3-MX                                                           RADIN044
      VTEMP(1)=UB(MK  )*DRX(MX)                                         RADIN045
      VTEMP(2)=UB(MK+1)*DRX(MX)                                         RADIN046
      IF(VFACT.EQ.0.0) GO TO 41                                         RADIN047
C                                                                       RADIN048
C     COULOMB EXCITATATION ADDITION TO FORM FACTOR                      RADIN049
C                                                                       RADIN050
      IF(R.LT.RC(3)) GO TO 41                                           RADIN051
      VTEMP(1)=VTEMP(1)+DRX(MX)*VFACT/R**NMTR                           RADIN052
   41 CONTINUE                                                          RADIN053
C                                                                       RADIN054
C**** READ IN NORMALIZATION CONSTANTS                                   RADIN055
C                                                                       RADIN056
      IF(M.EQ.K) READ(4)(C(I),I=1,NP)                                   RADIN057
      INC=0                                                             RADIN058
      IY=0                                                              RADIN059
      DO 96 I= 1,JR                                                     RADIN060
      IZ=IZZ                                                            RADIN061
      DO 95 J=JS,JT                                                     RADIN062
      DO 90 LL=1,LPLUS                                                  RADIN063
      LK=LL+LL-1                                                        RADIN064
      IZ1=LK+IZ                                                         RADIN065
      LP1=IABS(LL-LTR-1)+1                                              RADIN066
      LP2=MIN0(LL+LTR,LPLUS)                                            RADIN067
      CTEMP(1)=VTEMP(1)*F(IZ1  )-VTEMP(2)*F(IZ1+1)                      RADIN068
      CTEMP(2)=VTEMP(1)*F(IZ1+1)+VTEMP(2)*F(IZ1  )                      RADIN069
      DO 80 LP=LP1,LP2,2                                                RADIN070
      IY1=LP+LP-1+IY                                                    RADIN071
      IND=LK+INC                                                        RADIN072
      IF(M.LT.KZ) GO TO 79                                              RADIN073
      FLL(IND  )=FLL(IND  )+CTEMP(1)*F(IY1  )-CTEMP(2)*F(IY1+1)         RADIN074
      FLL(IND+1)=FLL(IND+1)+CTEMP(1)*F(IY1+1)+CTEMP(2)*F(IY1  )         RADIN075
      IF(M.NE.K) GO TO 79                                               RADIN076
C                                                                       RADIN077
C     NORMALIZE RADIAL INTEGRALS                                        RADIN078
C                                                                       RADIN079
      CTEMP1=C(IZ1  )*FLL(IND  )-C(IZ1+1)*FLL(IND+1)                    RADIN080
      CTEMP2=C(IZ1  )*FLL(IND+1)+C(IZ1+1)*FLL(IND  )                    RADIN081
      FLL(IND  )=CTEMP1*C(IY1  )-CTEMP2*C(IY1+1)                        RADIN082
      FLL(IND+1)=CTEMP1*C(IY1+1)+CTEMP2*C(IY1  )                        RADIN083
   79 LK=LK+LPL2                                                        RADIN084
   80 CONTINUE                                                          RADIN085
   90 CONTINUE                                                          RADIN086
      INC=INC+INCR                                                      RADIN087
      IZ=IZ+LPL2                                                        RADIN088
   95 CONTINUE                                                          RADIN089
      IY=IY+LPL2                                                        RADIN090
   96 CONTINUE                                                          RADIN091
  100 CONTINUE                                                          RADIN092
      REWIND 4                                                          RADIN093
      JR=IBF(7)+1  
      JS=IBF(8)+1  
      IF(NLTR.NE.1) GO TO 105                                           RADIN094
      IF(JR+JS.EQ.2) GO TO 200 
  105 CONTINUE                                                          RADIN096
C                                                                       RADIN097
C     WRITE RADIAL MATRIX ELEMENTS ON TAPE 2                            RADIN098
C                                                                       RADIN099
      JSX=JS                                                            RADIN102
      IF(IBF(6).EQ.0) JSX=1                                             RADIN103
      DO 120 I=1,JR                                                     RADIN104
      IY=I-1                                                            RADIN105
      IF(IBF(5).EQ.0) IY=0                                              RADIN106
      DO 110 J=1,JS                                                     RADIN107
      IZ=J-1                                                            RADIN108
      IF(IBF(6).EQ.0) IZ=0                                              RADIN109
      INC=INCR*(JSX*IY+IZ)+1                                            RADIN110
      INDEX=INC-1+INCR                                                  RADIN111
      WRITE(2)(FLL(II),II=INC,INDEX)                                    RADIN112
  110 CONTINUE                                                          RADIN113
  120 CONTINUE                                                          RADIN114
  200 CONTINUE                                                          RADIN115
      RETURN                                                            RADIN116
      END                                                               RADIN117
C
C FYSKTT*DWUCK4-1(1).BETAFN(0)
C
      SUBROUTINE BETAFN(D,E,LTR,JX)                                     BETAF000
C     THE NEXT 3 CARDS CONVERT DWUCK TO AN IBM 360                      BETAF001
      IMPLICIT REAL*8(A-H,O-Z)                                          BETAF002
C     SQRT(XXX)=DSQRT(XXX)                                              BETAF003
C     FLOAT(III)=DFLOAT(III)                                            BETAF004
      COMMON ALPHA(15),IDAT(6),ICON(16),ANGLE(5),HBARC,AMU,AMASS,CHSQ,AABETAF005
     1,DRF,Z(3),ZA(3),FM(3),FMA(3),RC(3),AC(3),PNLOC(3),FS(3),ECM(3)    BETAF006
     2,FK(3),FK2(3),ETA(3),DR(3),FMU(3),FN,FL,FJ2,FSS,VCE,FNRNG,RSIG(2) BETAF007
     3,K,KZ,LPLUS,LPL2,IS(3),NS(3),NLTR,LTRT(8),JTRT(8),ISTRT(8),IBF(8) BETAF008
      DIMENSION D(918),E(5680),CTEMP(2)                                 BETAF009
      ISB=IS(3)                                                         BETAF010
      JR=NS(1)                                                          BETAF011
      JS=NS(2)                                                          BETAF012
      MPLUS=JX/2+1                                                      BETAF013
      INCR=LPL2*(LTR+1)                                                 BETAF014
      IFACT=2*MPLUS*JR*JS                                               BETAF015
      J2K=(1.0+PHASEF(NS(2)))/2.0                                       BETAF016
      M2K=JX-MPLUS-MPLUS+2                                              BETAF017
      LX=LTR+LTR                                                        BETAF018
      TEMP1=SQRT(FLOAT((JX+1)*(IS(1)+1)))                               BETAF019
      IF(FN.NE.0.0) GO TO 11                                            BETAF020
      IND=LPLUS*IFACT                                                   BETAF021
      DO 10 M=1,IND                                                     BETAF022
      E(M)=0.0                                                          BETAF023
   10 CONTINUE                                                          BETAF024
   11 CONTINUE                                                          BETAF025
      IS1=-IS(1)                                                        BETAF026
      DO 95 I=1,JR                                                      BETAF027
      IS2=-IS(2)                                                        BETAF028
      DO 90 J=1,JS                                                      BETAF029
      IF(NLTR.NE.1) GO TO 14                                            BETAF030
      IF(JR*JS.EQ.1) GO TO 15                                           BETAF031
      IF(IBF(5)+IBF(6).EQ.0) GO TO 15                                   BETAF032
   14 CONTINUE                                                          BETAF033
C                                                                       BETAF034
C     READ RADIAL MATRIX ELEMENTS FROM TAPE 2                           BETAF035
C                                                                       BETAF036
      READ(2)(D(INDEX),INDEX=1,INCR)                                    BETAF037
   15 FLX=1.0                                                           BETAF038
      DO 80 LL=1,LPLUS                                                  BETAF039
      L=LL-1                                                            BETAF040
      LLX=L+L                                                           BETAF041
      JLX=LLX+IS2                                                       BETAF042
      IF(JLX.LT.0) GO TO 75                                             BETAF043
      TEMP2=TEMP1*SQRT(FLOAT(JLX+1))                                    BETAF044
      LSTOR=L*IFACT                                                     BETAF045
      LP1=IABS(LL-LTR-1)+1                                              BETAF046
      LP2=MIN0(LL+LTR,LPLUS)                                            BETAF047
      LK=0                                                              BETAF048
      DO 60 LP=LP1,LP2,2                                                BETAF049
      LPX=LP+LP-2                                                       BETAF050
      JPX=LPX+IS1                                                       BETAF051
      IF(JPX.LT.0) GO TO 59                                             BETAF052
      TEMP=VCC(LLX,LX,LPX,0,0)*PHASEF((LP-LL-LTR)/2)*FLX*FL             BETAF053
     1         *TEMP2*SQRT(FLOAT(LPX+1))                                BETAF054
     2*WINEJ(LLX,IS(2),JLX,LX,ISB,JX,LPX,IS(1),JPX)                     BETAF055
      INDEX=LK+LLX+1                                                    BETAF056
      KT=0                                                              BETAF057
      MS =-IS(2)                                                        BETAF058
      DO 57 MS2=1,JS                                                    BETAF059
      MSP=-IS(1)                                                        BETAF060
      DO 55 MS1=1,JR                                                    BETAF061
      VCP=VCC(LPX,IS(1),JPX,0,MSP)                                      BETAF062
      DO 50 M=1,MPLUS                                                   BETAF063
      MK=M+M-1                                                          BETAF064
      MX=MK-1+M2K                                                       BETAF065
      ML2=MSP-MX-MS                                                     BETAF066
      ML=IABS(ML2/2)                                                    BETAF067
      IF(ML.GT.L) GO TO 50                                              BETAF068
      IND=LSTOR+KT+MK                                                   BETAF069
      FACT=VCP*VCC(JLX,JX,JPX,MSP-MX,MX)*VCC(LLX,IS(2),JLX,ML2,MS)      BETAF070
     1 *SQRT(YXFCT(L+ML,L-ML))*TEMP                                     BETAF071
      E(IND  )=E(IND  )+D(INDEX  )*FACT                                 BETAF072
      E(IND+1)=E(IND+1)+D(INDEX+1)*FACT                                 BETAF073
   50 CONTINUE                                                          BETAF074
      KT=KT+MPLUS+MPLUS                                                 BETAF075
      MSP=MSP+2                                                         BETAF076
   55 CONTINUE                                                          BETAF077
      MS =MS +2                                                         BETAF078
   57 CONTINUE                                                          BETAF079
   59 LK=LK+LPL2                                                        BETAF080
   60 CONTINUE                                                          BETAF081
   75 CONTINUE                                                          BETAF082
      FLX=FLX+2.0                                                       BETAF083
   80 CONTINUE                                                          BETAF084
      IS2=IS2+2                                                         BETAF085
   90 CONTINUE                                                          BETAF086
      IS1=IS1+2                                                         BETAF087
   95 CONTINUE                                                          BETAF088
      RETURN                                                            BETAF089
      END                                                               BETAF090
C
C FYSKTT*DWUCK4-1(1).INSIG(1)
C
      SUBROUTINE INSIG(D,PLM,JTR,FACTR)                                 INSIG000
C     THE NEXT 1 CARDS CONVERT DWUCK TO AN IBM 360                      INSIG001
      IMPLICIT REAL*8(A-H,O-Z)                                          INSIG002
      COMMON ALPHA(15),IDAT(6),ICON(16),ANGLE(5),HBARC,AMU,AMASS,CHSQ,AAINSIG003
     1,DRF,Z(3),ZA(3),FM(3),FMA(3),RC(3),AC(3),PNLOC(3),FS(3),ECM(3)    INSIG004
     2,FK(3),FK2(3),ETA(3),DR(3),FMU(3),FN,FL,FJ2,FSS,VCE,FNRNG,RSIG(2) INSIG005
     3,K,KZ,LPLUS,LPL2,IS(3),NS(3),NLTR,LTRT(8),JTRT(8),ISTRT(8),IBF(8) INSIG006
     4,IBUFF,IWORD,ILINE                                                INSIG007
     5,DTEMP(8000)                                                      INSIG008
      DIMENSION D(5680),SUM(5,5,2),PLM(1230),POLZ(8),POL(8)             INSIG009
      DIMENSION SIGPLT(181)                                             INSIG010
      EQUIVALENCE (DTEMP,SUM),(DTEMP(51),SIGPLT)                        INSIG011
      EQUIVALENCE (ANGLE(1),THETAN),(ANGLE(2),THETA1),(ANGLE(3),DTHETA) INSIG012
     1,(ANGLE(4),AANG),(ANGLE(5),BANG)                                  INSIG013
      DATA NX/181/                                                      INSIG014
      NTHETA=THETAN                                                     INSIG015
      JR=NS(1)                                                          INSIG016
      JS=NS(2)                                                          INSIG017
      FACTA=FACTR/(2.0*FS(1)+1.0)                                       INSIG018
      FACTF=(FK(1)/FK(2))**2                                            INSIG019
      M2K=(1.0-PHASEF(IS(3)))/2.0                                       INSIG020
      NPLUS=(JTR+IS(1)+IS(2))/2+1                                       INSIG021
      MPLUS=JTR/2+1                                                     INSIG022
      IFACT=2*MPLUS*JR*JS                                               INSIG023
      WRITE(6,9000)                                                     INSIG024
      IF(NTHETA.EQ.0) GO TO 111                                         INSIG025
      THETA=THETA1                                                      INSIG026
      DO 110 NTH=1,NTHETA                                               INSIG027
      CALL LGNDR(PLM,NPLUS,LPLUS,THETA)                                 INSIG028
      SIG=0.0                                                           INSIG029
      DO 10 I=1,8                                                       INSIG030
      POLZ(I)=0.0                                                       INSIG031
   10 CONTINUE                                                          INSIG032
      DO 100 M=1,MPLUS                                                  INSIG033
      MK=M+M-1                                                          INSIG034
      KT=MK                                                             INSIG035
      IS2=-IS(2)                                                        INSIG036
      DO 70 J=1,JS                                                      INSIG037
      IS1=-IS(1)                                                        INSIG038
      DO 60 I=1,JR                                                      INSIG039
      ML=(MK-1+M2K+IS2-IS1)/2                                           INSIG040
      PHAS=1.0                                                          INSIG041
      IF(ML.GT.0) PHAS=PHASEF(ML)                                       INSIG042
      ML=IABS(ML)*LPLUS                                                 INSIG043
      SUM1=0.0                                                          INSIG044
      SUM2=0.0                                                          INSIG045
      IND=KT                                                            INSIG046
      DO 40 LL=1,LPLUS                                                  INSIG047
      ML=ML+1                                                           INSIG048
      SUM1=SUM1+D(IND  )*PLM(ML)                                        INSIG049
      SUM2=SUM2+D(IND+1)*PLM(ML)                                        INSIG050
      IND=IND+IFACT                                                     INSIG051
   40 CONTINUE                                                          INSIG052
      SUM(J,I,1)=SUM1*PHAS                                              INSIG053
      SUM(J,I,2)=SUM2*PHAS                                              INSIG054
      FACT=SUM(J,I,1)**2+SUM(J,I,2)**2                                  INSIG055
      IF(M+M2K.NE.1) FACT=FACT*2.0                                      INSIG056
      SIG=SIG+FACT                                                      INSIG057
      KT=KT+MPLUS+MPLUS                                                 INSIG058
      IS1=IS1+2                                                         INSIG059
   60 CONTINUE                                                          INSIG060
      IS2=IS2+2                                                         INSIG061
   70 CONTINUE                                                          INSIG062
      CALL POLFCT(POL,SUM(1,1,1),SUM(1,1,2),JS,JR)                      INSIG063
      DO 99 I=1,8                                                       INSIG064
      IF(M+M2K.NE.1) POL(I)=POL(I)*2.0                                  INSIG065
      POLZ(I)=POLZ(I)+POL(I)                                            INSIG066
   99 CONTINUE                                                          INSIG067
  100 CONTINUE                                                          INSIG068
      IF(SIG.EQ.0.0) GO TO 106                                          INSIG069
      DO 105 I=1,8                                                      INSIG070
      POLZ(I)=POLZ(I)/SIG                                               INSIG071
  105 CONTINUE                                                          INSIG072
  106 CONTINUE                                                          INSIG073
      SIG1=SIG*FACTA                                                    INSIG074
      SIG2=SIG1*FACTF                                                   INSIG075
      WRITE(6,9001)THETA,SIG1,(POLZ(I),I=1,4),SIG2,(POLZ(I),I=5,8)      INSIG076
      IF(NTH.LE.NX) SIGPLT(NTH)=SIG1                                    INSIG077
      THETA=THETA+DTHETA                                                INSIG078
  110 CONTINUE                                                          INSIG079
  111 CONTINUE                                                          INSIG080
C                                                                       INSIG081
C     CALCULATE TOTAL INELASTIC SIGMA                                   INSIG082
C                                                                       INSIG083
      SIG =0.0                                                          INSIG084
      KT=0                                                              INSIG085
      IS2=-IS(2)                                                        INSIG086
      DO 170 J=1,JS                                                     INSIG087
      IS1=-IS(1)                                                        INSIG088
      DO 160 I=1,JR                                                     INSIG089
      DO 150 M=1,MPLUS                                                  INSIG090
      MK=M+M-1                                                          INSIG091
      IND=KT+MK                                                         INSIG092
      MK=MK-1+M2K                                                       INSIG093
      ML=IABS(MK+IS2-IS1)/2                                             INSIG094
      DO 140 L=1,LPLUS                                                  INSIG095
      LL=L-1                                                            INSIG096
      IF(ML.GT.LL) GO TO 139                                            INSIG097
      FACT=D(IND  )**2+D(IND+1)**2                                      INSIG098
      FACT=FACT*YXFCT(LL-ML,LL+ML)/FLOAT(LL+LL+1)                       INSIG099
      IF(MK.NE.0) FACT=FACT*2.0                                         INSIG100
      SIG=SIG+FACT                                                      INSIG101
  139 IND=IND+IFACT                                                     INSIG102
  140 CONTINUE                                                          INSIG103
  150 CONTINUE                                                          INSIG104
      IS1=IS1+2                                                         INSIG105
      KT=KT+MPLUS+MPLUS                                                 INSIG106
  160 CONTINUE                                                          INSIG107
      IS2=IS2+2                                                         INSIG108
  170 CONTINUE                                                          INSIG109
      SIG1 =SIG *12.5663706*FACTA                                       INSIG110
      SIG2 =SIG1 *FACTF                                                 INSIG111
      WRITE(6,9002)SIG1,SIG2                                            INSIG112
      IF(NTHETA.EQ.0) GO TO 180                                         INSIG113
      IF(BANG.EQ.0.0) GO TO 176                                         INSIG114
C                                                                       INSIG115
C     CALCULATE SUMMED SIGMA                                            INSIG116
C                                                                       INSIG117
      MK=AANG/DTHETA+1.00001                                            INSIG118
      ML=BANG/DTHETA+1.00001                                            INSIG119
      IF(ML.LT.MK) GO TO 176                                            INSIG120
      SIG1=0.0                                                          INSIG121
      DO 175 M=MK,ML                                                    INSIG122
      SIG1=SIG1+SIGPLT(M)                                               INSIG123
  175 CONTINUE                                                          INSIG124
      SIG2=SIG1*FACTF                                                   INSIG125
      WRITE(6,9003)SIG1,SIG2,AANG,BANG                                  INSIG126
  176 CONTINUE                                                          INSIG127
      NTH=MIN0(NTHETA,NX)                                               INSIG128
      IF(ICON(13).EQ.0) GO TO 178                                       INSIG129
      WRITE(8,9010)(SIGPLT(N),N=1,NTH)                                  INSIG131
  178 CONTINUE                                                          INSIG132
      IF(ICON(9).EQ.0) GO TO 180                                        INSIG133
      WRITE(6,9999)ALPHA,(IDAT(I),I=1,3)                                INSIG134
      CALL DWPLOT(NTH,ICON(9),SIGPLT,DTHETA,THETA1)                     INSIG135
  180 RETURN                                                            INSIG136
 9000 FORMAT(8H0  THETA,14H INEL-SIG,F**2,10H    POLZ  ,10H     T22  ,10INSIG137
     1H     T21  ,10H     T20  ,14H INEL-SIG,F**2,10H    POLZ  ,10H     INSIG138
     2T22  ,10H     T21  ,10H     T20  )                                INSIG139
 9001 FORMAT(F8.2,E14.5,4F10.5,E14.5,4F10.5)                            INSIG140
 9002 FORMAT(8H0TOT-SIG,E14.5,40X,E14.5)                                INSIG141
 9003 FORMAT(8H0SUM-SIG,E14.5,40X,E14.5,15H         LIMITS,F8.3,5H  AND,INSIG142
     1F8.3,9H  DEGREES)                                                 INSIG143
 9010 FORMAT(8E10.4)
 9011 FORMAT(10HINELASTIC ,15A4)                                        INSIG145
 9999 FORMAT(1H1,15A4,I2,2(1H/,I2),I4,2(1H.,I2))                        INSIG146
      END                                                               INSIG147
C
C FYSKTT*DWUCK4-1(1).FNLOC(0)
C
      SUBROUTINE FNLOC(U,W,VB,LTR,BKIN,FNRNG,KT)                        FNLOC000
C     THE NEXT 5 CARDS CONVERT DWUCK TO AN IBM 360                      FNLOC001
      IMPLICIT REAL*8(A-H,O-Z)                                          FNLOC002
C     SIN(XXX)=DSIN(XXX)                                                FNLOC003
C     COS(XXX)=DCOS(XXX)                                                FNLOC004
C     EXP(XXX)=DEXP(XXX)                                                FNLOC005
C     ABS(XXX)=DABS(XXX)                                                FNLOC006
      DIMENSION U(800,2),W(800),VB(800),BKIN(3,14)                      FNLOC007
     1,RT(8,7),FM(3),FMA(3),PNLOC(3),DR(3),FMU(3),FK2(3)                FNLOC008
      DATA  RT/0.0D0,4.4934D0,7.7253D0,10.9041D0,14.0662D0,17.2208D0,20.FNLOC009
     13713D0,23.5195D0,2.0816D0,5.9404D0,9.2058D0,12.4044D0,15.5792D0,18FNLOC010
     2.7426D0,21.8997D0,25.0528D0,3.3421D0,7.2899D0,10.6139D0,13.8461D0,FNLOC011
     317.0429D0,20.2219D0,23.3905D0,26.5526D0,4.5141D0,8.5838D0,11.9727DFNLOC012
     30,15.2445D0, 
     418.4681D0,21.6666D0,24.8501D0,28.0239D0,5.6467D0,9.8404D0,13.2956DFNLOC013
     50,16.6093D0,19.8624D0,23.0828D0,26.2833D0,29.4706D0,6.7565D0,11.07FNLOC014
     602D0,14.5906D0,17.9472D0,21.2311D0,24.4748D0,27.6937D0,30.8960D0, FNLOC015
     77.8511D0,12.2793D0,15.8632D0,19.2627D0,22.5781D0,25.8461D0,29.0843FNLOC016
     8D0,32.3025D0/                                                     FNLOC017
C                                                                       FNLOC018
C     FINITE RANGE CORRECTION                                           FNLOC019
C                                                                       FNLOC020
C                                                                       FNLOC021
C     POSITIVE FR PARAMETER CALCULATES A HULTHEN TYPE FR CORRECTION     FNLOC022
C     NEGATIVE FR PARAMETER CALCULATES A EXPONENTIAL TYPE FR CORRECTION FNLOC023
C                                                                       FNLOC024
      K=KT                                                              FNLOC025
      DO 20 I=1,3                                                       FNLOC026
      FM(I)   =BKIN(I,3)                                                FNLOC027
      FMA(I)  =BKIN(I,4)                                                FNLOC028
      PNLOC(I)=BKIN(I,7)                                                FNLOC029
      DR(I)   =BKIN(I,13)                                               FNLOC030
      FK2(I)  =BKIN(I,11)                                               FNLOC031
      FMU(I)  =BKIN(I,14)                                               FNLOC032
   20 CONTINUE                                                          FNLOC033
      IF(FNRNG.EQ.0.0) GO TO 398                                        FNLOC034
      IF(FM(1)-FM(2))143,398,142                                        FNLOC035
  142 I1=1                                                              FNLOC036
      I2=2                                                              FNLOC037
      GO TO 144                                                         FNLOC038
  143 I1=2                                                              FNLOC039
      I2=1                                                              FNLOC040
C                                                                       FNLOC041
C     I1 IS FOR LARGER MASS , I2 IS FOR SMALLER MASS                    FNLOC042
C                                                                       FNLOC043
  144 CONTINUE                                                          FNLOC044
      FM1=FMU(I1)                                                       FNLOC045
      FM2=FMU(I2)                                                       FNLOC046
      TEMP=FM(I2)*FNRNG**2/FM(I1)                                       FNLOC047
      FACT=TEMP*FMA(I1)/FMA(I2)                                         FNLOC048
      FMX=FM(I1)-FM(I2)                                                 FNLOC049
      TEMP=TEMP*FMX                                                     FNLOC050
      IF(FMX.LT.1.9) GO TO 350                                          FNLOC051
C                                                                       FNLOC052
C     FORM FACTOR PART BY ROST-KUNZ METHOD                              FNLOC053
C     THIS OPTION CALCULATES AN EXPONENTIAL TYPE FR CORRECTION          FNLOC054
C     FOR MULTI -NUCLEON TRANSFER REACTIONS                             FNLOC055
C                                                                       FNLOC056
      DR2=DR(3)**2                                                      FNLOC057
      FLF=LTR*(LTR+1)                                                   FNLOC058
      R3=DR(3)*FLOAT(K+1)                                               FNLOC059
      D3=0.0                                                            FNLOC060
      A3=0.0                                                            FNLOC061
      KM=K+K+1                                                          FNLOC062
      R2=R3-DR(3)                                                       FNLOC063
      D2=-FLF/R3                                                        FNLOC064
      A2=W (KM-2)*R2                                                    FNLOC065
      DO 220 M=1,K                                                      FNLOC066
      KM=KM-2                                                           FNLOC067
      R1=R2-DR(3)                                                       FNLOC068
      A1=W (KM-2)*R1                                                    FNLOC069
      D1=-FLF/R2**2                                                     FNLOC070
      IF(A3.EQ.0.0) GO TO 215                                           FNLOC071
      D1=D1+(A3-2.0*A2+A1)/(A2*DR2)                                     FNLOC072
      W (KM+2)=W (KM+2)*EXP(D2*FACT)                                    FNLOC073
      DX2=(D3*A3-2.0*D2*A2+D1*A1)/(R2*DR2)-A2*D2**2/R2                  FNLOC074
      W (KM+2)=W (KM+2)+0.5*DX2*FACT**2                                 FNLOC075
  215 CONTINUE                                                          FNLOC076
      IF(ABS(W (KM-2)).LT.ABS(W (KM  ))) GO TO 225                      FNLOC077
      R3=R2                                                             FNLOC078
      R2=R1                                                             FNLOC079
      D3=D2                                                             FNLOC080
      D2=D1                                                             FNLOC081
      A3=A2                                                             FNLOC082
      A2=A1                                                             FNLOC083
  220 CONTINUE                                                          FNLOC084
  225 CONTINUE                                                          FNLOC085
      KM=KM/2+1                                                         FNLOC086
      DO 227 M=1,KM                                                     FNLOC087
      MK=M+M-1                                                          FNLOC088
      VB(M)=W(MK)                                                       FNLOC089
      W(MK)=0.0                                                         FNLOC090
  227 CONTINUE                                                          FNLOC091
      RKM=FLOAT(KM)*DR(3)                                               FNLOC092
      LL=MIN0(LTR,6)                                                    FNLOC093
      FLF=LL*(LL+1)                                                     FNLOC094
      DR12=DR(3)**2/12.0                                                FNLOC095
      DO 250 N=1,8                                                      FNLOC096
      FKX=(RT(N,LL+1)/RKM)**2                                           FNLOC097
      A1=0.0                                                            FNLOC098
      D1=0.0                                                            FNLOC099
      R=DR(3)                                                           FNLOC100
      A2=DR(3)                                                          FNLOC101
      D2=(1.0+DR12*(FKX-FLF/R**2))*A2                                   FNLOC102
      FNORM=0.0                                                         FNLOC103
      AN=0.0                                                            FNLOC104
      DO 230 M=1,KM                                                     FNLOC105
      AN=AN+VB(M)*A2*R                                                  FNLOC106
      FNORM=FNORM+A2**2                                                 FNLOC107
      VB(M+400)=A2/R                                                    FNLOC108
      R=R+DR(3)                                                         FNLOC109
      D3=1.0+DR12*(FKX-FLF/R**2)                                        FNLOC110
      A3=(12.0*A2-10.0*D2-D1)/D3                                        FNLOC111
      D1=D2                                                             FNLOC112
      D2=D3*A3                                                          FNLOC113
      A1=A2                                                             FNLOC114
      A2=A3                                                             FNLOC115
  230 CONTINUE                                                          FNLOC116
      AN=AN-0.5*VB(KM)*A1*(R-DR(3))                                     FNLOC117
      FNORM=FNORM-0.5*A1**2                                             FNLOC118
      FNORM=AN*EXP(-FACT*FKX)/FNORM                                     FNLOC119
      DO 240 M=1,KM                                                     FNLOC120
      MK=M+M-1                                                          FNLOC121
      W (MK)=W (MK)+VB(M+400)*FNORM                                     FNLOC122
  240 CONTINUE                                                          FNLOC123
  250 CONTINUE                                                          FNLOC124
  340 CONTINUE                                                          FNLOC125
C                                                                       FNLOC126
C     DISTORTED WAVE PART, GAUSSIAN FACTOR                              FNLOC127
C                                                                       FNLOC128
      DO 345 M=1,K                                                      FNLOC129
      MK=M+M-1                                                          FNLOC130
      CTEMP1=TEMP*(U(MK  ,I2)/FM2-U(MK  ,I1)/FM1)                       FNLOC131
      CTEMP2=TEMP*(U(MK+1,I2)/FM2-U(MK+1,I1)/FM1)                       FNLOC132
      FACT=EXP(-CTEMP1)                                                 FNLOC133
      UT1= FACT*COS(CTEMP2)                                             FNLOC134
      UT2=-FACT*SIN(CTEMP2)                                             FNLOC135
      UF1   =UT1*W(MK  )-UT2*W(MK+1)                                    FNLOC136
      UF2   =UT1*W(MK+1)+UT2*W(MK  )                                    FNLOC137
      W(MK  )=UF1                                                       FNLOC138
      W(MK+1)=UF2                                                       FNLOC139
  345 CONTINUE                                                          FNLOC140
  348 CONTINUE                                                          FNLOC141
      GO TO 398                                                         FNLOC142
  350 CONTINUE                                                          FNLOC143
      IF(FNRNG.GT.0.0) GO TO 360                                        FNLOC144
C                                                                       FNLOC145
C     SINGLE PARTICLE PART, GAUSSIAN FACTOR                             FNLOC146
C                                                                       FNLOC147
      DO 355 M=1,K                                                      FNLOC148
      MK=M+M-1                                                          FNLOC149
      FACT=EXP(-TEMP*VB(M)/FMU(3))                                      FNLOC150
      W(MK  )=W(MK  )*FACT                                              FNLOC151
      W(MK+1)=W(MK+1)*FACT                                              FNLOC152
  355 CONTINUE                                                          FNLOC153
      GO TO 340                                                         FNLOC154
  360 CONTINUE                                                          FNLOC155
C                                                                       FNLOC156
C     HULTHEN TYPE                                                      FNLOC157
C                                                                       FNLOC158
      DO 365 M=1,K                                                      FNLOC159
      MK=M+M-1                                                          FNLOC160
      CTEMP1=VB(M)/FMU(3)+U(MK  ,I2)/FM2-U(MK  ,I1)/FM1                 FNLOC161
      CTEMP2=             U(MK+1,I2)/FM2-U(MK+1,I1)/FM1                 FNLOC162
      CTEMP1=1.0+TEMP*CTEMP1                                            FNLOC163
      CTEMP2=    TEMP*CTEMP2                                            FNLOC164
      DET=CTEMP1**2+CTEMP2**2                                           FNLOC165
      UT1=(CTEMP1*W(MK  )+CTEMP2*W(MK+1))/DET                           FNLOC166
      UT2=(CTEMP1*W(MK+1)-CTEMP2*W(MK  ))/DET                           FNLOC167
      W(MK  )=UT1                                                       FNLOC168
      W(MK+1)=UT2                                                       FNLOC169
  365 CONTINUE                                                          FNLOC170
  398 CONTINUE                                                          FNLOC171
C                                                                       FNLOC172
C     NON LOCALITY CORRECTION FACTOR FOR DISTORTED WAVES                FNLOC173
C                                                                       FNLOC174
      FACT1=PNLOC(1)**2/8.0                                             FNLOC175
      FACT2=PNLOC(2)**2/8.0                                             FNLOC176
      IF(FACT1+FACT2.EQ.0.0) GO TO 410                                  FNLOC177
      DO 400 M=1,K                                                      FNLOC178
      MK=M+M-1                                                          FNLOC179
      CTEMP1=-FACT1*U(MK  ,1)-FACT2*U(MK  ,2)+FACT1*FK2(1)+FACT2*FK2(2) FNLOC180
      CTEMP2=-FACT1*U(MK+1,1)-FACT2*U(MK+1,2)                           FNLOC181
      FACT=EXP(CTEMP1)                                                  FNLOC182
      UT1=FACT*COS(CTEMP2)                                              FNLOC183
      UT2=FACT*SIN(CTEMP2)                                              FNLOC184
      UF1   =UT1*W(MK  )-UT2*W(MK+1)                                    FNLOC185
      UF2   =UT1*W(MK+1)+UT2*W(MK  )                                    FNLOC186
      W(MK  )=UF1                                                       FNLOC187
      W(MK+1)=UF2                                                       FNLOC188
  400 CONTINUE                                                          FNLOC189
  410 CONTINUE                                                          FNLOC190
      RETURN                                                            FNLOC191
      END                                                               FNLOC192
C
C FYSKTT*DWUCK4-1(1).CATHEN(1)
C
      SUBROUTINE CATHEN(LOPT,JOPT,UB,VB,SI)                             CATHE  0
C     THE NEXT 4 CARDS CONVERT DWUCK TO AN IBM 360                      CATHE  1
      IMPLICIT REAL*8(A-H,O-Z)                                          CATHE  2
C     SQRT(XXX)=DSQRT(XXX)                                              CATHE  3
C     FLOAT(III)=DFLOAT(III)                                            CATHE  4
C     ABS(XXX)=DABS(XXX)                                                CATHE  5
      COMMON ALPHA(15),IDAT(6),ICON(16),ANGLE(5),HBARC,AMU,AMASS,CHSQ,AACATHE  6
     1,DRF,Z(3),ZA(3),FM(3),FMA(3),RC(3),AC(3),PNLOC(3),FS(3),ECM(3)    CATHE  7
     2,FK(3),FK2(3),ETA(3),DR(3),FMU(3),FN,FL,FJ2,FSS,VCE,FNRNG,RSIG(2) CATHE  8
     3,K,KZ,LPLUS,LPL2,IS(3),NS(3),NLTR,LTRT(8),JTRT(8),ISTRT(8),IBF(8) CATHE  9
      DIMENSION UB(800,2),VB(801),SI(800),C(10),QNUM(4,2),G(4),IQN(3)   CATHE 10
     1         ,JI(2),JJ(2),FJT(2),CON(4)                               CATHE 11
      EQUIVALENCE (G,FN),(C(1),CNTROL),(C(2),QCODE),(C(3),FMUV)         CATHE 12
     1,(C(4),OPT)                                                       CATHE 13
      DATA SQR4PI,SQRTEN,PI/3.54490780D0,3.162277660D0,3.141592D0/ 
C                                                                       CATHE 15
      IQFLG=0                                                           CATHE 16
      KMFLG=0                                                           CATHE 17
      IQN(1)=LOPT                                                       CATHE 18
      IQN(3)=JOPT                                                       CATHE 19
      KT=399                                                            CATHE 20
      IBF(2)=1                                                          CATHE 21
      FK2(3)=0.0                                                        CATHE 22
  100 CONTINUE                                                          CATHE 23
      READ(5,9001)C                                                     CATHE 24
      CNTRL=ABS(CNTROL)                                                 CATHE 25
      IF(CNTRL.EQ.0.0) GO TO 3010                                       CATHE 26
      IF(QCODE)2020,3000,1100                                           CATHE 27
 1100 CONTINUE                                                          CATHE 28
C                                                                       CATHE 29
C     LOOP FOR TWO ORBITALS                                             CATHE 30
C                                                                       CATHE 31
      ML=1                                                              CATHE 32
      DO 2015 I=1,2                                                     CATHE 33
      FJT(1)=C(5)                                                       CATHE 34
      FJT(2)=C(I+5)                                                     CATHE 35
      IF(I.EQ.2.AND.CNTRL.EQ.1.0) GO TO 2005
      IK=0                                                              CATHE 39
      IF(ABS(QCODE).EQ.7.0) GO TO 2003                                  CATHE 40
      IF(ABS(QCODE).EQ.8.0) GO TO 2003                                  CATHE 41
      GO TO 2004                                                        CATHE 42
 2003 CONTINUE                                                          CATHE 43
      IF(I.EQ.2) IK=1                                                   CATHE 44
 2004 CONTINUE                                                          CATHE 45
      G(1)=0.0                                                          CATHE 46
      G(2)=0.0                                                          CATHE 47
      G(3)=0.0                                                          CATHE 48
      G(4)=0.0                                                          CATHE 49
C                                                                       CATHE 50
      CALL FORMF(UB(1,2),VB,3,LOPT,IK)                                  CATHE 51
C                                                                       CATHE 52
      DRX=DR(3)                                                         CATHE 53
      IF(KMFLG.EQ.0) KM=IBF(2)                                          CATHE 54
      KMFLG=1                                                           CATHE 55
      KT=MIN0(KT,K)                                                     CATHE 56
 2005 CONTINUE                                                          CATHE 57
      IF(FJT(1).EQ.0.0) FJT(2)=FJ2                                      CATHE 58
      IF(ICON(4).EQ.2) GO TO 2007                                       CATHE 59
C                                                                       CATHE 60
C     PRINT OUT SINGLE PARTICLE INFORMATION                             CATHE 61
C                                                                       CATHE 62
      WRITE(6,9501)                                                     CATHE 63
      WRITE(6,9100)FJ2,FJT                                              CATHE 64
      IF(CNTRL.EQ.1.0.AND.I.EQ.2) GO TO 2007                            CATHE 65
      R=DRX                                                             CATHE 66
      K2=K+K                                                            CATHE 67
      DO 2006 M=1,K2,20                                                 CATHE 68
      MK4=MIN0(M+19,K2)                                                 CATHE 69
      WRITE(6,9052)R,(UB(N,2),N=M,MK4,2)                                CATHE 70
      R=R+10.0*DRX                                                      CATHE 71
 2006 CONTINUE                                                          CATHE 72
 2007 CONTINUE                                                          CATHE 73
      DO 2008 M=1,400                                                   CATHE 74
      MK=M+M-1                                                          CATHE 75
      UB(ML,1)=UB(MK,2)                                                 CATHE 76
      ML=ML+1                                                           CATHE 77
 2008 CONTINUE                                                          CATHE 78
      DO 2009 M=1,4                                                     CATHE 79
      QNUM(M,I)=G(M)                                                    CATHE 80
 2009 CONTINUE                                                          CATHE 81
      JI(I)=FJT(1)                                                      CATHE 82
      JJ(I)=FJT(2)                                                      CATHE 83
 2015 CONTINUE                                                          CATHE 84
 2020 ICODE=ABS(QCODE)                                                  CATHE 85
      KT=MIN0(KT,K)                                                     CATHE 86
      LTR1=IQN(1)+1                                                     CATHE 87
      IQN(2)=IS(3)                                                      CATHE 88
      IF(IS(3).EQ.0) IQN(3)=IQN(1)+IQN(1)                               CATHE 89
      WRITE(6,9051)QCODE,FMUV,OPT                                       CATHE 90
C     ENTER TIME REVERSAL PHASE                                         CATHE 91
      LVR=QNUM(2,1)+QNUM(2,2)                                           CATHE 92
      OPT=OPT*PHASEF((LVR+IQN(1))/2)                                    CATHE 93
      IFLAG=1                                                           CATHE 94
      IF(ICODE.LE.10) GO TO 2025                                        CATHE 95
      IFLAG=2                                                           CATHE 96
      ICODE=ICODE-10                                                    CATHE 97
 2025 CONTINUE                                                          CATHE 98
C                                                                       CATHE 99
      GO TO (2100,2100,2300,2990,2500,2100,2700,2700),ICODE             CATHE100
C                                                                       CATHE101
C     ICODE=1  YUKAWA POTENTIAL                                         CATHE102
C     ICODE=2  COULOMB POTENTIAL                                        CATHE103
C     ICODE=3  OPEP TENSOR POTENTIAL                                    CATHE104
C     ICODE=5  TWO PARTICLE TRANSFER                                    CATHE105
C     ICODE=6  ZERO RANGE KNOCK OUT                                     CATHE106
C     ICODE=7  NO RECOIL FORM FACTOR                                    CATHE107
C                                                                       CATHE108
 2100 LVR=0                                                             CATHE109
      TOPT=1.0                                                          CATHE110
      GO TO 2350                                                        CATHE111
 2300 ICODE=1                                                           CATHE112
      LVR=2                                                             CATHE113
      TOPT=-SQRTEN                                                      CATHE114
 2350 MNNL=IABS(LTR1-LVR-1)+1                                           CATHE115
      MXXL=LTR1+LVR                                                     CATHE116
      LTR2=LTR1+LTR1-2                                                  CATHE117
      LVR2=LVR+LVR                                                      CATHE118
      LLX=QNUM(2,1)+QNUM(2,1)                                           CATHE119
      LPX=QNUM(2,2)+QNUM(2,2)                                           CATHE120
      JLX=QNUM(3,1)                                                     CATHE121
      JPX=QNUM(3,2)                                                     CATHE122
      IS1=QNUM(4,1)*2.0                                                 CATHE123
      IS2=QNUM(4,2)*2.0                                                 CATHE124
      OPT=OPT*PHASEF(LPX/2)                                             CATHE125
      DRX=DR(1)                                                         CATHE126
      DO 2390 LAM =MNNL,MXXL,2                                          CATHE127
      LAM2 =LAM +LAM -2                                                 CATHE128
      VOPT=TOPT*OPT*SQR4PI*SQRT(FLOAT(LAM2 +1)*FLOAT(IQN(2)+1))         CATHE129
     1 *VCC(LAM2 ,LVR2,LTR2 ,0,0)                                       CATHE130
     2 *RACAH(IQN(2),IQN(2),LAM2 ,LTR2 ,LVR2,IQN(3))                    CATHE131
      RME=0.0  
      IF(IQN(2).EQ.0) RME=1.0                                           CATHE132
      IF(IQN(2).EQ.2) RME=SQRT(FLOAT(IS(1)*(IS(1)+2))                   CATHE133
     1*FLOAT(IS1*(IS1+2)))                                              CATHE134
      RME=RME*SQRT(FLOAT(IS1+1))*PHASEF((IS(1)-IS(2))/2)                CATHE135
     1 *SQRT(FLOAT((LLX+1)*(LAM2+1)))*VCC(LLX,LAM2,LPX,0,0)             CATHE136
     2 *SQRT(FLOAT(JLX+1)*FLOAT(JPX+1)*FLOAT(IQN(3)+1))                 CATHE137
     3 *WINEJ(LPX,LLX,LAM2 ,IS2,IS1,IQN(2),JPX,JLX,IQN(3))              CATHE138
     4 *PHASEF((JI(1)+IQN(3)-JLX-JJ(2))/2)                              CATHE139
     5 *RACAH(JPX,JJ(2),JLX,JJ(1),JI(1),IQN(3))                         CATHE140
     6 *SQRT(FLOAT(JJ(1)+1)*FLOAT(JJ(2)+1))                             CATHE141
      VOPT=VOPT*RME*SQRT(FLOAT(LTR2+1)/FLOAT((JJ(1)+1)*(IQN(3)+1)))     CATHE142
     1 *(DR(3)/DR(1))**3                                                CATHE143
      SL=0.0                                                            CATHE144
      IF(VOPT.EQ.0.0) GO TO 2385                                        CATHE145
      IF(ICODE.EQ.6) GO TO 2365                                         CATHE146
C                                                                       CATHE147
      CALL SLATR (KT,DRX,VB(  1),LTR1,FMUV,ICODE)                       CATHE148
      CALL SLATR (KT,DRX,VB(801),LAM ,FMUV,ICODE)                       CATHE149
C                                                                       CATHE150
C                                                                       CATHE151
      CALL RADIN(KT,DRX,VB,UB,SL,VOPT,SI(IFLAG),KM,SK)                  CATHE152
C                                                                       CATHE153
      GO TO 2380                                                        CATHE154
 2365 CONTINUE                                                          CATHE155
      SCALE=VOPT/SQR4PI**2                                              CATHE156
      R=0.0                                                             CATHE157
      MK=IFLAG                                                          CATHE158
      DO 2370 M=1,KT                                                    CATHE159
      R=R+DRX                                                           CATHE160
      TEMP=UB(M,1  )*UB(M+400,1)*SCALE                                  CATHE161
      SI(MK  )=SI(MK  )+TEMP                                            CATHE162
      SL      =SL      +TEMP*R**2                                       CATHE163
      IF(M.EQ.KM) SK=TEMP                                               CATHE164
      MK=MK+2                                                           CATHE165
 2370 CONTINUE                                                          CATHE166
      SL=SL*DRX                                                         CATHE167
 2380 CONTINUE                                                          CATHE168
 2385 I=LAM -1                                                          CATHE169
      WRITE(6,9102)SL,IQN(1),I,RME                                      CATHE170
      WRITE(6,9002)KM,SK                                                CATHE171
 2390 CONTINUE                                                          CATHE172
      GO TO 2990                                                        CATHE173
C                                                                       CATHE174
C     HERE FOR TWO NUCLEON TRANSFER                                     CATHE175
C                                                                       CATHE176
 2500 CONTINUE                                                          CATHE177
      CON(1)=1.0                                                        CATHE183
      CON(2)=1.0                                                        CATHE184
      CON(3)=1.0                                                        CATHE185
      CON(4)=0.0                                                        CATHE186
      OPT=OPT*16./PI
      IF(FMUV.EQ.0.0) FMUV=1.7                                          CATHE187
      CALL DSTRIP(IQN,DRX,KT,UB,SI(IFLAG),QNUM,OPT,FMUV,KM,SL,CON)      CATHE188
      WRITE(6,9002)KM,SL                                                CATHE189
      IQFLG=1                                                           CATHE190
      GO TO 2990                                                        CATHE191
 2700 CONTINUE                                                          CATHE192
      T1=AMIN1(FM(1),FM(2))                                             CATHE193
      T2=AMAX1(FM(1),FM(2))                                             CATHE194
      CON(1)=T1/T2                                                      CATHE195
      CON(2)=1.0                                                        CATHE196
      CON(3)=0.0                                                        CATHE197
      CON(4)=1.0                                                        CATHE198
      IF(ICODE.EQ.8) GO TO 2706                                         CATHE199
      T3=HBARC**2/(2.0*AMU*FMU(3))                                      CATHE200
      R=0.0                                                             CATHE201
      DO 2705 M=1,KT                                                    CATHE202
      R=R+DRX                                                           CATHE203
      UB(M+400,1)=UB(M+400,1)*T3*  (FK2(3)-VB(M))                       CATHE204
 2705 CONTINUE                                                          CATHE205
 2706 CONTINUE                                                          CATHE206
      M=(KT+KM)/2+400                                                   CATHE207
      T1=ALOG(UB(M-1,1)*FLOAT(M-401)/(UB(M  ,1)*FLOAT(M-400))) 
      FMUV=DRX/T1                                                       CATHE209
      DO 2710 M=1,KT                                                    CATHE210
      UB(M+400,1)=UB(M+400,1)*EXP(T1*FLOAT(M))*DRX*FLOAT(M)/100.
 2710 CONTINUE                                                          CATHE212
      OPT=OPT*FMUV*FMUV*SQR4PI/2.0 
      CALL DSTRIP(IQN,DRX,KT,UB,SI(IFLAG),QNUM,OPT,FMUV,KM,SL,CON)      CATHE219
      WRITE(6,9002)KM,SL                                                CATHE220
      IQFLG=1                                                           CATHE221
      GO TO 2990                                                        CATHE222
 2990 CONTINUE                                                          CATHE223
 3000 CONTINUE                                                          CATHE224
      IF(CNTROL.GT.0.0) GO TO 100                                       CATHE225
      IF(IQFLG .EQ.1) KT=FLOAT(KT)-1.50/DRX                             CATHE226
      K=KT                                                              CATHE227
 3010 RETURN                                                            CATHE228
 9001 FORMAT(10F8.4)                                                    CATHE229
 9002 FORMAT(15H FORM FACTOR,M=,I3,E18.6)                               CATHE230
 9051 FORMAT(18H0PARAMETERS       ,9H   QCODE=,F9.4,9H   RANGE=,F9.4,9H CATHE231
     1  VZERO=,F9.4)                                                    CATHE232
 9052 FORMAT(1H ,F6.2,10E12.4)                                          CATHE233
 9100 FORMAT(27H0SINGLE PARTICLE FUNCTIONS ,8HCOUPLING ,6H 2*J1=,F3.0   CATHE234
     1 ,9H    2*J2=,F3.0,9H    2*JI=,F3.0)                              CATHE235
 9102 FORMAT(19H VOLUME INTEGRAL = ,F9.4,5H LTR=,I3,5H LAM=,I3,5H RME=  CATHE236
     1,F8.4)                                                            CATHE237
 9501 FORMAT(1H ,18HFORM FACTOR DATA  )                                 CATHE238
      END                                                               CATHE240
C
C FYSKTT*DWUCK4-1(1).SLATR(0)
C
      SUBROUTINE SLATR (KT,DRF,VB,MINL,FMU,ICODE)                       SLATR000
C     THE NEXT 3 CARDS CONVERT DWUCK TO AN IBM 360                      SLATR001
      IMPLICIT REAL*8(A-H,O-Z)                                          SLATR002
C     EXP(XXX)=DEXP(XXX)                                                SLATR003
C     ABS(XXX)=DABS(XXX)
      DIMENSION VB(800)                                                 SLATR004
C                                                                       SLATR005
C     YUKAWA SLATER EXPANSION                                           SLATR006
C                                                                       SLATR007
      R=0.0                                                             SLATR008
      IF(ICODE.EQ.2) GO TO 101                                          SLATR009
C                                                                       SLATR010
C     HANKEL FUNCTION                                                   SLATR011
C                                                                       SLATR012
      F1=1.0                                                            SLATR013
      F2=EXP(-FMU*DRF)                                                  SLATR014
      DO 100 M=1,KT                                                     SLATR015
      R=R+DRF                                                           SLATR016
      X=FMU*R                                                           SLATR017
      F1=F1*F2                                                          SLATR018
      AZ=(1.0/F1-F1)/(2.0*X)                                            SLATR019
      B2=1.0/X                                                          SLATR020
      B1=B2*(1.0+B2)                                                    SLATR021
      FL=-1.0                                                           SLATR022
      DO 50 LL=1,MINL                                                   SLATR023
      B3=FL*B2/X+B1                                                     SLATR024
      B1=B2                                                             SLATR025
      B2=B3                                                             SLATR026
      FL=FL+2.0                                                         SLATR027
   50 CONTINUE                                                          SLATR028
      VB(M+400)=B2*F1                                                   SLATR029
C                                                                       SLATR030
C     BESSEL FUNCTION                                                   SLATR031
C                                                                       SLATR032
      MAX=2.0*X+10.0                                                    SLATR033
      MAX=MAX0(MAX,MINL+5)                                              SLATR034
      A3=0.0                                                            SLATR035
      A2=1.0                                                            SLATR036
      FL=MAX+MAX+3                                                      SLATR037
      DO 70 LL=1,MAX                                                    SLATR038
      N=MAX+1-LL                                                        SLATR039
      FL=FL-2.0                                                         SLATR040
      A1=A3+FL*A2/X                                                     SLATR041
      IF(N.LT.MINL) GO TO 69
      IF(ABS(A1).LT.1.0E+20) GO TO 69  
      A1=A1*1.0E-20
      A2=A2*1.0E-20
   69 CONTINUE 
      IF(N.EQ.MINL) TEMP=A1
      A3=A2                                                             SLATR043
      A2=A1                                                             SLATR044
   70 CONTINUE                                                          SLATR045
      VB(M    )=TEMP*AZ/A1                                              SLATR046
  100 CONTINUE                                                          SLATR047
      RETURN                                                            SLATR048
C                                                                       SLATR049
C     COULOMB SLATER EXPANSION                                          SLATR050
C                                                                       SLATR051
  101 CONTINUE                                                          SLATR052
      FL=MINL+MINL-1                                                    SLATR053
      DO 200 M=1,KT                                                     SLATR054
      R=R+DRF                                                           SLATR055
      A2=1.0                                                            SLATR056
      DO 105 LL=1,MINL                                                  SLATR057
      A2=A2*R                                                           SLATR058
  105 CONTINUE                                                          SLATR059
      VB(M    )=A2/(R*FL)                                               SLATR060
      VB(M+400)=1.0/A2                                                  SLATR061
  200 CONTINUE                                                          SLATR062
      RETURN                                                            SLATR063
      END                                                               SLATR064
C
C FYSKTT*DWUCK4-1(1).RADIN(0)
C
      SUBROUTINE RADIN(KT,DRF,VB,UB,SL,OPT,SI,KM,SK)                    RADIN000
C     THE NEXT 1 CARDS CONVERT DWUCK TO AN IBM 360                      RADIN001
      IMPLICIT REAL*8(A-H,O-Z)                                          RADIN002
      DIMENSION UB(400,2),VB(800),SI(800),DG(2)                         RADIN003
C                                                                       RADIN004
      DG(1)=2.0*DRF/3.0                                                 RADIN005
      DG(2)=2.0*DG(1)                                                   RADIN006
      R2=0.0                                                            RADIN007
      SUMA=0.0                                                          RADIN008
      SUMB=0.0                                                          RADIN009
      SUMC=0.0                                                          RADIN010
      SUMD=0.0                                                          RADIN011
      DO 200 M=1,KT                                                     RADIN012
      MK=M+M-1                                                          RADIN013
      R2=R2+DRF                                                         RADIN014
      SLL=0.0                                                           RADIN015
      MX=1                                                              RADIN016
      R1=0.0                                                            RADIN017
      DO 100 MM=1,KT                                                    RADIN018
      R1=R1+DRF                                                         RADIN019
      MX=3-MX                                                           RADIN020
      F1=DG(MX)*UB(MM,1)*UB(MM,2)*R1**2                                 RADIN021
      IF(M-MM)70,90,80                                                  RADIN022
   70 TEMP=VB(M)*VB(MM+1200)                                            RADIN023
      GO TO 95                                                          RADIN024
   80 TEMP=VB(MM+800)*VB(M+400)                                         RADIN025
      GO TO 95                                                          RADIN026
   90 TEMP=0.5*(VB(M)*VB(M+1200)+VB(M+800)*VB(M+400))                   RADIN027
   95 CONTINUE                                                          RADIN028
      SLL=SLL+F1*TEMP                                                   RADIN029
  100 CONTINUE                                                          RADIN030
      SLL=SLL*OPT                                                       RADIN031
      R22=R2**2                                                         RADIN032
      IF(M.EQ.KM) SK=SLL                                                RADIN033
      SI(MK)=SI(MK)+SLL                                                 RADIN034
      SUMA=SUMA+UB(M,1)*UB(M,2)*R22                                     RADIN035
      SUMB=SUMB+UB(M,1)*UB(M,2)*R22**2                                  RADIN036
      SUMC=SUMC+SLL*R22                                                 RADIN037
      SUMD=SUMD+SLL*R22**2                                              RADIN038
  200 CONTINUE                                                          RADIN039
      SUMA=SUMA*DRF                                                     RADIN040
      SUMB=SUMB*DRF                                                     RADIN041
      SUMC=SUMC*DRF                                                     RADIN042
      SUMD=SUMD*DRF                                                     RADIN043
      SL=SUMC                                                           RADIN044
      WRITE(6,9100)SUMA,SUMB,SUMC,SUMD                                  RADIN045
      RETURN                                                            RADIN046
 9100 FORMAT(13H0        J0 =,F11.4,7H   J1 =,F11.4,7H   K0 =,F11.4,7H  RADIN047
     1 K1 =,F11.4)                                                      RADIN048
      END                                                               RADIN049
C
C FYSKTT*DWUCK4-1(1).DSTRIP(0)
C
      SUBROUTINE DSTRIP(IQ,DR,K,F,FR,QNUM,OPT,RMS,KM,SL,C)              DSTRI000
C     THE NEXT 3 CARDS CONVERT DWUCK TO AN IBM 360                      DSTRI001
      IMPLICIT REAL*8(A-H,O-Z)                                          DSTRI002
C     SQRT(XXX)=DSQRT(XXX)                                              DSTRI003
C     FLOAT(III)=DFLOAT(III)                                            DSTRI004
      DIMENSION F(400,2),FR(800),QNUM(4,2),TVCC(10),IQ(3),D1(10),D2(10) DSTRI005
     1, C(4),   AH(36),WH(36),AG(15),WG(15),WR(8),AR(8),AL(36),WL(36)   DSTRI006
C                                                                       DSTRI007
C     GAUSS-HERMITE  POINTS AND WEIGHTS                                 DSTRI008
C                                                                       DSTRI009
      DATA AH/1.2247449D+00,9.5857246D-01,2.0201829D+00,8.1628788D-01,  DSTRI010
     *        1.6735516D+00,2.6519614D+00,7.2355102D-01,1.4685533D+00,  DSTRI011
     *        2.2665806D+00,3.1909932D+00,6.5680957D-01,1.3265571D+00,  DSTRI012
     *        2.0259480D+00,2.7832901D+00,3.6684708D+00,6.0576388D-01,  DSTRI013
     *        1.2200550D+00,1.8531077D+00,2.5197357D+00,3.2466090D+00,  DSTRI014
     *        4.1013376D+00,5.6506958D-01,1.1361156D+00,1.7199926D+00,  DSTRI015
     *        2.3257325D+00,2.9671669D+00,3.6699504D+00,4.4999907D+00,  DSTRI016
     *        5.3163300D-01,1.0676487D+00,1.6129243D+00,2.1735028D+00,  DSTRI017
     *        2.7577629D+00,3.3789321D+00,4.0619467D+00,4.8713452D+00/  DSTRI018
      DATA WH/4.4311346D-01,3.6168151D-01,8.1431951D-02,2.8359314D-01,  DSTRI019
     *        1.5268588D-01,6.8344394D-03,2.2650437D-01,1.9080848D-01,  DSTRI020
     *        2.5397314D-02,4.0329558D-04,1.8522529D-01,2.0629219D-01,  DSTRI021
     *        4.8889910D-02,2.6867077D-03,1.9373141D-05,1.5471205D-01,  DSTRI022
     *        2.0887607D-01,7.1642937D-02,7.6662455D-03,2.1534560D-04,  DSTRI023
     *        8.1173491D-07,1.3156226D-01,2.0457093D-01,9.1058866D-02,  DSTRI024
     *        1.5026662D-02,8.8044706D-04,1.4264736D-05,3.0830008D-08,  DSTRI025
     *        1.1356968D-01,1.9679727D-01,1.0645449D-01,2.3938742D-02,  DSTRI026
     *        2.2712587D-03,8.1202300D-05,8.2118871D-07,1.0869716D-09/  DSTRI027
C                                                                       DSTRI028
C     GAUSS-LAGUERRE  POINTS AND WEIGHTS                                DSTRI029
C                                                                       DSTRI030
      DATA AL/2.0000000D+00,1.2679492D+00,4.7320508D+00,9.3582223D-01,  DSTRI031
     *        3.3054073D+00,7.7587705D+00,7.4329193D-01,2.5716350D+00,  DSTRI032
     *        5.7311788D+00,1.0953894D+01,6.1703085D-01,2.1129660D+00,  DSTRI033
     *        4.6108332D+00,8.3990670D+00,1.4260103D+01,5.2766812D-01,  DSTRI034
     *        1.7962998D+00,3.8766415D+00,6.9188166D+00,1.1234610D+01,  DSTRI035
     *        1.7645964D+01,4.6102422D-01,1.5635862D+00,3.3520505D+00,  DSTRI036
     *        5.9162972D+00,9.4206994D+00,1.4194166D+01,2.1092177D+01,  DSTRI037
     *        4.0938357D-01,1.3849632D+00,2.9562546D+00,5.1819431D+00,  DSTRI038
     *        8.1617097D+00,1.2070055D+01,1.7249736D+01,2.4585955D+01/  DSTRI039
      DATA WL/1.0000000D+00,7.8867513D-01,2.1132487D-01,5.8868148D-01,  DSTRI040
     *        3.9121606D-01,2.0102460D-02,4.4687059D-01,4.7763577D-01,  DSTRI041
     *        7.4177785D-02,1.3158497D-03,3.4801454D-01,5.0228067D-01,  DSTRI042
     *        1.4091592D-01,8.7198930D-03,6.8973324D-05,2.7765014D-01,  DSTRI043
     *        4.9391058D-01,2.0300430D-01,2.4668820D-02,7.6304277D-04,  DSTRI044
     *        3.1150394D-06,2.2621060D-01,4.6970871D-01,2.5312252D-01,  DSTRI045
     *        4.7803109D-02,3.1004598D-03,5.4484669D-05,1.2633399D-07,  DSTRI046
     *        1.8763254D-01,4.3898536D-01,2.8999607D-01,7.5141385D-02,  DSTRI047
     *        7.9326466D-03,3.0864214D-04,3.3489582D-06,4.7213928D-09/  DSTRI048
C                                                                       DSTRI049
C     GAUSS-LEGENDRE POINTS AND WEIGHTS                                 DSTRI050
C                                                                       DSTRI051
      DATA AG/.57735027D0,.33998104D0,.86113631D0,.23861919D0,.66120939DDSTRI052
     10, .93246951D0,.18343464D0,.52553241D0,.79666648D0,.96028986D0,   DSTRI053
     2     .14887434D0,.43339539D0,.67940957D0,.86506337D0,.97390653D0/ DSTRI054
      DATA WG/1.00000D0,.65214515D0,.34785485D0,.46791393D0,.36076157D0,DSTRI055
     1      .17132449D0,.36268378D0,.31370665D0,.22238130D0,.10122854D0,DSTRI056
     2     .29552422D0,.26926672D0,.21908636D0,.14945135D0,.06667134D0/ DSTRI057
      DATA PI   /3.141592D0/                                            DSTRI058
      DATA SQR4PI/3.5449077D0/                                          DSTRI059
      ICNTRL=C(4)                                                       DSTRI060
      FKAP=RMS                                                          DSTRI061
      L =IQ(1)                                                          DSTRI062
      IS=IQ(2)                                                          DSTRI063
      JJ=IQ(3)                                                          DSTRI064
      N1=QNUM(1,1)                                                      DSTRI065
      N2=QNUM(1,2)                                                      DSTRI066
      L1=QNUM(2,1)                                                      DSTRI067
      L2=QNUM(2,2)                                                      DSTRI068
      J1=QNUM(3,1)                                                      DSTRI069
      J2=QNUM(3,2)                                                      DSTRI070
      IS1=QNUM(4,1)*2.0                                                 DSTRI071
      IS2=QNUM(4,2)*2.0                                                 DSTRI072
      ITEMP=N1+N1+N2+N2                                                 DSTRI073
      KR=(ITEMP+L1+L2-L+3)/4+8                                          DSTRI074
      KR=(KR+1)/2+ICNTRL+ICNTRL                                         DSTRI075
      NX=(ITEMP+L1+L2+L+2)/4+2                                          DSTRI076
      NX=(NX+1)/2+ICNTRL+ICNTRL                                         DSTRI077
      WRITE(6,9000)KR,NX                                                DSTRI078
 9000 FORMAT(15H0 NO. R STEPS =,I3,18H     NO. X STEPS =,I3)            DSTRI079
      IF(KR.GT.8) KR=8                                                  DSTRI080
      NKR=(KR*(KR-1))/2                                                 DSTRI081
      DO 18 I=1,KR                                                      DSTRI082
      IF(ICNTRL.EQ.0) GO TO 17                                          DSTRI083
      WR(I)=WL(NKR+I)                                                   DSTRI084
      AR(I)=AL(NKR+I)                                                   DSTRI085
      GO TO 18                                                          DSTRI086
   17 CONTINUE                                                          DSTRI087
      WR(I)=WH(NKR+I)                                                   DSTRI088
      AR(I)=AH(NKR+I)                                                   DSTRI089
   18 CONTINUE                                                          DSTRI090
      IF(NX.GT.5) NX=5                                                  DSTRI091
      NKX=(NX*(NX-1))/2                                                 DSTRI092
      LL=L+L                                                            DSTRI093
      LL1=L1+L1                                                         DSTRI094
      LL2=L2+L2                                                         DSTRI095
      FACT1=YXFCT(L1,LL1)/2.0**L1                                       DSTRI096
      FACT2=YXFCT(L2,LL2)/2.0**L2                                       DSTRI097
      FNORM=SQRT(FLOAT((LL1+1)*(LL2+1))/FLOAT(LL+1))                    DSTRI098
      IF(ICNTRL.NE.0) GO TO 60 
      TEMP=2.0                                                          DSTRI103
      DO 50 I=1,4                                                       DSTRI104
      IF(QNUM(I,1).NE.QNUM(I,2)) GO TO 55                               DSTRI105
   50 CONTINUE                                                          DSTRI106
      TEMP=4.0                                                          DSTRI107
   55 CONTINUE                                                          DSTRI108
      FNORM=FNORM/SQRT(TEMP)
   60 CONTINUE                                                          DSTRI110
      FNORM=FNORM*SQRT(FLOAT((LL+1)*(IS+1)*(J1+1)*(J2+1)))*             DSTRI111
     1 WINEJ(LL1,IS1,J1,LL2,IS2,J2,LL,IS,JJ)                            DSTRI112
      FM1=1.0                                                           DSTRI113
      FM2=1.0                                                           DSTRI114
      FL1=L1                                                            DSTRI115
      FL2=L2                                                            DSTRI116
      LPL=MIN0(L1,L2)+1                                                 DSTRI117
      DO 80 M=1,LPL                                                     DSTRI118
      M2=M+M-2                                                          DSTRI119
      FM=M-1                                                            DSTRI120
      TVCC(M)=VCC(LL1,LL2,LL,M2,-M2)*2.0/SQRT(FM1*FM2)                  DSTRI121
      FM1=FM1*(FL1+FM+1)*(FL1-FM)                                       DSTRI122
      FM2=FM2*(FL2+FM+1)*(FL2-FM)                                       DSTRI123
   80 CONTINUE                                                          DSTRI124
      TVCC(1)=TVCC(1)/2.0                                               DSTRI125
C                                                                       DSTRI126
C     CENTER OF MASS R LOOP                                             DSTRI127
C                                                                       DSTRI128
      R=0.0                                                             DSTRI129
      DO 500 M=1,K                                                      DSTRI130
      R=R+DR                                                            DSTRI131
      S=R*C(3)                                                          DSTRI132
      RSQ=R**2                                                          DSTRI133
      SSQ=S**2                                                          DSTRI134
      SUMR=0.0                                                          DSTRI135
      MK=M+M-1                                                          DSTRI136
C                                                                       DSTRI137
C     RELATIVE R LOOP                                                   DSTRI138
C                                                                       DSTRI139
      DO 400 MR=1,KR                                                    DSTRI140
      RS=AR(MR)*FKAP                                                    DSTRI141
      SS=RS*C(2)                                                        DSTRI142
      RS=RS*C(1)                                                        DSTRI143
      RSSQ=RS**2+RSQ                                                    DSTRI144
      RPROD=2.0*R*RS                                                    DSTRI145
      SSSQ=SS**2+SSQ                                                    DSTRI146
      SPROD=2.0*S*SS                                                    DSTRI147
C                                                                       DSTRI148
C     RELATIVE R ANGLE LOOP                                             DSTRI149
C                                                                       DSTRI150
      SUMX=0.0                                                          DSTRI151
      DO 300 MX=1,NX                                                    DSTRI152
      INDX=NKX+MX                                                       DSTRI153
      X=AG(INDX)                                                        DSTRI154
      WX=WG(INDX)                                                       DSTRI155
      IX=0                                                              DSTRI156
  110 CONTINUE                                                          DSTRI157
      R1=SQRT(RSSQ-RPROD*X)                                             DSTRI158
      R2=SQRT(SSSQ+SPROD*X)                                             DSTRI159
      FK1=R1/DR                                                         DSTRI160
      K1=FK1                                                            DSTRI161
      IF(K1.EQ.0) K1=1 
      FK1=FK1-FLOAT(K1)                                                 DSTRI162
      IF(K1.GT.K) GO TO 300                                             DSTRI163
      FK2=R2/DR                                                         DSTRI164
      K2=FK2                                                            DSTRI165
      IF(K2.EQ.0) K2=1 
      FK2=FK2-FLOAT(K2)                                                 DSTRI166
      IF(K2.GT.K) GO TO 300                                             DSTRI167
      COS1=(R-RS*X)/R1                                                  DSTRI168
      COS2=(S+SS*X)/R2                                                  DSTRI169
      SIN1=SQRT(1.0-COS1**2)                                            DSTRI170
      SIN2=SQRT(1.0-COS2**2)                                            DSTRI171
  120 CONTINUE                                                          DSTRI172
      DM1=0.0                                                           DSTRI173
      DL1=FACT1                                                         DSTRI174
      IF(L1.EQ.0) GO TO 141                                             DSTRI175
      DO 140 LI=1,L1                                                    DSTRI176
      DL1=DL1*SIN1                                                      DSTRI177
  140 CONTINUE                                                          DSTRI178
  141 CONTINUE                                                          DSTRI179
      D1(L1+1)=DL1                                                      DSTRI180
      DM2=0.0                                                           DSTRI181
      DL2=FACT2                                                         DSTRI182
      IF(L2.EQ.0) GO TO 151                                             DSTRI183
      DO 150 LI=1,L2                                                    DSTRI184
      DL2=DL2*SIN2                                                      DSTRI185
  150 CONTINUE                                                          DSTRI186
  151 CONTINUE                                                          DSTRI187
      D2(L2+1)=DL2                                                      DSTRI188
      IF(L1.EQ.0) GO TO 171                                             DSTRI189
      FJ1=1.0                                                           DSTRI190
      FL1=LL1                                                           DSTRI191
      FM1=LL1                                                           DSTRI192
      DO 170 LI=1,L1                                                    DSTRI193
      DK1=(FM1*COS1*DL1/SIN1-DM1)/(FJ1*FL1)                             DSTRI194
      FJ1=FJ1+1.0                                                       DSTRI195
      FL1=FL1-1.0                                                       DSTRI196
      FM1=FM1-2.0                                                       DSTRI197
      DM1=DL1                                                           DSTRI198
      DL1=DK1                                                           DSTRI199
      INDX=L1+1-LI                                                      DSTRI200
      D1(INDX)=DL1                                                      DSTRI201
  170 CONTINUE                                                          DSTRI202
  171 CONTINUE                                                          DSTRI203
      IF(L2.EQ.0) GO TO 181                                             DSTRI204
      FJ2=1.0                                                           DSTRI205
      FL2=LL2                                                           DSTRI206
      FM2=LL2                                                           DSTRI207
      DO 180 LI=1,L2                                                    DSTRI208
      DK2=(FM2*COS2*DL2/SIN2-DM2)/(FJ2*FL2)                             DSTRI209
      FJ2=FJ2+1.0                                                       DSTRI210
      FL2=FL2-1.0                                                       DSTRI211
      FM2=FM2-2.0                                                       DSTRI212
      DM2=DL2                                                           DSTRI213
      DL2=DK2                                                           DSTRI214
      INDX=L2+1-LI                                                      DSTRI215
      D2(INDX)=DL2                                                      DSTRI216
  180 CONTINUE                                                          DSTRI217
  181 CONTINUE                                                          DSTRI218
      PROD=0.0                                                          DSTRI219
      DO 185 LI=1,LPL                                                   DSTRI220
      PROD=PROD+D1(LI)*D2(LI)*TVCC(LI)                                  DSTRI221
  185 CONTINUE                                                          DSTRI222
  280 CONTINUE                                                          DSTRI223
      F1=FK1*(F(K1+1,1)-F(K1,1))+F(K1,1)                                DSTRI224
      F2=FK2*(F(K2+1,2)-F(K2,2))+F(K2,2)                                DSTRI225
      SUMX=SUMX+WX*PROD*F1*F2                                           DSTRI226
      IF(IX.NE.0) GO TO 300                                             DSTRI227
      IX=1                                                              DSTRI228
      IF(ICNTRL.NE.0) GO TO 290                                         DSTRI229
      ITEMP=K1                                                          DSTRI230
      K1=K2                                                             DSTRI231
      K2=ITEMP                                                          DSTRI232
      ATEMP=FK1                                                         DSTRI233
      FK1=FK2                                                           DSTRI234
      FK2=ATEMP                                                         DSTRI235
      ATEMP=COS1                                                        DSTRI236
      COS1=COS2                                                         DSTRI237
      COS2=ATEMP                                                        DSTRI238
      ATEMP=SIN1                                                        DSTRI239
      SIN1=SIN2                                                         DSTRI240
      SIN2=ATEMP                                                        DSTRI241
      IF(L1.EQ.L2) GO TO 280                                            DSTRI242
      GO TO 120                                                         DSTRI243
  290 CONTINUE                                                          DSTRI244
      X=-X                                                              DSTRI245
      GO TO 110                                                         DSTRI246
  300 CONTINUE                                                          DSTRI247
      SUMR=SUMR+WR(MR)*SUMX                                             DSTRI248
  400 CONTINUE                                                          DSTRI249
      SUMR=SUMR*FNORM*OPT                                               DSTRI250
      FR(MK)=FR(MK)+SUMR                                                DSTRI251
      IF(M.EQ.KM) SL=SUMR                                               DSTRI252
  500 CONTINUE                                                          DSTRI253
 1000 CONTINUE                                                          DSTRI254
      RETURN                                                            DSTRI255
      END                                                               DSTRI256
