C$PROG MESSLOG
      SUBROUTINE MESSLOG(LUA,LUB)
C
      COMMON/LLL/ MSSG(28),NAMPROG(2),LOGUT,LOGUP,LISFLG,MSGF
C
      INTEGER*4 JDATE(3),JTIME(2),MSS20(20),MSS26(26)
C
      EQUIVALENCE (MSS20(1),MSSG(1)),(MSS26(1),MSSG(1))
C
      IF(LUA.LE.0) GO TO 20
C
      WRITE(LUA,10)MSS20
   10 FORMAT(1H ,19A4,A3)
C
   20 IF(LUB.LE.0.OR.LISFLG.NE.'LON ') GO TO 100
      CALL DATE(JDATE)
      CALL TIME(JTIME)
C
      NTRY=0
   50 WRITE(LUB,55,ERR=60)NAMPROG,JDATE,JTIME,MSS26
   55 FORMAT(1H ,A4,A3,2A4,A1,2X,2A4,2X,26A4)
      GO TO 100
C
   60 NTRY=NTRY+1
      IF(NTRY.LT.10) GO TO 50
      WRITE(LOGUT,65)
   65 FORMAT(1H ,'10 FAILURES WRITING FOLLOWING TO LOG-FILE')
      WRITE(LOGUT,70)NAMPROG,JDATE,JTIME
   70 FORMAT(1H ,A4,A3,2A4,A1,2X,2A4)
      WRITE(LOGUT,10)MSS20
C
  100 DO 110 I=1,28
      MSSG(I)='    '
  110 CONTINUE
C
      RETURN
      END
