100 REM    POSISHAP.BAS        SEPTEMBER 6, 1992       J. KANTELE

110 COLOR 15, 1: CLS

120 PRINT "*****************************************************************"

130 PRINT

140 PRINT " PROGRAM TO CALCULATE THE SHAPES OF ALLOWED POSITRON ENERGY "

150 PRINT " SPECTRA FOR Z = 1 TO 100, ON THE BASIS OF BEHRENS AND JéNECKE'S "

160 PRINT " TABLES [Be69]. IF Z > 50, THE SHAPES ARE APPROXIMATELY CORRECT "

170 PRINT " AT E < 50 keV. FOR Z < 26 AND Z < 13, THE SHAPES ARE REPRODUCED "

180 PRINT " QUITE WELL ABOVE ABOUT 20 AND 10 keV, RESPECTIVELY."

190 PRINT " THE PROGRAM GIVES SHAPES WITHOUT AND WITH SREEENING CORRECTIONS."

200 PRINT " SPECTRUM NORMALIZATION: THE TOTAL NUMBER OF COUNTS = 10,000; "

210 PRINT " IT CAN BE ADJUSTED BY CHANGING THE FACTOR 'NR' ON LINE 250."

220 PRINT " THE ENERGY-BIN (CHANNEL) NUMBER CAN BE CHOSEN (1 TO 200)."

230 PRINT

240 PRINT "*****************************************************************"

250 NR = 10000

260 DIM M(8, 11), X(200), T(11, 9), C(200), E(200), F(200), FS(200), ME(200), MES(200), NE(200), NES(200), P(200)

270 FOR K = 1 TO 8

280     FOR L = 1 TO 11

290         READ M(K, L)

300     NEXT L

310 NEXT K

320 DATA 1, -.313382, .117663, -.016218, .0007587, 0, -.024786, 5.7346E-5, 2.31865E-5, 0, 0

330 DATA 10, -3.84456, 1.534, -.21992, .010662, 0, -.053804, -.041362, .002706, 0, 0

340 DATA 20, -10.8276, 5.50759, -1.14606, .111243, -.00421536, .230165, -.15023, .00902366, 0, 0

350 DATA 30, -12.1595, 4.7432, -.65041, .029935, 0, .37228, -.21268, .012221, 0, 0

360 DATA 50, -22.5153, 8.92152, -1.22276, .056017, 0, -6.54927, 2.2527, -.28514, .011719, 0

370 DATA 70, -33.01442, 13.1511, -1.789534, .0810547, 0, -11.6324, 4.19548, -.52875, .0214844, 0

380 DATA 90, -42.6523, 16.9538, -2.2726, .10076, 0, -12.1595, 4.6966, -.61494, .025391, 0

390 DATA 100, -47.5832, 18.9583, -2.53152, .111491, 0, -16.05257, 6.25352, -.81078, .033203, 0

395 REM

400 FOR K = 1 TO 11

410   FOR L = 1 TO 9

420      READ T(K, L)

430   NEXT L

440 NEXT K

450 DATA 5, -.32195, -1.4775, .0646275, 0, 0, 0, 0, 0

460 DATA 10, 1.49963, -1.754, 0.086511, 0, 0, 0, 0, 0

470 DATA 20, 2.7958, -1.46326, -.047488, .01248, 0, 0, 0, 0

480 DATA 30, 4.5039, -1.883, 0.0299, 0.0062473, 0, 0, 0, 0

490 DATA 40, 6.3817, -2.52859, .14141, -.0010956, 0, 0, 0, 0

500 DATA 50, 9.72267, -4.36306, .54173, -.03115, 4.8186, -1.3046, -.09413, .012908

510 DATA 60, 14.01361, -6.85042, 1.07656, -.07017, 7.2976, -2.32484, .07168, .003418

520 DATA 70, 18.38453, -9.345, 1.5996, -.10748, 6.5348, -1.6554, -.054035, .0104167

530 DATA 80, 23.191, -12.1048, 2.17141, -.147695, 9.04359, -2.76463, .1324, -.0004783

540 DATA 90, 28.4667, -15.1477, 2.7969, -.191278, 8.3353, -2.1323, .0080377, .00681

550 DATA 100, 33.983, -18.3078, 3.4377, -.235332, 9.6754, -2.6172, .080466, .0027685

560 REM

570 PRINT

580 INPUT " ATOMIC NUMBER OF DAUGHTER NUCLEUS, Z = ", Z

590 PRINT

600 FOR I = 1 TO 7

610 IF M(I + 1, 1) - Z >= 0 THEN 630

620 NEXT I

630 A = M(I + 1, 1): B = M(I, 1)

640 INPUT " END-POINT ENERGY OF POSITRON SPECTRUM (keV), E(max) = ", E0

650 PRINT

660 INPUT " NUMBER OF ENERGY BINS (CHANNELS), MAX. 200, NB = ", NB

670 PRINT : NE = 0: NES = 0

680 INPUT " DO YOU WANT TO PRINT RESULTS (1 = YES; 2 = NO)? CHOICE = ", PR

690 PRINT

700 FOR J = 1 TO NB

710 E(J) = J * E0 / NB - E0 / (2 * NB)

720 FOR K = I TO I + 1

730 GOSUB 1090

740 NEXT K

750 GOTO 1130

760 F(J) = EXP(LOG(Y(I)) + (LOG(Y(I + 1)) - LOG(Y(I))) * (Z - M(I, 1)) / (A - B))

770 FS(J) = F(J) * C(J)

780 P(J) = SQR(E(J) ^ 2 + 1022 * E(J)) * 100

790 NE(J) = (E0 - E(J)) ^ 2 * (E(J) + 511) * F(J) * P(J)

800 NES(J) = (E0 - E(J)) ^ 2 * (E(J) + 511) * FS(J) * P(J)

810 NE = NE + NE(J)

820 NES = NES + NES(J)

830 NEXT J

840 COLOR 14

850 PRINT USING " Z = ##; E(max) = ##.###^^^^ keV "; Z; E0

860 PRINT

870 IF PR = 2 THEN 920

880 LPRINT : LPRINT USING " Z = ##; E(max) = ##.###^^^^ keV "; Z; E0

890 LPRINT

900 LPRINT " CHANNEL ENERGY       NO SCREENING     WITH SCREENING"

910 LPRINT

920 PRINT " CHANNEL ENERGY       NO SCREENING     WITH SCREENING"

930 PRINT

940 FOR J = 1 TO NB

950 ME(J) = NE(J) * NR / NE

960 MES(J) = NES(J) * NR / NES

970 IF PR = 1 THEN LPRINT USING " E = ##.###^^^^ keV ; N(E) = ####.## ; N(E)scr = ####.##"; E(J); ME(J); MES(J)

980 COLOR 14: PRINT USING " E = ##.###^^^^ keV ; N(E) = ####.## ; N(E)scr = ####.##"; E(J); ME(J); MES(J)

990 NEXT J

1000 PRINT : COLOR 15

1010 PRINT " HOW TO CONTINUE? THE CHOICES: 1 = CALCULATE SHAPE FOR THE SAME Z;"

1020 PRINT

1030 INPUT " 2 = FOR ANOTHER Z; 3 = RESTART PROGRAM; 4 = QUIT. YOUR CHOICE = ", M

1040 PRINT

1050 PRINT "*****************************************************************"

1060 PRINT

1070 ON M GOTO 640, 580, 140, 1080

1080 END

1090 IF E(J) > 2000 THEN G = 5 ELSE G = 0

1100 Y(K) = EXP(M(K, 2 + G) + M(K, 3 + G) * LOG(E(J)) + M(K, 4 + G) * LOG(E(J)) ^ 2 + M(K, 5 + G) * LOG(E(J)) ^ 3 + M(K, 6 + G) * LOG(E(J)) ^ 4)

1110 RESTORE

1120 RETURN

1130 REM

1140 IF Z > 100 THEN L = 10: GOTO 1180

1150 FOR L = 1 TO 10

1160 IF T(L + 1, 1) - Z >= 0 THEN 1180

1170 NEXT L

1180 FOR N = L TO L + 1

1190 GOSUB 1240

1200 NEXT N

1210 C(J) = EXP(X(L) + (X(L + 1) - X(L)) * (Z - T(L, 1)) / (T(L + 1, 1) - T(L, 1))) + 1

1220 GOTO 760

1230 END

1240 IF E(J) > 100 AND Z > 49 THEN Q = 4 ELSE Q = 0

1250 X(N) = T(N, 2 + Q) + T(N, 3 + Q) * LOG(E(J)) + T(N, 4 + Q) * LOG(E(J)) ^ 2 + T(N, 5 + Q) * LOG(E(J)) ^ 3

1260 RESTORE

1270 RETURN



