100 REM    OMEGA.BAS         AUGUST 26, 1992         J. KANTELE

110 COLOR 11, 0: CLS

120 PRINT "*****************************************************************"

130 PRINT

140 PRINT " PROGRAM TO CALCULATE ELECTRONIC FACTORS OMEGA K, L1, AND L2 "

150 PRINT " FOR E0 TRANSITIONS FOR 30<~ Z <=100. THE VALID ENERGY REGION IS "

160 PRINT " 100 keV TO 20 MeV. THE ACCURACY IS GENERALLY MUCH BETTER THAN "

170 PRINT " 3 %  FOR E =< 2.5 MeV, WHERE TABLES OF BELL et al. [Be70]"

180 PRINT " WERE USED. EXTRAPOLATION TO E > 2.5 MeV IS BASED ON THE ENERGY "

190 PRINT " DEPENDENCE OF [Wi70] AND THE FERMI FUNCTIONS OF [Be69]. "

200 PRINT " NOTE THAT, ESPECIALLY FOR L1 AND L2 ELECTRON ORBITS,"

210 PRINT " UNCERTAINTIES OF THE ORDER OF 10 % MAY OCCUR FOR Z<<40 AND/OR AT"

220 PRINT " ENERGIES WELL ABOVE 1 MeV."

230 PRINT

240 DIM T(8, 10), M(4, 4), A(8), B(8), C(8)

250 FOR K = 1 TO 8

260     FOR L = 1 TO 10

270         READ T(K, L)

280     NEXT L

290 NEXT K

300 DATA 30, 20.4205, -1.58594, .198488, 17.6365, -1.42825, .184918, 4.7185, .166064

310 DATA .108297, 40, 22.6008, -1.66814, .203331, 20.4791, -1.69714, .205023

320 DATA 7.93551, 2.38287E-3, .116112, 50, 24.5300, -1.71336, .204211, 22.5111

330 DATA -1.73646, .205202, 10.9843, -.160106, .123915

340 DATA 60, 26.1687, -1.71525, .201627, 24.2325, -1.72362, .200791, 13.7268

350 DATA -.286516, .128366, 70, 27.6128, -1.67318, .195416, 25.7495, -1.66186

360 DATA .192329, 16.2753, -.374034, .12908

370 DATA 80, 28.9547, -1.5955, .185961, 27.1119, -1.54559, .178921, 18.6776

380 DATA -.411643, .124904, 90, 30.3724, -1.5244, .175774, 28.2794, -1.35221

390 DATA .158204, 20.8835, -.368853, .112815, 100, 31.3418, -1.30316, .153061

400 DATA 29.003, -.984367, .120947, 22.6764, -.151425, .083746

410 FOR K = 1 TO 4

420     FOR L = 1 TO 4

430         READ M(K, L)

440     NEXT L

450 NEXT K

460 DATA 30, .083368, .244539, -.019246

470 DATA 50, .0477256, .515291, -.0423982

480 DATA 70, .515219, .738253, -.066362

490 DATA 90, 2.52482, .66674, -.076984

500 PRINT "*****************************************************************"

510 PRINT

520 INPUT " ATOMIC NUMBER Z = ", Z

530 PRINT

540 INPUT " TRANSITION ENERGY (keV) = ", E

550 IF Z < 30 THEN 560 ELSE 570

560 J = 1: GOTO 600

570 FOR J = 1 TO 7

580 IF T(J + 1, 1) - Z >= 0 THEN 600

590 NEXT J

600 IF E <= 2500 THEN E1 = E: GOTO 620

610 IF E > 2500 THEN E1 = 2500

620 FOR I = J TO J + 1

630 GOSUB 890

640 NEXT I

650 D = (Z - T(J, 1)) / (T(J + 1, 1) - T(J, 1))

660 OMK = EXP(A(J) + D * (A(J + 1) - A(J)))

670 OML1 = EXP(B(J) + D * (B(J + 1) - B(J)))

680 OML2 = EXP(C(J) + D * (C(J + 1) - C(J)))

690 IF ABS(Z - 54) > 2 THEN P = 1 ELSE P = 1.04

700 IF E > 2500 THEN 940 ELSE 740

710 X = C * F

720 R = P * X

730 OK = R * OMK: OL1 = R * OML1: OL2 = R * OML2: GOTO 750

740 OK = P * OMK: OL1 = P * OML1: OL2 = P * OML2

750 OA = OK / OL1: OB = OL1 / OL2: OB1 = 1 / OB: OD = OK / (OL1 + OL2)

760 PRINT

770 PRINT USING " OMEGA-K   = ##.##^^^^ 1/s"; OK

780 PRINT

790 PRINT USING " OMEGA-L1  = ##.##^^^^ 1/s"; OL1

800 PRINT

810 PRINT USING " OMEGA-L2  = ##.##^^^^ 1/s"; OL2

820 PRINT

830 PRINT USING " K/L1/L2   = ##.##/1/##.##^^^^"; OA, OB1

840 PRINT

850 PRINT USING " K/(L1+L2) = ##.##/1"; OD

860 PRINT

870 COLOR 12: PRINT " IF YOU LIKE TO QUIT, JUST HIT CTRL-C ": COLOR 11

880 GOTO 490

890 A(I) = T(I, 2) + T(I, 3) * LOG(E1) + T(I, 4) * (LOG(E1)) ^ 2

900 B(I) = T(I, 5) + T(I, 6) * LOG(E1) + T(I, 7) * (LOG(E1)) ^ 2

910 C(I) = T(I, 8) + T(I, 9) * LOG(E1) + T(I, 10) * (LOG(E1)) ^ 2

920 RESTORE

930 RETURN

940 REM

950 W = E / 511 + 1: G = SQR(1 - (Z / 137.06) ^ 2)

960 P1 = SQR(W ^ 2 - 1)

970 C = P1 * (W + G) / SQR((2500 / 511 + 1) ^ 2 - 1) / (2500 / 511 + 1 + G)

980 IF Z >= 90 THEN I = 3: GOTO 1020

990 FOR I = 1 TO 3

1000 IF M(I + 1, 1) - Z >= 0 THEN 1020

1010 NEXT I

1020 FOR J = I TO I + 1

1030 GOSUB 1100

1040 NEXT J

1050 F1 = EXP(LOG(Y(I)) + (Z - M(I, 1)) * (LOG(Y(I + 1)) - LOG(Y(I))) / 20)

1060 F2 = EXP(LOG(Q(I)) + (Z - M(I, 1)) * (LOG(Q(I + 1)) - LOG(Q(I))) / 20)

1070 F = F1 / F2

1080 GOTO 710

1090 END

1100 Y(J) = EXP(M(J, 2) + M(J, 3) * LOG(E) + M(J, 4) * LOG(E) ^ 2)

1110 Q(J) = EXP(M(J, 2) + M(J, 3) * LOG(2500) + M(J, 4) * LOG(2500) ^ 2)

1120 RESTORE

1130 RETURN



