100 REM    ICCTOT.BAS           APRIL 19, 1993         J. KANTELE

110 COLOR 15, 1: CLS

120 PRINT "***************************************************************"

130 PRINT

140 PRINT " PROGRAM TO COMPUTE TOTAL INTERNAL-CONVERSION COEFFICIENTS FOR "

150 PRINT " E1, E2, E3, M1, M2, AND M3 TRANSITIONS, ON THE BASIS OF TABLES "

160 PRINT " BY RôSEL et al. [Rî78]. THE ELEMENT RANGE IS ABOUT Z = 25 TO "

170 PRINT " Z = 95, THE ENERGY RANGE FROM A FEW keV ABOVE THE L(I) BINDING "

180 PRINT " ENERGY TO ABOUT 1600 keV.  IN THE RANGE OF Z = 28 TO 92, "

190 PRINT " THE ACCURACY FOR E1, M1, M2, AND M3 IS USUALLY 1 PER CENT. "

200 PRINT " FOR E2 AND E3 TRANSITIONS, 2 TO 3 % ERRORS MAY OCCUR, MOST "

210 PRINT " LIKELY IN THE LOW Z AND LOW-ENERGY REGIONS. "

220 PRINT " THE PROGRAM GIVES A WARNING IN REGIONS WHERE THE ACCURACY "

230 PRINT " MAY BE WORSE THAN 3 PER CENT. ICC(tot) >> 1000 ARE UNCERTAIN. "

240 REM

250 DIM T(7, 48), A(7, 16), B(7), C(7), D(7), CA(16), E(16)

260 REM

270 FOR K = 1 TO 7

280     FOR L = 1 TO 48

290         READ T(K, L)

300     NEXT L

310 NEXT K

320 REM

330 REM   COEFFICIENTS FOR Z = 30

340 DATA 30, 8.1642, -2.6586, -.05153, 8.94232, -2.0463384, -.008729696

350 REM

360 DATA -.04577595, .00514648,  8.5597, -2.9651, -.010193, 10.710885

370 DATA -2.827905, -.104653, .02023357, -.00049837, 18.1604, -5.05447

380 DATA .106455, 17.2316, -3.39372, -.277562, .0455893, -.001332095

390 DATA 19.5904, -5.2785, .065852, 13.50371, -1.62812, -.44477, .0308493

400 DATA 22.116246, -4.544944, -.237481, .037875, 23.57936, -4.65866

410 DATA -.0573887, .00949594, 29.2383, -5.57041, -.279564, .0460837

420 DATA 22.9981, -4.03854, -.282191, .03529

430 REM

440 REM   COEFFICIENTS FOR Z = 40

450 REM

460 DATA 40, 8.69339, -2.618921, -.04676653, 6.941902, -.214849, -.520111

470 DATA .0211273, .00186088, 10.14466, -3.124082, .0261205, 11.266253

480 DATA -2.191558, -.293313, .0422741, -.00147357, 20.2838, -5.24747

490 DATA .123187, 17.71243, -2.6203, -.524397, .0763783, -.00272211, 21.04585

500 DATA -5.2724, .0526354, 16.33242, -3.378667, -.044071, .00275506

510 DATA 29.18079, -7.94373, .343078, .00612854, 36.81218, -12.123124

520 DATA 1.38111, -.081251, 36.54333, -9.14464, .330102, .0130626

530 DATA 24.39634, -4.10547, -.28043, .03533111

540 REM

550 REM   COEFFICIENTS FOR Z = 50

560 REM

570 DATA 50, 9.1133, -2.62046, -.0364189, 3.60893, 2.45707, -1.25584, .1141

580 DATA -.00253913, 11.1998, -3.03976, .0096581, 11.454, -1.50782, -.481803

590 DATA .0641392, -.00247317#, 22.26328, -5.55035, .159212, 17.81131

600 DATA -1.809415, -.764832, .105757, -.00405349, 22.3952, -5.4022, .0685378

610 DATA 21.7487, -6.402153, .538113, -.0328912, 30.93382, -8.90895, .539367

620 DATA -.0054105, 41.83455, -13.50322, 1.399296, -.0664591, 46.726

630 DATA -14.0649, 1.13685, -.0295109, 26.4099, -4.641, -.190862, .0301377

640 REM

650 REM   COEFFICIENTS FOR Z = 60

660 REM

670 DATA 60, 9.36175, -2.5756, -.034692, -1.355823, 6.202324, -2.270775

680 DATA .238786, -.00826462, 12.30203, -3.08392, .0171509, 12.57575

690 DATA -1.645857, -.438524, .058326, -.00226951, 23.50145, -5.479438

700 DATA .135051, 16.55014, -.13341, -1.23319, .16214, -.00658081

710 DATA 23.39978, -5.41179, .0671464, 28.543837, -9.70096, 1.07238

720 DATA -.0596311, 36.70733, -11.84443, 1.04786, -.033336, 33.21477

730 DATA -6.409967, -.288394, .06017584, 61.678963, -21.07892, 2.24544

740 DATA -.0866352, 29.24258, -5.662552, -.0189755, .02044972

750 REM

760 REM   COEFFICIENTS FOR Z = 70

770 REM

780 DATA 70, 9.5834, -2.56283, -.0284802, -10.87954, 13.04082, -4.079925

790 DATA .453319, -.0177609, 13.33985, -3.12397, .0232041, 11.1163

800 DATA .0484345, -.890844, .111811, -.0046974, 25.08754, -5.708464

810 DATA .15993, 15.019725, 1.496092, -1.649091, .208667, -.00853755

820 DATA 24.33954, -5.450134, .0717502, 32.65511, -10.7832, 1.070063

830 DATA -.0461544, 47.94245, -17.322852, 1.946246, -.0811219, 22.47304

840 DATA 1.2109, -1.914173, .171262, 81.217574, -29.90987, 3.59295

850 DATA -.1542916, 33.5624, -7.45039, .2758126, .00438084

860 REM

870 REM   COEFFICIENTS FOR Z = 80

880 REM

890 DATA 80, 9.617834, -2.481483, -.0306051, -17.806469, 17.74534, -5.27263

900 DATA .591181, -.0237624, 14.33424, -3.14249, .025929, 11.198567, .528186

910 DATA -.999888, .1234366, -.005247, 26.73717, -5.98773, .190031, 12.33837

920 DATA 3.88973, -2.26621, .2789684, -.0115367, 25.576843, -5.682765

930 DATA .1040945, 31.09523, -8.19526, .321829, .0159066, 59.436, -22.72115

940 DATA 2.80454, -.12562, 16.13317, 5.410159, -2.70951, .218744, 101.5762

950 DATA -38.747015, 4.89664, -.217957, 36.5263, -8.501, .436136, -.0036507

960 REM

970 REM   COEFFICIENTS FOR Z = 90

980 REM

990 DATA 90, 9.81936, -2.51938, -.0163221, -23.67083, 21.7148, -6.29317

1000 DATA .7121546, -.0291744, 15.33914, -3.150269, .0269587, 11.133076

1010 DATA 1.22555, -1.192722, .147766, -.00645885, 28.09081, -6.12518

1020 DATA .201908, 9.85748, 6.034, -2.80418, .339536, -.0141135, 26.16519

1030 DATA -5.59048, .0952508, 29.10164, -5.67919, -.316192, .0636409

1040 DATA 74.96411, -29.70577, 3.874755, -.179739, 18.01193, 4.28089

1050 DATA -2.38181, .18944, 109.72963, -41.74476, 5.28929, -.234992

1060 DATA 42.43512, -10.9814, .823795, -.0235835

1070 REM

1080 PRINT

1090 PRINT "***************************************************************"

1100 PRINT : Z = 0: E = 0

1110 INPUT " ATOMIC NUMBER Z (25<~ Z <~95) = ", Z

1120 REM

1130 REM   THE K-ELECTRON BINDING ENERGY B(K) IS COMPUTED TO AN ACCURACY OF

1140 REM   0.1 keV (WITH DIFFERENT POLYNOMIAL FITS FOR Z < 50 AND Z >= 50)

1150 REM

1160 IF Z > 50 THEN 1170 ELSE 1190

1170 BK = -14.46 + .6471 * Z + .001029 * Z ^ 2 + .0000575 * Z ^ 3 + 2.384E-07 * Z ^ 4

1180 GOTO 1200

1190 BK = .0322 - .0068033 * Z + .0084825 * Z ^ 2 + 9.9149E-05 * Z ^ 3 - 6.6564E-07 * Z ^ 4

1200 PRINT

1210 INPUT " GAMMA-RAY ENERGY E (keV; SAFE E <= 1600 keV) = ", E

1220 IF E >= 260 THEN P = 4 ELSE P = 0

1230 G = LOG(E)

1240 IF E < BK THEN R = 0 ELSE R = 1

1250 IF E < BK THEN H = 0 ELSE H = 3

1260 IF Z > 90 THEN 1310

1270 FOR J = 1 TO 6

1280 IF T(J + 1, 1) - Z >= 0 THEN 1320

1290 NEXT J

1300 GOTO 1320

1310 J = 6

1320 FOR I = J TO J + 1

1330 FOR N = 0 TO 16 STEP 8

1340 GOSUB 1730

1350 NEXT N

1360 NEXT I

1370 T = (LOG(Z) - LOG(T(J, 1))) / (LOG(T(J + 1, 1)) - LOG(T(J, 1)))

1380 FOR N = 0 TO 16 STEP 8

1390 E(0) = 1: E(8) = 1.03: E(16) = 1.03

1400 CA(N) = EXP(A(J, N) + (A(J + 1, N) - A(J, N)) * T ^ E(N))

1410 NEXT N

1420 EB = 1.04: ED = 1.02

1430 IF (Z < 50) * (E < 70) THEN EC = 1.2 ELSE EC = 1.04

1440 CB = EXP(B(J) + (B(J + 1) - B(J)) * T ^ EB)

1450 CC = EXP(C(J) + (C(J + 1) - C(J)) * T ^ EC)

1460 CD = EXP(D(J) + (D(J + 1) - D(J)) * T ^ ED)

1470 PRINT

1480 COLOR 14: PRINT USING " ALPHA(TOT;E1) = ##.##^^^^"; CA(0)

1490 PRINT USING " ALPHA(TOT;E2) = ##.##^^^^"; CB

1500 PRINT USING " ALPHA(TOT;E3) = ##.##^^^^"; CC

1510 PRINT

1520 COLOR 11: PRINT USING " ALPHA(TOT;M1) = ##.##^^^^"; CA(8)

1530 PRINT USING " ALPHA(TOT;M2) = ##.##^^^^"; CA(16)

1540 PRINT USING " ALPHA(TOT;M3) = ##.##^^^^"; CD

1550 COLOR 15: PRINT

1560 IF E <= 1600 THEN 1610

1570 COLOR 12: PRINT " THE ENERGY IS ABOVE THE RELIABLE RANGE ": PRINT

1580 REM

1590 REM  THE FOLLOWING EXPRESSION DEFINES THE LOWEST APPLICABLE ENERGY

1600 REM

1610 IF E > -1 + .267 * Z - .00383 * Z ^ 2 + .0000442 * Z ^ 3 THEN 1630

1620 COLOR 12: PRINT " THE ENERGY IS BELOW THE APPLICABLE RANGE "

1630 IF CD <= 1000 THEN 1650

1640 COLOR 12: PRINT " THE ACCURACY OF ICC VALUES >> 1000 MAY BE POOR ": PRINT

1650 COLOR 15

1660 PRINT "****************************************************************"

1670 PRINT

1680 PRINT " TO CONTINUE, YOU HAVE THREE CHOICES: 1 = KEEP Z, CHANGE ENERGY; "

1690 PRINT

1700 INPUT " 2 = CHANGE Z AND E; 3 = RESTART PROGRAM; 4 = QUIT. YOUR CHOICE = ", Q

1710 ON Q GOTO 1200, 1100, 100, 1720

1720 END

1730 A(I, N) = T(I, 2 + H + N) + T(I, 3 + H + N) * G + T(I, 4 + H + N) * G ^ 2 + R * T(I, 5 + H + N) * G ^ 3 + R * T(I, 6 + H + N) * G ^ 4

1740 B(I) = T(I, 26 + H + P) + T(I, 27 + H + P) * G + T(I, 28 + H + P) * G ^ 2 + R * T(I, 29 + H + P) * G ^ 3

1750 C(I) = T(I, 37 + P) + T(I, 38 + P) * G + T(I, 39 + P) * G ^ 2 + T(I, 40 + P) * G ^ 3

1760 D(I) = T(I, 45) + T(I, 46) * G + T(I, 47) * G ^ 2 + T(I, 48) * G ^ 3

1770 RESTORE

1780 RETURN



