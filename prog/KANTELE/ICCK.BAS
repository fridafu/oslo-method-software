100 REM    ICCK.BAS            SEPTEMBER 14, 1990         J. KANTELE

110 COLOR 15, 1: CLS

120 PRINT "***************************************************************"

130 PRINT

140 PRINT " PROGRAM FOR COMPUTING K-CONVERSION COEFFICIENTS FOR E1,E2,E3,"

150 PRINT " M1,M2, AND M3 TRANSITIONS, ON THE BASIS OF THE TABULATED"

160 PRINT " VALUES OF RÙSEL et al. THE ELEMENT RANGE IS ABOUT Z = 25 TO "

170 PRINT " Z = 95, AND THE ACCURACY TYPICALLY 2 TO 3 PER CENT, ALMOST DOWN "

180 PRINT " TO THE K-BINDING ENERGIES B(K). THE PROGRAM GIVES A WARNING "

190 PRINT " IN REGIONS WHERE SUCH AN ACCURACY MAY NOT BE ACHIEVED. THE"

200 PRINT " PRESENT PROGRAM IS A MODIFIED VERSION OF THAT PUBLISHED IN "

210 PRINT " NIM A275 (1989) 149 [Ka89]; THE ACCURACY IS NOT CHANGED."

220 REM

230 DIM T(7, 61), A(7, 50), C(50)

240 REM

250 FOR K = 1 TO 7

260     FOR L = 1 TO 61

270         READ T(K, L)

280     NEXT L

290 NEXT K

300 REM

310 REM   COEFFICIENTS FOR Z = 30

320 DATA 30, 7.2791, -.317, -.72281, .082781, -.003332, 13.7954, -1.38646

330 DATA -1.08598, .164903, -6.94445E-3, 10.7556, -.820644, -.2687, -.05302

340 DATA 7.45646E-3, 18.754, -.626242, -1.62838, .23398, -9.6933E-3

350 DATA 12.4128, .36593, -.478572, -.074569, .011068, 22.0066

360 DATA .841218, -2.29042, .311931, -.01266

370 DATA 10.7494, -3.01735, -.023255, 5.3711E-3, 4.8828E-4

380 DATA 6.54995, -.41102, -.640933, .0725584, -2.38715E-3, 17.2581,-3.80535

390 DATA -.08813, .013398, 5.74449E-4, 12.0424, -.124608, -1.07267, .13187

400 DATA -4.84664E-3, 20.5183, -3.64357, .037566, -.0665314, 8.138E-3, 17.1932

410 DATA .35298, -1.5393, .192525, -.0072338

420 REM

430 REM   COEFFICIENTS FOR Z = 40

440 DATA 40, 8.95969, -2.27475, .188913, -.08353, 7.487E-3, 12.39, -.734348

450 DATA -1.12778, .162478, -6.72743E-3, .684773, 5.31725, -1.50912, .0391116

460 DATA 6.51042E-3, 17.8102, -.193188, -1.67314, .239179, -.010055, -12.6

470 DATA 16.0955, -3.95165, .229953, 3.90625E-3, 24.5083, -.884176, -1.86888

480 DATA .274903, -.0116464, 16.621, -7.42854, 1.56603, -.248722, .0154622

490 DATA 7.4753, -.3245, -.633, .0677543, -.0020978, 25.46, -10.6473, 2.41235

500 DATA -.388856, .024414, 13.7445, -.364348, -1.03696, .129639, -4.84664E-3

510 DATA 19.0932, -4.53, 1.20587, -.347484, .0286458, 17.6507, .827857

520 DATA -1.67143, .208379, -7.95718E-3

530 REM

540 REM   COEFFICIENTS FOR Z = 50

550 DATA 50, 6.467, -.198567, -.409724, -1.70673E-3, 3.23017E-3, 11.314, -.284388

560 DATA -1.14675, .159952, -6.58276E-3, 21.9625, -18.1337, 7.3956, -1.38628

570 DATA .0894775, 17.776, -.5035, -1.54447, .227578, -9.838E-3, 20.1873

580 DATA -22.761, 11.2344, -2.2366, .148438, 21.1859, .266984, -1.99467

590 DATA .28397, -.01208, 11.679, -1.69026, -.47717, .0723287, -3.42736E-3

600 DATA 7.96881, -.010965, -.693852, .0720165, -2.2425E-3, 17.1054, -1.8568

610 DATA -.682537, .0934856, -3.6809E-3, 12.8852, .86735, -1.3393, .1618

620 DATA -6.14873E-3, 38.8547, -25.3862, 9.096, -1.60714, .101563, 18.3932

630 DATA .94139, -1.71107, .21457, -8.31887E-3

640 REM

650 REM   COEFFICIENTS FOR Z = 60

660 DATA 60, 6.39, -.2966, -.321822, -.014363, 3.756E-3, 10.628, -.12789, -1.1059

670 DATA .15242, -.0062934, -7.88246, 6.72715, -.766522, -.156684, .0192057

680 DATA 14.3322, .942873, -1.76984, .247942, -.010706, -31.8946, 18.6492

690 DATA -2.00762, -.265625, .03597, 19.0317, .3158, -1.82044, .259884

700 DATA -.0112124, 13.0187, -2.18862, -.255014, .030479, -6.68174E-4

710 DATA 8.21595, .46118, -.81065, .084601, -2.8212E-3, 17.103, -2.5699

720 DATA -.0146, -.060764, 7.487E-3, 15.1375, .230967, -1.24474, .15748

730 DATA -6.2211E-3, 6.15272, 3.14295, -.427, -.159722, .018229, 19.375

740 DATA .47819, -1.55395, .195864, -7.5955E-3

750 REM

760 REM   COEFFICIENTS FOR Z = 70

770 DATA 70, 6.09566, -.422676, -.178944, -.041741, 5.46875E-3, 10.6137, -.3898

780 DATA -.98097, .13775, -5.787E-3, -23.351, 10.40, .2603, -.527483, .047712

790 DATA 14.095, .034387, -1.40548, .205918, -9.1869E-3, -79.7644, 30.8106

800 DATA 1.05683, -1.45396, .130022, 15.9348, .088892, -1.43375, .202555

810 DATA -8.7529E-3, 15.5384, -2.4003, -.568132, .128906, -8.78906E-3

820 DATA 10.5694, -.38609, -.634504, .0694812, -2.4595E-3, 81.5398, -51.631

830 DATA 13.9236, -1.7875, .0859375, 15.866, .34528, -1.29493, .16563

840 DATA -6.69126E-3, 14.94, -1.84934, .127854, -.058712, 2.60417E-3

850 DATA 19.7802, .240024, -1.4428, .182186, -7.08912E-3

860 REM

870 REM   COEFFICIENTS FOR Z = 80

880 DATA 80, 8.80327, -1.43683, -.27324, .0330357, -.0015625, 9.47514

890 DATA -.02395, -.99891, .137897, -5.8594E-3, 9.44497, -4.76756, .74682

900 DATA .015625, -.0117188, 10.8234, .31701, -1.19407, .169698, -7.5955E-3

910 DATA -12.2099, 1.96308, .568642, -.0288514, -.013509, 11.5643, -.693632

920 DATA -.673766, .0876828, -3.54456E-3, 11.4, -1.14005, -.0711727

930 DATA -.060444, 7.0801E-3, 10.729, .211872, -.816234, .093557

940 DATA -3.68924E-3, 15.7788, -1.6956, .0011605, -.0855263, 9.27734E-3

950 DATA 16.1793, .49127, -1.319, .168798, -6.9083E-3, 18.6792, -2.76727

960 DATA -.909446, .33789, -.033203, 19.058, .26024, -1.3232, .16269

970 DATA -6.22107E-3

980 REM

990 REM   COEFFICIENTS FOR Z = 90

1000 DATA 90, 6.82468, -.578857, -.325594, .0141457, 8.7833E-4, 7.66527

1010 DATA .747665, -1.12043, .149985, -6.4381E-3, -20.7, 6.45882, .133333

1020 DATA -.169792, .0078125, 8.20943, -.681232, -.531158, .075507

1030 DATA -3.47222E-3, -14.4804, -2.22414, 1.86146, -.0678385, -.0214844

1040 DATA 14.7078, -6.17752, 1.17706, -.138335, 5.8594E-3, 13.2771

1050 DATA -1.30428, -.272013, 6.74926E-3, 1.36372E-3, 11.9848, .188745

1060 DATA -.86843, .106233, -4.5573E-3, 15.7394, -.7199, -.51967, .023669

1070 DATA 1.57175E-3, 17.1615, .182687, -1.23916, .16193, -.0067636

1080 DATA 34.3307, -11.3315, .620833, .241146, -.03125, -2.40047

1090 DATA 12.0811, -3.72424, .381954, -.0137939

1100 PRINT

1110 PRINT "***************************************************************"

1120 PRINT : Z = 0: E = 0

1130 INPUT " ATOMIC NUMBER Z (25<~ Z <~95) = ", Z

1140 IF Z > 50 THEN 1190 ELSE 1210

1150 REM

1160 REM   THE K-ELECTRON BINDING ENERGY B(K) IS COMPUTED TO AN ACCURACY OF

1170 REM   0.1 keV (WITH DIFFERENT POLYNOMIAL FITS FOR Z < 50 AND Z >= 50)

1180 REM

1190 BK = -14.46 + .6471 * Z + .001029 * Z ^ 2 + .0000575 * Z ^ 3 + 2.384E-07 * Z ^ 4

1200 GOTO 1220

1210 BK = .0322 - .0068033 * Z + .0084825 * Z ^ 2 + 9.9149E-05 * Z ^ 3 - 6.6564E-07 * Z ^ 4

1220 PRINT

1230 INPUT " GAMMA-RAY ENERGY E (keV; SAFE E <~ 5000 keV) = ", E

1240 IF E >= 220 THEN P = 5 ELSE P = 0

1250 G = LOG(E)

1260 PRINT

1270 IF E < BK THEN 1470 ELSE 1280

1280 IF Z > 90 THEN 1330 ELSE 1290

1290 FOR J = 1 TO 6

1300 IF T(J + 1, 1) - Z >= 0 THEN 1340 ELSE 1310

1310 NEXT J

1320 GOTO 1340

1330 J = 6

1340 FOR I = J TO J + 1

1350 FOR N = 0 TO 50 STEP 10

1360 GOSUB 1700

1370 NEXT N

1380 NEXT I

1390 FOR N = 0 TO 50 STEP 10

1400 C(N) = EXP(A(J, N) + (A(J + 1, N) - A(J, N)) * (LOG(Z) - LOG(T(J, 1))) / (LOG(T(J + 1, 1)) - LOG(T(J, 1))))

1410 NEXT N

1420 IF P = 0 THEN 1430 ELSE 1480

1430 FOR N = 10 TO 20 STEP 10

1440 C(N) = EXP(A(J, N)) + (EXP(A(J + 1, N)) - EXP(A(J, N))) * (Z ^ 2 - (T(J, 1)) ^ 2) / ((T(J + 1, 1)) ^ 2 - (T(J, 1)) ^ 2)

1450 NEXT N

1460 GOTO 1480

1470 COLOR 12: PRINT " K-CONVERSION IS NOT ENERGETICALLY POSSIBLE!": COLOR 15: GOTO 1220

1480 PRINT

1490 COLOR 14: PRINT USING " ALPHA(K;E1) = ##.##^^^^"; C(0)

1500 PRINT USING " ALPHA(K;E2) = ##.##^^^^"; C(10)

1510 PRINT USING " ALPHA(K;E3) = ##.##^^^^"; C(20)

1520 PRINT

1530 COLOR 11: PRINT USING " ALPHA(K;M1) = ##.##^^^^"; C(30)

1540 PRINT USING " ALPHA(K;M2) = ##.##^^^^"; C(40)

1550 PRINT USING " ALPHA(K;M3) = ##.##^^^^"; C(50)

1560 COLOR 15: PRINT

1570 IF (Z < 60) * (E < 70) THEN 1600 ELSE 1580

1580 IF (Z >= 60) * (E < 150) THEN 1590 ELSE PRINT : GOTO 1640

1590 IF E < 70 + 2 * (Z - 60) THEN 1600 ELSE 1620

1600 COLOR 12: PRINT " THE ACCURACY FOR E2,E3, AND M3 MAY BE WORSE THAN 3 PER CENT": COLOR 15

1610 PRINT : GOTO 1640

1620 IF E < 70 + 4 * (Z - 60) THEN 1630 ELSE PRINT : GOTO 1640

1630 COLOR 12: PRINT " THE ACCURACY FOR E3 MAY BE WORSE THAN 3 PER CENT": COLOR 15: PRINT

1640 PRINT "****************************************************************": PRINT

1650 PRINT " TO CONTINUE, YOU HAVE THREE CHOICES: 1 = KEEP Z, CHANGE ENERGY; "

1660 PRINT

1670 INPUT " 2 = CHANGE Z AND E; 3 = RESTART PROGRAM; 4 = QUIT. YOUR CHOICE = ", Q

1680 ON Q GOTO 1220, 1120, 100, 1690

1690 END

1700 A(I, N) = T(I, 2 + P + N) + T(I, 3 + P + N) * G + T(I, 4 + P + N) * G ^ 2 + T(I, 5 + P + N) * G ^ 3 + T(I, 6 + P + N) * G ^ 4

1710 RESTORE

1720 RETURN



